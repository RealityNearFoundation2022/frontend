(function(Le,et){typeof exports=="object"&&typeof module<"u"?et(exports):typeof define=="function"&&define.amd?define(["exports"],et):(Le=typeof globalThis<"u"?globalThis:Le||self,et(Le["@walletconnect/sign-client"]={}))})(this,function(Le){"use strict";var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}function Ac(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Lc=Rc;function Rc(t,e,r){var n=r&&r.stringify||Ac,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var o=new Array(s);o[0]=n(t);for(var a=1;a<s;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var h=e.length;if(h===0)return t;for(var f="",l=1-i,w=-1,y=t&&t.length||0,b=0;b<y;){if(t.charCodeAt(b)===37&&b+1<y){switch(w=w>-1?w:0,t.charCodeAt(b+1)){case 100:case 102:if(l>=h||e[l]==null)break;w<b&&(f+=t.slice(w,b)),f+=Number(e[l]),w=b+2,b++;break;case 105:if(l>=h||e[l]==null)break;w<b&&(f+=t.slice(w,b)),f+=Math.floor(Number(e[l])),w=b+2,b++;break;case 79:case 111:case 106:if(l>=h||e[l]===void 0)break;w<b&&(f+=t.slice(w,b));var D=typeof e[l];if(D==="string"){f+="'"+e[l]+"'",w=b+2,b++;break}if(D==="function"){f+=e[l].name||"<anonymous>",w=b+2,b++;break}f+=n(e[l]),w=b+2,b++;break;case 115:if(l>=h)break;w<b&&(f+=t.slice(w,b)),f+=String(e[l]),w=b+2,b++;break;case 37:w<b&&(f+=t.slice(w,b)),f+="%",w=b+2,b++,l--;break}++l}++b}return w===-1?t:(w<y&&(f+=t.slice(w)),f)}const Vi=Lc;var Gr=St;const _r=Kc().console||{},Cc={mapHttpRequest:Yr,mapHttpResponse:Yr,wrapRequestSerializer:Nn,wrapResponseSerializer:Nn,wrapErrorSerializer:Nn,req:Yr,res:Yr,err:Mc};function Pc(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function St(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||_r;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=Pc(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",h=Object.create(r);h.log||(h.log=yr),Object.defineProperty(h,"levelVal",{get:l}),Object.defineProperty(h,"level",{get:w,set:y});const f={transmit:e,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:jc(t)};h.levels=St.levels,h.level=a,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=yr,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=b,e&&(h._logEvent=Tn());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function y(D){if(D!=="silent"&&!this.levels.values[D])throw Error("unknown level "+D);this._level=D,ir(f,h,"error","log"),ir(f,h,"fatal","error"),ir(f,h,"warn","error"),ir(f,h,"info","log"),ir(f,h,"debug","log"),ir(f,h,"trace","log")}function b(D,R){if(!D)throw new Error("missing bindings for child Pino");R=R||{},i&&D.serializers&&(R.serializers=D.serializers);const L=R.serializers;if(i&&L){var U=Object.assign({},n,L),E=t.browser.serialize===!0?Object.keys(U):i;delete D.serializers,Wr([D],E,U,this._stdErrSerialize)}function O(g){this._childLevel=(g._childLevel|0)+1,this.error=sr(g,D,"error"),this.fatal=sr(g,D,"fatal"),this.warn=sr(g,D,"warn"),this.info=sr(g,D,"info"),this.debug=sr(g,D,"debug"),this.trace=sr(g,D,"trace"),U&&(this.serializers=U,this._serialize=E),e&&(this._logEvent=Tn([].concat(g._logEvent.bindings,D)))}return O.prototype=this,new O(this)}return h}St.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},St.stdSerializers=Cc,St.stdTimeFunctions=Object.assign({},{nullTime:Gi,epochTime:Wi,unixTime:zc,isoTime:Bc});function ir(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?yr:i[r]?i[r]:_r[r]||_r[n]||yr,Fc(t,e,r)}function Fc(t,e,r){!t.transmit&&e[r]===yr||(e[r]=function(n){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===_r?_r:this;for(var h=0;h<o.length;h++)o[h]=arguments[h];if(t.serialize&&!t.asObject&&Wr(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(a,$c(this,r,o,s)):n.apply(a,o),t.transmit){const f=t.transmit.level||e.level,l=St.levels.values[f],w=St.levels.values[r];if(w<l)return;Uc(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:f,transmitValue:St.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function $c(t,e,r,n){t._serialize&&Wr(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=St.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?Vi(i.shift(),i):void 0}else typeof s=="string"&&(s=Vi(i.shift(),i));return s!==void 0&&(o.msg=s),o}function Wr(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=St.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function sr(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function Uc(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,h=t._logEvent.bindings;Wr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,n(s,t._logEvent,a),t._logEvent=Tn(h)}function Tn(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Mc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function jc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Gi:Wi}function Yr(){return{}}function Nn(t){return t}function yr(){}function Gi(){return!1}function Wi(){return Date.now()}function zc(){return Math.round(Date.now()/1e3)}function Bc(){return new Date(Date.now()).toISOString()}function Kc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var Nt={exports:{}},or=typeof Reflect=="object"?Reflect:null,Yi=or&&typeof or.apply=="function"?or.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},kr;or&&typeof or.ownKeys=="function"?kr=or.ownKeys:Object.getOwnPropertySymbols?kr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:kr=function(e){return Object.getOwnPropertyNames(e)};function Hc(t){console&&console.warn&&console.warn(t)}var ki=Number.isNaN||function(e){return e!==e};function Se(){Se.init.call(this)}Nt.exports=Se,Nt.exports.once=Wc,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var Xi=10;function Xr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return Xi},set:function(t){if(typeof t!="number"||t<0||ki(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Xi=t}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ki(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Ji(t){return t._maxListeners===void 0?Se.defaultMaxListeners:t._maxListeners}Se.prototype.getMaxListeners=function(){return Ji(this)},Se.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")Yi(h,this,r);else for(var f=h.length,l=rs(h,f),n=0;n<f;++n)Yi(l[n],this,r);return!0};function Zi(t,e,r,n){var i,s,o;if(Xr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Ji(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Hc(a)}return t}Se.prototype.addListener=function(e,r){return Zi(this,e,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(e,r){return Zi(this,e,r,!0)};function qc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qi(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=qc.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(e,r){return Xr(r),this.on(e,Qi(this,e,r)),this},Se.prototype.prependOnceListener=function(e,r){return Xr(r),this.prependListener(e,Qi(this,e,r)),this},Se.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Xr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Vc(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function es(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Gc(i):rs(i,i.length)}Se.prototype.listeners=function(e){return es(this,e,!0)},Se.prototype.rawListeners=function(e){return es(this,e,!1)},Se.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ts.call(t,e)},Se.prototype.listenerCount=ts;function ts(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?kr(this._events):[]};function rs(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Vc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Gc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Wc(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}ns(t,e,s,{once:!0}),e!=="error"&&Yc(t,i,{once:!0})})}function Yc(t,e,r){typeof t.on=="function"&&ns(t,"error",e,r)}function ns(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Jr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var An=function(t,e){return An=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},An(t,e)};function kc(t,e){An(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ln=function(){return Ln=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ln.apply(this,arguments)};function Xc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Jc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Zc(t,e){return function(r,n){e(r,n,t)}}function Qc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function eu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(a,h)}f((n=n.apply(t,e||[])).next())})}function tu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function ru(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function nu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Rn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function is(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function iu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(is(arguments[e]));return t}function su(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function vr(t){return this instanceof vr?(this.v=t,this):new vr(t)}function ou(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(b){return new Promise(function(D,R){s.push([y,b,D,R])>1||a(y,b)})})}function a(y,b){try{h(n[y](b))}catch(D){w(s[0][3],D)}}function h(y){y.value instanceof vr?Promise.resolve(y.value.v).then(f,l):w(s[0][2],y)}function f(y){a("next",y)}function l(y){a("throw",y)}function w(y,b){y(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function au(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:vr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function cu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Rn=="function"?Rn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),i(a,h,o.done,o.value)})}}function i(s,o,a,h){Promise.resolve(h).then(function(f){s({value:f,done:a})},o)}}function uu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function fu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function hu(t){return t&&t.__esModule?t:{default:t}}function lu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function du(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var pu=Object.freeze({__proto__:null,__extends:kc,get __assign(){return Ln},__rest:Xc,__decorate:Jc,__param:Zc,__metadata:Qc,__awaiter:eu,__generator:tu,__createBinding:ru,__exportStar:nu,__values:Rn,__read:is,__spread:iu,__spreadArrays:su,__await:vr,__asyncGenerator:ou,__asyncDelegator:au,__asyncValues:cu,__makeTemplateObject:uu,__importStar:fu,__importDefault:hu,__classPrivateFieldGet:lu,__classPrivateFieldSet:du}),ss=Vt(pu),br={};Object.defineProperty(br,"__esModule",{value:!0});function gu(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}br.safeJsonParse=gu;function _u(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}br.safeJsonStringify=_u;var wr={exports:{}},os;function yu(){return os||(os=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof et<"u"&&et.localStorage?wr.exports=et.localStorage:typeof window<"u"&&window.localStorage?wr.exports=window.localStorage:wr.exports=new e}()),wr.exports}var Cn={},mr={},as;function vu(){if(as)return mr;as=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.IKeyValueStorage=void 0;class t{}return mr.IKeyValueStorage=t,mr}var Er={},cs;function bu(){if(cs)return Er;cs=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.parseEntry=void 0;const t=br;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Er.parseEntry=e,Er}var us;function wu(){return us||(us=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ss;e.__exportStar(vu(),t),e.__exportStar(bu(),t)}(Cn)),Cn}Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.KeyValueStorage=void 0;const ar=ss,fs=br,mu=ar.__importDefault(yu()),Eu=wu();class hs{constructor(){this.localStorage=mu.default}getKeys(){return ar.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return ar.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Eu.parseEntry)})}getItem(e){return ar.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return fs.safeJsonParse(r)})}setItem(e,r){return ar.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,fs.safeJsonStringify(r))})}removeItem(e){return ar.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Jr.KeyValueStorage=hs;var Du=Jr.default=hs,Dr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Pn=function(t,e){return Pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Pn(t,e)};function Su(t,e){Pn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fn=function(){return Fn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fn.apply(this,arguments)};function xu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Ou(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Iu(t,e){return function(r,n){e(r,n,t)}}function Tu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Nu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(a,h)}f((n=n.apply(t,e||[])).next())})}function Au(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Lu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ru(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function $n(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ls(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Cu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ls(arguments[e]));return t}function Pu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Sr(t){return this instanceof Sr?(this.v=t,this):new Sr(t)}function Fu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(b){return new Promise(function(D,R){s.push([y,b,D,R])>1||a(y,b)})})}function a(y,b){try{h(n[y](b))}catch(D){w(s[0][3],D)}}function h(y){y.value instanceof Sr?Promise.resolve(y.value.v).then(f,l):w(s[0][2],y)}function f(y){a("next",y)}function l(y){a("throw",y)}function w(y,b){y(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function $u(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Sr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Uu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof $n=="function"?$n(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),i(a,h,o.done,o.value)})}}function i(s,o,a,h){Promise.resolve(h).then(function(f){s({value:f,done:a})},o)}}function Mu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ju(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function zu(t){return t&&t.__esModule?t:{default:t}}function Bu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ku(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Hu=Object.freeze({__proto__:null,__extends:Su,get __assign(){return Fn},__rest:xu,__decorate:Ou,__param:Iu,__metadata:Tu,__awaiter:Nu,__generator:Au,__createBinding:Lu,__exportStar:Ru,__values:$n,__read:ls,__spread:Cu,__spreadArrays:Pu,__await:Sr,__asyncGenerator:Fu,__asyncDelegator:$u,__asyncValues:Uu,__makeTemplateObject:Mu,__importStar:ju,__importDefault:zu,__classPrivateFieldGet:Bu,__classPrivateFieldSet:Ku}),Zr=Vt(Hu),xr={},Un,ds;function ps(){if(ds)return Un;ds=1;function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}Un=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(s){if(!r(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},t.prototype.emit=function(s){var o,a,h,f,l,w;if(this._events||(this._events={}),s==="error"&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(o=arguments[1],o instanceof Error)throw o;var y=new Error('Uncaught, unspecified "error" event. ('+o+")");throw y.context=o,y}if(a=this._events[s],i(a))return!1;if(e(a))switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),a.apply(this,f)}else if(n(a))for(f=Array.prototype.slice.call(arguments,1),w=a.slice(),h=w.length,l=0;l<h;l++)w[l].apply(this,f);return!0},t.prototype.addListener=function(s,o){var a;if(!e(o))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,e(o.listener)?o.listener:o),this._events[s]?n(this._events[s])?this._events[s].push(o):this._events[s]=[this._events[s],o]:this._events[s]=o,n(this._events[s])&&!this._events[s].warned&&(i(this._maxListeners)?a=t.defaultMaxListeners:a=this._maxListeners,a&&a>0&&this._events[s].length>a&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(s,o){if(!e(o))throw TypeError("listener must be a function");var a=!1;function h(){this.removeListener(s,h),a||(a=!0,o.apply(this,arguments))}return h.listener=o,this.on(s,h),this},t.prototype.removeListener=function(s,o){var a,h,f,l;if(!e(o))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(a=this._events[s],f=a.length,h=-1,a===o||e(a.listener)&&a.listener===o)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,o);else if(n(a)){for(l=f;l-- >0;)if(a[l]===o||a[l].listener&&a[l].listener===o){h=l;break}if(h<0)return this;a.length===1?(a.length=0,delete this._events[s]):a.splice(h,1),this._events.removeListener&&this.emit("removeListener",s,o)}return this},t.prototype.removeAllListeners=function(s){var o,a;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(o in this._events)o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events={},this}if(a=this._events[s],e(a))this.removeListener(s,a);else if(a)for(;a.length;)this.removeListener(s,a[a.length-1]);return delete this._events[s],this},t.prototype.listeners=function(s){var o;return!this._events||!this._events[s]?o=[]:e(this._events[s])?o=[this._events[s]]:o=this._events[s].slice(),o},t.prototype.listenerCount=function(s){if(this._events){var o=this._events[s];if(e(o))return 1;if(o)return o.length}return 0},t.listenerCount=function(s,o){return s.listenerCount(o)};function e(s){return typeof s=="function"}function r(s){return typeof s=="number"}function n(s){return typeof s=="object"&&s!==null}function i(s){return s===void 0}return Un}var Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Mn=function(t,e){return Mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Mn(t,e)};function qu(t,e){Mn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var jn=function(){return jn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},jn.apply(this,arguments)};function Vu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Gu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Wu(t,e){return function(r,n){e(r,n,t)}}function Yu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ku(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(a,h)}f((n=n.apply(t,e||[])).next())})}function Xu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Ju(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Zu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function zn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function gs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Qu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(gs(arguments[e]));return t}function ef(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Or(t){return this instanceof Or?(this.v=t,this):new Or(t)}function tf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(b){return new Promise(function(D,R){s.push([y,b,D,R])>1||a(y,b)})})}function a(y,b){try{h(n[y](b))}catch(D){w(s[0][3],D)}}function h(y){y.value instanceof Or?Promise.resolve(y.value.v).then(f,l):w(s[0][2],y)}function f(y){a("next",y)}function l(y){a("throw",y)}function w(y,b){y(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function rf(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Or(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function nf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof zn=="function"?zn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),i(a,h,o.done,o.value)})}}function i(s,o,a,h){Promise.resolve(h).then(function(f){s({value:f,done:a})},o)}}function sf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function of(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function af(t){return t&&t.__esModule?t:{default:t}}function cf(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function uf(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var ff=Object.freeze({__proto__:null,__extends:qu,get __assign(){return jn},__rest:Vu,__decorate:Gu,__param:Wu,__metadata:Yu,__awaiter:ku,__generator:Xu,__createBinding:Ju,__exportStar:Zu,__values:zn,__read:gs,__spread:Qu,__spreadArrays:ef,__await:Or,__asyncGenerator:tf,__asyncDelegator:rf,__asyncValues:nf,__makeTemplateObject:sf,__importStar:of,__importDefault:af,__classPrivateFieldGet:cf,__classPrivateFieldSet:uf}),Qr=Vt(ff),Bn={},Ir={},_s;function hf(){if(_s)return Ir;_s=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Ir.delay=t,Ir}var Gt={},Kn={},Wt={},ys;function lf(){return ys||(ys=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ONE_THOUSAND=Wt.ONE_HUNDRED=void 0,Wt.ONE_HUNDRED=100,Wt.ONE_THOUSAND=1e3),Wt}var Hn={},vs;function df(){return vs||(vs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Hn)),Hn}var bs;function ws(){return bs||(bs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(lf(),t),e.__exportStar(df(),t)}(Kn)),Kn}var ms;function pf(){if(ms)return Gt;ms=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.fromMiliseconds=Gt.toMiliseconds=void 0;const t=ws();function e(n){return n*t.ONE_THOUSAND}Gt.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Gt.fromMiliseconds=r,Gt}var Es;function gf(){return Es||(Es=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(hf(),t),e.__exportStar(pf(),t)}(Bn)),Bn}var cr={},Ds;function _f(){if(Ds)return cr;Ds=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return cr.Watch=t,cr.default=t,cr}var qn={},Tr={},Ss;function yf(){if(Ss)return Tr;Ss=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.IWatch=void 0;class t{}return Tr.IWatch=t,Tr}var xs;function vf(){return xs||(xs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Qr.__exportStar(yf(),t)}(qn)),qn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(gf(),t),e.__exportStar(_f(),t),e.__exportStar(vf(),t),e.__exportStar(ws(),t)})(Z);var Vn={},Nr={};class Yt{}var bf=Object.freeze({__proto__:null,IEvents:Yt}),wf=Vt(bf),Os;function mf(){if(Os)return Nr;Os=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.IHeartBeat=void 0;const t=wf;class e extends t.IEvents{constructor(n){super()}}return Nr.IHeartBeat=e,Nr}var Is;function Ts(){return Is||(Is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Zr.__exportStar(mf(),t)}(Vn)),Vn}var Gn={},kt={},Ns;function Ef(){if(Ns)return kt;Ns=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.HEARTBEAT_EVENTS=kt.HEARTBEAT_INTERVAL=void 0;const t=Z;return kt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,kt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},kt}var As;function Ls(){return As||(As=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Zr.__exportStar(Ef(),t)}(Gn)),Gn}var Rs;function Df(){if(Rs)return xr;Rs=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.HeartBeat=void 0;const t=Zr,e=ps(),r=Z,n=Ts(),i=Ls();class s extends n.IHeartBeat{constructor(a){super(a),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=a?.interval||i.HEARTBEAT_INTERVAL}static init(a){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(a);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(a,h){this.events.on(a,h)}once(a,h){this.events.once(a,h)}off(a,h){this.events.off(a,h)}removeListener(a,h){this.events.removeListener(a,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return xr.HeartBeat=s,xr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Zr;e.__exportStar(Df(),t),e.__exportStar(Ts(),t),e.__exportStar(Ls(),t)})(Dr);var xe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Wn=function(t,e){return Wn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Wn(t,e)};function Sf(t,e){Wn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Yn=function(){return Yn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yn.apply(this,arguments)};function xf(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Of(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function If(t,e){return function(r,n){e(r,n,t)}}function Tf(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Nf(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(a,h)}f((n=n.apply(t,e||[])).next())})}function Af(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Lf(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Rf(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function kn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Cf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Cs(arguments[e]));return t}function Pf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Ar(t){return this instanceof Ar?(this.v=t,this):new Ar(t)}function Ff(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(b){return new Promise(function(D,R){s.push([y,b,D,R])>1||a(y,b)})})}function a(y,b){try{h(n[y](b))}catch(D){w(s[0][3],D)}}function h(y){y.value instanceof Ar?Promise.resolve(y.value.v).then(f,l):w(s[0][2],y)}function f(y){a("next",y)}function l(y){a("throw",y)}function w(y,b){y(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function $f(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Ar(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Uf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof kn=="function"?kn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),i(a,h,o.done,o.value)})}}function i(s,o,a,h){Promise.resolve(h).then(function(f){s({value:f,done:a})},o)}}function Mf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function jf(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function zf(t){return t&&t.__esModule?t:{default:t}}function Bf(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Kf(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Hf=Object.freeze({__proto__:null,__extends:Sf,get __assign(){return Yn},__rest:xf,__decorate:Of,__param:If,__metadata:Tf,__awaiter:Nf,__generator:Af,__createBinding:Lf,__exportStar:Rf,__values:kn,__read:Cs,__spread:Cf,__spreadArrays:Pf,__await:Ar,__asyncGenerator:Ff,__asyncDelegator:$f,__asyncValues:Uf,__makeTemplateObject:Mf,__importStar:jf,__importDefault:zf,__classPrivateFieldGet:Bf,__classPrivateFieldSet:Kf}),qf=Vt(Hf),Xt={},Ps;function Fs(){return Ps||(Ps=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.PINO_CUSTOM_CONTEXT_KEY=Xt.PINO_LOGGER_DEFAULTS=void 0,Xt.PINO_LOGGER_DEFAULTS={level:"info"},Xt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Xt}var at={},$s;function Vf(){if($s)return at;$s=1,Object.defineProperty(at,"__esModule",{value:!0}),at.generateChildLogger=at.formatChildLoggerContext=at.getLoggerContext=at.setBrowserLoggerContext=at.getBrowserLoggerContext=at.getDefaultLoggerOptions=void 0;const t=Fs();function e(a){return Object.assign(Object.assign({},a),{level:a?.level||t.PINO_LOGGER_DEFAULTS.level})}at.getDefaultLoggerOptions=e;function r(a,h=t.PINO_CUSTOM_CONTEXT_KEY){return a[h]||""}at.getBrowserLoggerContext=r;function n(a,h,f=t.PINO_CUSTOM_CONTEXT_KEY){return a[f]=h,a}at.setBrowserLoggerContext=n;function i(a,h=t.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof a.bindings>"u"?f=r(a,h):f=a.bindings().context||"",f}at.getLoggerContext=i;function s(a,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const l=i(a,f);return l.trim()?`${l}/${h}`:h}at.formatChildLoggerContext=s;function o(a,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const l=s(a,h,f),w=a.child({context:l});return n(w,l,f)}return at.generateChildLogger=o,at}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=qf,r=e.__importDefault(Gr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Fs(),t),e.__exportStar(Vf(),t)})(xe);var Us={exports:{}},ur=typeof Reflect=="object"?Reflect:null,Ms=ur&&typeof ur.apply=="function"?ur.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},en;ur&&typeof ur.ownKeys=="function"?en=ur.ownKeys:Object.getOwnPropertySymbols?en=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:en=function(e){return Object.getOwnPropertyNames(e)};function Gf(t){console&&console.warn&&console.warn(t)}var js=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}Us.exports=Oe,Us.exports.once=Xf,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var zs=10;function tn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return zs},set:function(t){if(typeof t!="number"||t<0||js(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");zs=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||js(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Bs(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return Bs(this)},Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")Ms(h,this,r);else for(var f=h.length,l=Gs(h,f),n=0;n<f;++n)Ms(l[n],this,r);return!0};function Ks(t,e,r,n){var i,s,o;if(tn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Bs(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Gf(a)}return t}Oe.prototype.addListener=function(e,r){return Ks(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return Ks(this,e,r,!0)};function Wf(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Hs(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Wf.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return tn(r),this.on(e,Hs(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return tn(r),this.prependListener(e,Hs(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var n,i,s,o,a;if(tn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Yf(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function qs(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?kf(i):Gs(i,i.length)}Oe.prototype.listeners=function(e){return qs(this,e,!0)},Oe.prototype.rawListeners=function(e){return qs(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Vs.call(t,e)},Oe.prototype.listenerCount=Vs;function Vs(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?en(this._events):[]};function Gs(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Yf(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function kf(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Xf(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Ws(t,e,s,{once:!0}),e!=="error"&&Jf(t,i,{once:!0})})}function Jf(t,e,r){typeof t.on=="function"&&Ws(t,"error",e,r)}function Ws(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class Zf extends Yt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Qf extends Yt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class eh{constructor(e,r){this.logger=e,this.core=r}}class th extends Yt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class rh extends Yt{constructor(e){super()}}class nh{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class ih extends Yt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class sh extends Yt{constructor(e,r){super(),this.core=e,this.logger=r}}class oh{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class ah{constructor(e){this.client=e}}function Ys(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Xn(t){return typeof t=="string"?t:JSON.stringify(t)}var Jn={},fr={},rn={},nn={};Object.defineProperty(nn,"__esModule",{value:!0}),nn.BrowserRandomSource=void 0;const ks=65536;class ch{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=ks)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,ks)));return r}}nn.BrowserRandomSource=ch;function uh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sn={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function fh(t){for(var e=0;e<t.length;e++)t[e]=0;return t}pt.wipe=fh;var hh={},lh=Object.freeze({__proto__:null,default:hh}),dh=Vt(lh);Object.defineProperty(sn,"__esModule",{value:!0}),sn.NodeRandomSource=void 0;const ph=pt;class gh{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof uh<"u"){const e=dh;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,ph.wipe)(r),n}}sn.NodeRandomSource=gh,Object.defineProperty(rn,"__esModule",{value:!0}),rn.SystemRandomSource=void 0;const _h=nn,yh=sn;class vh{constructor(){if(this.isAvailable=!1,this.name="",this._source=new _h.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new yh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}rn.SystemRandomSource=vh;var te={},Xs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(a,h){var f=a>>>16&65535,l=a&65535,w=h>>>16&65535,y=h&65535;return l*y+(f*y+l*w<<16>>>0)|0}t.mul=Math.imul||e;function r(a,h){return a+h|0}t.add=r;function n(a,h){return a-h|0}t.sub=n;function i(a,h){return a<<h|a>>>32-h}t.rotl=i;function s(a,h){return a<<32-h|a>>>h}t.rotr=s;function o(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(a){return t.isInteger(a)&&a>=-t.MAX_SAFE_INTEGER&&a<=t.MAX_SAFE_INTEGER}})(Xs),Object.defineProperty(te,"__esModule",{value:!0});var Js=Xs;function bh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}te.readInt16BE=bh;function wh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}te.readUint16BE=wh;function mh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}te.readInt16LE=mh;function Eh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}te.readUint16LE=Eh;function Zs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}te.writeUint16BE=Zs,te.writeInt16BE=Zs;function Qs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}te.writeUint16LE=Qs,te.writeInt16LE=Qs;function Zn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}te.readInt32BE=Zn;function Qn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}te.readUint32BE=Qn;function ei(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}te.readInt32LE=ei;function ti(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}te.readUint32LE=ti;function on(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}te.writeUint32BE=on,te.writeInt32BE=on;function an(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}te.writeUint32LE=an,te.writeInt32LE=an;function Dh(t,e){e===void 0&&(e=0);var r=Zn(t,e),n=Zn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}te.readInt64BE=Dh;function Sh(t,e){e===void 0&&(e=0);var r=Qn(t,e),n=Qn(t,e+4);return r*4294967296+n}te.readUint64BE=Sh;function xh(t,e){e===void 0&&(e=0);var r=ei(t,e),n=ei(t,e+4);return n*4294967296+r-(r>>31)*4294967296}te.readInt64LE=xh;function Oh(t,e){e===void 0&&(e=0);var r=ti(t,e),n=ti(t,e+4);return n*4294967296+r}te.readUint64LE=Oh;function eo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),on(t/4294967296>>>0,e,r),on(t>>>0,e,r+4),e}te.writeUint64BE=eo,te.writeInt64BE=eo;function to(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),an(t>>>0,e,r),an(t/4294967296>>>0,e,r+4),e}te.writeUint64LE=to,te.writeInt64LE=to;function Ih(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}te.readUintBE=Ih;function Th(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}te.readUintLE=Th;function Nh(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Js.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}te.writeUintBE=Nh;function Ah(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Js.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}te.writeUintLE=Ah;function Lh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}te.readFloat32BE=Lh;function Rh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}te.readFloat32LE=Rh;function Ch(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}te.readFloat64BE=Ch;function Ph(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}te.readFloat64LE=Ph;function Fh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}te.writeFloat32BE=Fh;function $h(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}te.writeFloat32LE=$h;function Uh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}te.writeFloat64BE=Uh;function Mh(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}te.writeFloat64LE=Mh,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=rn,r=te,n=pt;t.defaultRandomSource=new e.SystemRandomSource;function i(f,l=t.defaultRandomSource){return l.randomBytes(f)}t.randomBytes=i;function s(f=t.defaultRandomSource){const l=i(4,f),w=(0,r.readUint32LE)(l);return(0,n.wipe)(l),w}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function a(f,l=o,w=t.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let y="";const b=l.length,D=256-256%b;for(;f>0;){const R=i(Math.ceil(f*256/D),w);for(let L=0;L<R.length&&f>0;L++){const U=R[L];U<D&&(y+=l.charAt(U%b),f--)}(0,n.wipe)(R)}return y}t.randomString=a;function h(f,l=o,w=t.defaultRandomSource){const y=Math.ceil(f/(Math.log(l.length)/Math.LN2));return a(y,l,w)}t.randomStringForEntropy=h}(fr);var ro={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=pt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},a.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},a.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,y=f<<3,b=f%128<112?128:256;this._buffer[l]=128;for(var D=l+1;D<b-8;D++)this._buffer[D]=0;e.writeUint32BE(w,this._buffer,b-8),e.writeUint32BE(y,this._buffer,b-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,b),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)e.writeUint32BE(this._stateHi[D],h,D*8),e.writeUint32BE(this._stateLo[D],h,D*8+4);return this},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},a}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(a,h,f,l,w,y,b){for(var D=f[0],R=f[1],L=f[2],U=f[3],E=f[4],O=f[5],g=f[6],m=f[7],v=l[0],c=l[1],p=l[2],F=l[3],z=l[4],k=l[5],X=l[6],J=l[7],A,N,W,j,P,$,M,B;b>=128;){for(var ne=0;ne<16;ne++){var K=8*ne+y;a[ne]=e.readUint32BE(w,K),h[ne]=e.readUint32BE(w,K+4)}for(var ne=0;ne<80;ne++){var Q=D,Y=R,ae=L,T=U,I=E,S=O,u=g,_=m,H=v,V=c,he=p,ye=F,de=z,we=k,Me=X,Ce=J;if(A=m,N=J,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=(E>>>14|z<<32-14)^(E>>>18|z<<32-18)^(z>>>41-32|E<<32-(41-32)),N=(z>>>14|E<<32-14)^(z>>>18|E<<32-18)^(E>>>41-32|z<<32-(41-32)),P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,A=E&O^~E&g,N=z&k^~z&X,P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,A=i[ne*2],N=i[ne*2+1],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,A=a[ne%16],N=h[ne%16],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,W=M&65535|B<<16,j=P&65535|$<<16,A=W,N=j,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=(D>>>28|v<<32-28)^(v>>>34-32|D<<32-(34-32))^(v>>>39-32|D<<32-(39-32)),N=(v>>>28|D<<32-28)^(D>>>34-32|v<<32-(34-32))^(D>>>39-32|v<<32-(39-32)),P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,A=D&R^D&L^R&L,N=v&c^v&p^c&p,P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,_=M&65535|B<<16,Ce=P&65535|$<<16,A=T,N=ye,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=W,N=j,P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,T=M&65535|B<<16,ye=P&65535|$<<16,R=Q,L=Y,U=ae,E=T,O=I,g=S,m=u,D=_,c=H,p=V,F=he,z=ye,k=de,X=we,J=Me,v=Ce,ne%16===15)for(var K=0;K<16;K++)A=a[K],N=h[K],P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=a[(K+9)%16],N=h[(K+9)%16],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,W=a[(K+1)%16],j=h[(K+1)%16],A=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^W>>>7,N=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^(j>>>7|W<<32-7),P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,W=a[(K+14)%16],j=h[(K+14)%16],A=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^W>>>6,N=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^(j>>>6|W<<32-6),P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,a[K]=M&65535|B<<16,h[K]=P&65535|$<<16}A=D,N=v,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[0],N=l[0],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[0]=D=M&65535|B<<16,l[0]=v=P&65535|$<<16,A=R,N=c,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[1],N=l[1],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[1]=R=M&65535|B<<16,l[1]=c=P&65535|$<<16,A=L,N=p,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[2],N=l[2],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[2]=L=M&65535|B<<16,l[2]=p=P&65535|$<<16,A=U,N=F,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[3],N=l[3],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[3]=U=M&65535|B<<16,l[3]=F=P&65535|$<<16,A=E,N=z,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[4],N=l[4],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[4]=E=M&65535|B<<16,l[4]=z=P&65535|$<<16,A=O,N=k,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[5],N=l[5],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[5]=O=M&65535|B<<16,l[5]=k=P&65535|$<<16,A=g,N=X,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[6],N=l[6],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[6]=g=M&65535|B<<16,l[6]=X=P&65535|$<<16,A=m,N=J,P=N&65535,$=N>>>16,M=A&65535,B=A>>>16,A=f[7],N=l[7],P+=N&65535,$+=N>>>16,M+=A&65535,B+=A>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,f[7]=m=M&65535|B<<16,l[7]=J=P&65535|$<<16,y+=128,b-=128}return y}function o(a){var h=new n;h.update(a);var f=h.digest();return h.clean(),f}t.hash=o})(ro),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=fr,r=ro,n=pt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(T){const I=new Float64Array(16);if(T)for(let S=0;S<T.length;S++)I[S]=T[S];return I}const s=new Uint8Array(32);s[0]=9;const o=i(),a=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(T,I){for(let S=0;S<16;S++)T[S]=I[S]|0}function D(T){let I=1;for(let S=0;S<16;S++){let u=T[S]+I+65535;I=Math.floor(u/65536),T[S]=u-I*65536}T[0]+=I-1+37*(I-1)}function R(T,I,S){const u=~(S-1);for(let _=0;_<16;_++){const H=u&(T[_]^I[_]);T[_]^=H,I[_]^=H}}function L(T,I){const S=i(),u=i();for(let _=0;_<16;_++)u[_]=I[_];D(u),D(u),D(u);for(let _=0;_<2;_++){S[0]=u[0]-65517;for(let V=1;V<15;V++)S[V]=u[V]-65535-(S[V-1]>>16&1),S[V-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const H=S[15]>>16&1;S[14]&=65535,R(u,S,1-H)}for(let _=0;_<16;_++)T[2*_]=u[_]&255,T[2*_+1]=u[_]>>8}function U(T,I){let S=0;for(let u=0;u<32;u++)S|=T[u]^I[u];return(1&S-1>>>8)-1}function E(T,I){const S=new Uint8Array(32),u=new Uint8Array(32);return L(S,T),L(u,I),U(S,u)}function O(T){const I=new Uint8Array(32);return L(I,T),I[0]&1}function g(T,I){for(let S=0;S<16;S++)T[S]=I[2*S]+(I[2*S+1]<<8);T[15]&=32767}function m(T,I,S){for(let u=0;u<16;u++)T[u]=I[u]+S[u]}function v(T,I,S){for(let u=0;u<16;u++)T[u]=I[u]-S[u]}function c(T,I,S){let u,_,H=0,V=0,he=0,ye=0,de=0,we=0,Me=0,Ce=0,_e=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,ee=0,fe=0,ge=0,re=0,ve=0,be=0,Ee=0,De=0,me=0,Et=0,Tt=0,Bt=0,gt=0,er=0,Hr=0,mn=0,je=S[0],Pe=S[1],ze=S[2],Be=S[3],Ke=S[4],Fe=S[5],Ge=S[6],We=S[7],Ye=S[8],ke=S[9],Xe=S[10],qe=S[11],He=S[12],Ae=S[13],Je=S[14],Ze=S[15];u=I[0],H+=u*je,V+=u*Pe,he+=u*ze,ye+=u*Be,de+=u*Ke,we+=u*Fe,Me+=u*Ge,Ce+=u*We,_e+=u*Ye,pe+=u*ke,le+=u*Xe,ue+=u*qe,ce+=u*He,oe+=u*Ae,se+=u*Je,ee+=u*Ze,u=I[1],V+=u*je,he+=u*Pe,ye+=u*ze,de+=u*Be,we+=u*Ke,Me+=u*Fe,Ce+=u*Ge,_e+=u*We,pe+=u*Ye,le+=u*ke,ue+=u*Xe,ce+=u*qe,oe+=u*He,se+=u*Ae,ee+=u*Je,fe+=u*Ze,u=I[2],he+=u*je,ye+=u*Pe,de+=u*ze,we+=u*Be,Me+=u*Ke,Ce+=u*Fe,_e+=u*Ge,pe+=u*We,le+=u*Ye,ue+=u*ke,ce+=u*Xe,oe+=u*qe,se+=u*He,ee+=u*Ae,fe+=u*Je,ge+=u*Ze,u=I[3],ye+=u*je,de+=u*Pe,we+=u*ze,Me+=u*Be,Ce+=u*Ke,_e+=u*Fe,pe+=u*Ge,le+=u*We,ue+=u*Ye,ce+=u*ke,oe+=u*Xe,se+=u*qe,ee+=u*He,fe+=u*Ae,ge+=u*Je,re+=u*Ze,u=I[4],de+=u*je,we+=u*Pe,Me+=u*ze,Ce+=u*Be,_e+=u*Ke,pe+=u*Fe,le+=u*Ge,ue+=u*We,ce+=u*Ye,oe+=u*ke,se+=u*Xe,ee+=u*qe,fe+=u*He,ge+=u*Ae,re+=u*Je,ve+=u*Ze,u=I[5],we+=u*je,Me+=u*Pe,Ce+=u*ze,_e+=u*Be,pe+=u*Ke,le+=u*Fe,ue+=u*Ge,ce+=u*We,oe+=u*Ye,se+=u*ke,ee+=u*Xe,fe+=u*qe,ge+=u*He,re+=u*Ae,ve+=u*Je,be+=u*Ze,u=I[6],Me+=u*je,Ce+=u*Pe,_e+=u*ze,pe+=u*Be,le+=u*Ke,ue+=u*Fe,ce+=u*Ge,oe+=u*We,se+=u*Ye,ee+=u*ke,fe+=u*Xe,ge+=u*qe,re+=u*He,ve+=u*Ae,be+=u*Je,Ee+=u*Ze,u=I[7],Ce+=u*je,_e+=u*Pe,pe+=u*ze,le+=u*Be,ue+=u*Ke,ce+=u*Fe,oe+=u*Ge,se+=u*We,ee+=u*Ye,fe+=u*ke,ge+=u*Xe,re+=u*qe,ve+=u*He,be+=u*Ae,Ee+=u*Je,De+=u*Ze,u=I[8],_e+=u*je,pe+=u*Pe,le+=u*ze,ue+=u*Be,ce+=u*Ke,oe+=u*Fe,se+=u*Ge,ee+=u*We,fe+=u*Ye,ge+=u*ke,re+=u*Xe,ve+=u*qe,be+=u*He,Ee+=u*Ae,De+=u*Je,me+=u*Ze,u=I[9],pe+=u*je,le+=u*Pe,ue+=u*ze,ce+=u*Be,oe+=u*Ke,se+=u*Fe,ee+=u*Ge,fe+=u*We,ge+=u*Ye,re+=u*ke,ve+=u*Xe,be+=u*qe,Ee+=u*He,De+=u*Ae,me+=u*Je,Et+=u*Ze,u=I[10],le+=u*je,ue+=u*Pe,ce+=u*ze,oe+=u*Be,se+=u*Ke,ee+=u*Fe,fe+=u*Ge,ge+=u*We,re+=u*Ye,ve+=u*ke,be+=u*Xe,Ee+=u*qe,De+=u*He,me+=u*Ae,Et+=u*Je,Tt+=u*Ze,u=I[11],ue+=u*je,ce+=u*Pe,oe+=u*ze,se+=u*Be,ee+=u*Ke,fe+=u*Fe,ge+=u*Ge,re+=u*We,ve+=u*Ye,be+=u*ke,Ee+=u*Xe,De+=u*qe,me+=u*He,Et+=u*Ae,Tt+=u*Je,Bt+=u*Ze,u=I[12],ce+=u*je,oe+=u*Pe,se+=u*ze,ee+=u*Be,fe+=u*Ke,ge+=u*Fe,re+=u*Ge,ve+=u*We,be+=u*Ye,Ee+=u*ke,De+=u*Xe,me+=u*qe,Et+=u*He,Tt+=u*Ae,Bt+=u*Je,gt+=u*Ze,u=I[13],oe+=u*je,se+=u*Pe,ee+=u*ze,fe+=u*Be,ge+=u*Ke,re+=u*Fe,ve+=u*Ge,be+=u*We,Ee+=u*Ye,De+=u*ke,me+=u*Xe,Et+=u*qe,Tt+=u*He,Bt+=u*Ae,gt+=u*Je,er+=u*Ze,u=I[14],se+=u*je,ee+=u*Pe,fe+=u*ze,ge+=u*Be,re+=u*Ke,ve+=u*Fe,be+=u*Ge,Ee+=u*We,De+=u*Ye,me+=u*ke,Et+=u*Xe,Tt+=u*qe,Bt+=u*He,gt+=u*Ae,er+=u*Je,Hr+=u*Ze,u=I[15],ee+=u*je,fe+=u*Pe,ge+=u*ze,re+=u*Be,ve+=u*Ke,be+=u*Fe,Ee+=u*Ge,De+=u*We,me+=u*Ye,Et+=u*ke,Tt+=u*Xe,Bt+=u*qe,gt+=u*He,er+=u*Ae,Hr+=u*Je,mn+=u*Ze,H+=38*fe,V+=38*ge,he+=38*re,ye+=38*ve,de+=38*be,we+=38*Ee,Me+=38*De,Ce+=38*me,_e+=38*Et,pe+=38*Tt,le+=38*Bt,ue+=38*gt,ce+=38*er,oe+=38*Hr,se+=38*mn,_=1,u=H+_+65535,_=Math.floor(u/65536),H=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=we+_+65535,_=Math.floor(u/65536),we=u-_*65536,u=Me+_+65535,_=Math.floor(u/65536),Me=u-_*65536,u=Ce+_+65535,_=Math.floor(u/65536),Ce=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,H+=_-1+37*(_-1),_=1,u=H+_+65535,_=Math.floor(u/65536),H=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=we+_+65535,_=Math.floor(u/65536),we=u-_*65536,u=Me+_+65535,_=Math.floor(u/65536),Me=u-_*65536,u=Ce+_+65535,_=Math.floor(u/65536),Ce=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,H+=_-1+37*(_-1),T[0]=H,T[1]=V,T[2]=he,T[3]=ye,T[4]=de,T[5]=we,T[6]=Me,T[7]=Ce,T[8]=_e,T[9]=pe,T[10]=le,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=se,T[15]=ee}function p(T,I){c(T,I,I)}function F(T,I){const S=i();let u;for(u=0;u<16;u++)S[u]=I[u];for(u=253;u>=0;u--)p(S,S),u!==2&&u!==4&&c(S,S,I);for(u=0;u<16;u++)T[u]=S[u]}function z(T,I){const S=i();let u;for(u=0;u<16;u++)S[u]=I[u];for(u=250;u>=0;u--)p(S,S),u!==1&&c(S,S,I);for(u=0;u<16;u++)T[u]=S[u]}function k(T,I){const S=i(),u=i(),_=i(),H=i(),V=i(),he=i(),ye=i(),de=i(),we=i();v(S,T[1],T[0]),v(we,I[1],I[0]),c(S,S,we),m(u,T[0],T[1]),m(we,I[0],I[1]),c(u,u,we),c(_,T[3],I[3]),c(_,_,f),c(H,T[2],I[2]),m(H,H,H),v(V,u,S),v(he,H,_),m(ye,H,_),m(de,u,S),c(T[0],V,he),c(T[1],de,ye),c(T[2],ye,he),c(T[3],V,de)}function X(T,I,S){for(let u=0;u<4;u++)R(T[u],I[u],S)}function J(T,I){const S=i(),u=i(),_=i();F(_,I[2]),c(S,I[0],_),c(u,I[1],_),L(T,u),T[31]^=O(S)<<7}function A(T,I,S){b(T[0],o),b(T[1],a),b(T[2],a),b(T[3],o);for(let u=255;u>=0;--u){const _=S[u/8|0]>>(u&7)&1;X(T,I,_),k(I,T),k(T,T),X(T,I,_)}}function N(T,I){const S=[i(),i(),i(),i()];b(S[0],l),b(S[1],w),b(S[2],a),c(S[3],l,w),A(T,S,I)}function W(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const I=(0,r.hash)(T);I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(32),u=[i(),i(),i(),i()];N(u,I),J(S,u);const _=new Uint8Array(64);return _.set(T),_.set(S,32),{publicKey:S,secretKey:_}}t.generateKeyPairFromSeed=W;function j(T){const I=(0,e.randomBytes)(32,T),S=W(I);return(0,n.wipe)(I),S}t.generateKeyPair=j;function P(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=P;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(T,I){let S,u,_,H;for(u=63;u>=32;--u){for(S=0,_=u-32,H=u-12;_<H;++_)I[_]+=S-16*I[u]*$[_-(u-32)],S=Math.floor((I[_]+128)/256),I[_]-=S*256;I[_]+=S,I[u]=0}for(S=0,_=0;_<32;_++)I[_]+=S-(I[31]>>4)*$[_],S=I[_]>>8,I[_]&=255;for(_=0;_<32;_++)I[_]-=S*$[_];for(u=0;u<32;u++)I[u+1]+=I[u]>>8,T[u]=I[u]&255}function B(T){const I=new Float64Array(64);for(let S=0;S<64;S++)I[S]=T[S];for(let S=0;S<64;S++)T[S]=0;M(T,I)}function ne(T,I){const S=new Float64Array(64),u=[i(),i(),i(),i()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const H=new Uint8Array(64);H.set(_.subarray(32),32);const V=new r.SHA512;V.update(H.subarray(32)),V.update(I);const he=V.digest();V.clean(),B(he),N(u,he),J(H,u),V.reset(),V.update(H.subarray(0,32)),V.update(T.subarray(32)),V.update(I);const ye=V.digest();B(ye);for(let de=0;de<32;de++)S[de]=he[de];for(let de=0;de<32;de++)for(let we=0;we<32;we++)S[de+we]+=ye[de]*_[we];return M(H.subarray(32),S),H}t.sign=ne;function K(T,I){const S=i(),u=i(),_=i(),H=i(),V=i(),he=i(),ye=i();return b(T[2],a),g(T[1],I),p(_,T[1]),c(H,_,h),v(_,_,T[2]),m(H,T[2],H),p(V,H),p(he,V),c(ye,he,V),c(S,ye,_),c(S,S,H),z(S,S),c(S,S,_),c(S,S,H),c(S,S,H),c(T[0],S,H),p(u,T[0]),c(u,u,H),E(u,_)&&c(T[0],T[0],y),p(u,T[0]),c(u,u,H),E(u,_)?-1:(O(T[0])===I[31]>>7&&v(T[0],o,T[0]),c(T[3],T[0],T[1]),0)}function Q(T,I,S){const u=new Uint8Array(32),_=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(S.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(K(H,T))return!1;const V=new r.SHA512;V.update(S.subarray(0,32)),V.update(T),V.update(I);const he=V.digest();return B(he),A(_,H,he),N(H,S.subarray(32)),k(_,H),J(u,_),!U(S,u)}t.verify=Q;function Y(T){let I=[i(),i(),i(),i()];if(K(I,T))throw new Error("Ed25519: invalid public key");let S=i(),u=i(),_=I[1];m(S,a,_),v(u,a,_),F(u,u),c(S,S,u);let H=new Uint8Array(32);return L(H,S),H}t.convertPublicKeyToX25519=Y;function ae(T){const I=(0,r.hash)(T.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(I.subarray(0,32));return(0,n.wipe)(I),S}t.convertSecretKeyToX25519=ae}(Jn);const jh="EdDSA",zh="JWT",no=".",io="base64url",Bh="utf8",Kh="utf8",Hh=":",qh="did",Vh="key",so="base58btc",Gh="z",Wh="K36",Yh=32;function oo(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ri(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=oo(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function kh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,h=t.charAt(0),f=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function w(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var R=0,L=0,U=0,E=D.length;U!==E&&D[U]===0;)U++,R++;for(var O=(E-U)*l+1>>>0,g=new Uint8Array(O);U!==E;){for(var m=D[U],v=0,c=O-1;(m!==0||v<L)&&c!==-1;c--,v++)m+=256*g[c]>>>0,g[c]=m%a>>>0,m=m/a>>>0;if(m!==0)throw new Error("Non-zero carry");L=v,U++}for(var p=O-L;p!==O&&g[p]===0;)p++;for(var F=h.repeat(R);p<O;++p)F+=t.charAt(g[p]);return F}function y(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var R=0;if(D[R]!==" "){for(var L=0,U=0;D[R]===h;)L++,R++;for(var E=(D.length-R)*f+1>>>0,O=new Uint8Array(E);D[R];){var g=r[D.charCodeAt(R)];if(g===255)return;for(var m=0,v=E-1;(g!==0||m<U)&&v!==-1;v--,m++)g+=a*O[v]>>>0,O[v]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");U=m,R++}if(D[R]!==" "){for(var c=E-U;c!==E&&O[c]===0;)c++;for(var p=new Uint8Array(L+(E-c)),F=L;c!==E;)p[F++]=O[c++];return p}}}function b(D){var R=y(D);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:y,decode:b}}var Xh=kh,Jh=Xh;const ao=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Zh=t=>new TextEncoder().encode(t),Qh=t=>new TextDecoder().decode(t);class el{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class tl{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return co(this,e)}}class rl{constructor(e){this.decoders=e}or(e){return co(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const co=(t,e)=>new rl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class nl{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new el(e,r,n),this.decoder=new tl(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const cn=({name:t,prefix:e,encode:r,decode:n})=>new nl(t,e,r,n),Lr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Jh(r,e);return cn({prefix:t,name:e,encode:n,decode:s=>ao(i(s))})},il=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,f=0;for(let l=0;l<s;++l){const w=i[t[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|w,a+=r,a>=8&&(a-=8,o[f++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},sl=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>cn({prefix:e,name:t,encode(i){return sl(i,n,r)},decode(i){return il(i,n,r,t)}}),ol=cn({prefix:"\0",name:"identity",encode:t=>Qh(t),decode:t=>Zh(t)});var al=Object.freeze({__proto__:null,identity:ol});const cl=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ul=Object.freeze({__proto__:null,base2:cl});const fl=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var hl=Object.freeze({__proto__:null,base8:fl});const ll=Lr({prefix:"9",name:"base10",alphabet:"0123456789"});var dl=Object.freeze({__proto__:null,base10:ll});const pl=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),gl=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _l=Object.freeze({__proto__:null,base16:pl,base16upper:gl});const yl=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vl=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bl=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wl=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ml=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),El=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dl=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Sl=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xl=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ol=Object.freeze({__proto__:null,base32:yl,base32upper:vl,base32pad:bl,base32padupper:wl,base32hex:ml,base32hexupper:El,base32hexpad:Dl,base32hexpadupper:Sl,base32z:xl});const Il=Lr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Tl=Lr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nl=Object.freeze({__proto__:null,base36:Il,base36upper:Tl});const Al=Lr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ll=Lr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Rl=Object.freeze({__proto__:null,base58btc:Al,base58flickr:Ll});const Cl=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Pl=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Fl=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$l=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ul=Object.freeze({__proto__:null,base64:Cl,base64pad:Pl,base64url:Fl,base64urlpad:$l});const uo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ml=uo.reduce((t,e,r)=>(t[r]=e,t),[]),jl=uo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function zl(t){return t.reduce((e,r)=>(e+=Ml[r],e),"")}function Bl(t){const e=[];for(const r of t){const n=jl[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Kl=cn({prefix:"\u{1F680}",name:"base256emoji",encode:zl,decode:Bl});var Hl=Object.freeze({__proto__:null,base256emoji:Kl}),ql=ho,fo=128,Vl=127,Gl=~Vl,Wl=Math.pow(2,31);function ho(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Wl;)e[r++]=t&255|fo,t/=128;for(;t&Gl;)e[r++]=t&255|fo,t>>>=7;return e[r]=t|0,ho.bytes=r-n+1,e}var Yl=ni,kl=128,lo=127;function ni(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw ni.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&lo)<<i:(o&lo)*Math.pow(2,i),i+=7}while(o>=kl);return ni.bytes=s-n,r}var Xl=Math.pow(2,7),Jl=Math.pow(2,14),Zl=Math.pow(2,21),Ql=Math.pow(2,28),ed=Math.pow(2,35),td=Math.pow(2,42),rd=Math.pow(2,49),nd=Math.pow(2,56),id=Math.pow(2,63),sd=function(t){return t<Xl?1:t<Jl?2:t<Zl?3:t<Ql?4:t<ed?5:t<td?6:t<rd?7:t<nd?8:t<id?9:10},od={encode:ql,decode:Yl,encodingLength:sd},po=od;const go=(t,e,r=0)=>(po.encode(t,e,r),e),_o=t=>po.encodingLength(t),ii=(t,e)=>{const r=e.byteLength,n=_o(t),i=n+_o(r),s=new Uint8Array(i+r);return go(t,s,0),go(r,s,n),s.set(e,i),new ad(t,r,e,s)};class ad{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const yo=({name:t,code:e,encode:r})=>new cd(t,e,r);class cd{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ii(this.code,r):r.then(n=>ii(this.code,n))}else throw Error("Unknown type, must be binary type")}}const vo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),ud=yo({name:"sha2-256",code:18,encode:vo("SHA-256")}),fd=yo({name:"sha2-512",code:19,encode:vo("SHA-512")});var hd=Object.freeze({__proto__:null,sha256:ud,sha512:fd});const bo=0,ld="identity",wo=ao;var dd=Object.freeze({__proto__:null,identity:{code:bo,name:ld,encode:wo,digest:t=>ii(bo,wo(t))}});new TextEncoder,new TextDecoder;const mo={...al,...ul,...hl,...dl,..._l,...Ol,...Nl,...Rl,...Ul,...Hl};({...hd,...dd});function Eo(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Do=Eo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),si=Eo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=oo(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),So={utf8:Do,"utf-8":Do,hex:mo.base16,latin1:si,ascii:si,binary:si,...mo};function ut(t,e="utf8"){const r=So[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ft(t,e="utf8"){const r=So[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function un(t){return ut(ft(Xn(t),Bh),io)}function xo(t){const e=ft(Wh,so),r=Gh+ut(ri([e,t]),so);return[qh,Vh,r].join(Hh)}function pd(t){return ut(t,io)}function gd(t){return ft([un(t.header),un(t.payload)].join(no),Kh)}function _d(t){return[un(t.header),un(t.payload),pd(t.signature)].join(no)}function Oo(t=fr.randomBytes(Yh)){return Jn.generateKeyPairFromSeed(t)}async function yd(t,e,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:jh,typ:zh},o=xo(n.publicKey),a=i+r,h={iss:o,sub:t,aud:e,iat:i,exp:a},f=gd({header:s,payload:h}),l=Jn.sign(n.secretKey,f);return _d({header:s,payload:h,signature:l})}var oi={},fn={};Object.defineProperty(fn,"__esModule",{value:!0});var st=te,ai=pt,vd=20;function bd(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],y=r[23]<<24|r[22]<<16|r[21]<<8|r[20],b=r[27]<<24|r[26]<<16|r[25]<<8|r[24],D=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],L=e[7]<<24|e[6]<<16|e[5]<<8|e[4],U=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],O=n,g=i,m=s,v=o,c=a,p=h,F=f,z=l,k=w,X=y,J=b,A=D,N=R,W=L,j=U,P=E,$=0;$<vd;$+=2)O=O+c|0,N^=O,N=N>>>32-16|N<<16,k=k+N|0,c^=k,c=c>>>32-12|c<<12,g=g+p|0,W^=g,W=W>>>32-16|W<<16,X=X+W|0,p^=X,p=p>>>32-12|p<<12,m=m+F|0,j^=m,j=j>>>32-16|j<<16,J=J+j|0,F^=J,F=F>>>32-12|F<<12,v=v+z|0,P^=v,P=P>>>32-16|P<<16,A=A+P|0,z^=A,z=z>>>32-12|z<<12,m=m+F|0,j^=m,j=j>>>32-8|j<<8,J=J+j|0,F^=J,F=F>>>32-7|F<<7,v=v+z|0,P^=v,P=P>>>32-8|P<<8,A=A+P|0,z^=A,z=z>>>32-7|z<<7,g=g+p|0,W^=g,W=W>>>32-8|W<<8,X=X+W|0,p^=X,p=p>>>32-7|p<<7,O=O+c|0,N^=O,N=N>>>32-8|N<<8,k=k+N|0,c^=k,c=c>>>32-7|c<<7,O=O+p|0,P^=O,P=P>>>32-16|P<<16,J=J+P|0,p^=J,p=p>>>32-12|p<<12,g=g+F|0,N^=g,N=N>>>32-16|N<<16,A=A+N|0,F^=A,F=F>>>32-12|F<<12,m=m+z|0,W^=m,W=W>>>32-16|W<<16,k=k+W|0,z^=k,z=z>>>32-12|z<<12,v=v+c|0,j^=v,j=j>>>32-16|j<<16,X=X+j|0,c^=X,c=c>>>32-12|c<<12,m=m+z|0,W^=m,W=W>>>32-8|W<<8,k=k+W|0,z^=k,z=z>>>32-7|z<<7,v=v+c|0,j^=v,j=j>>>32-8|j<<8,X=X+j|0,c^=X,c=c>>>32-7|c<<7,g=g+F|0,N^=g,N=N>>>32-8|N<<8,A=A+N|0,F^=A,F=F>>>32-7|F<<7,O=O+p|0,P^=O,P=P>>>32-8|P<<8,J=J+P|0,p^=J,p=p>>>32-7|p<<7;st.writeUint32LE(O+n|0,t,0),st.writeUint32LE(g+i|0,t,4),st.writeUint32LE(m+s|0,t,8),st.writeUint32LE(v+o|0,t,12),st.writeUint32LE(c+a|0,t,16),st.writeUint32LE(p+h|0,t,20),st.writeUint32LE(F+f|0,t,24),st.writeUint32LE(z+l|0,t,28),st.writeUint32LE(k+w|0,t,32),st.writeUint32LE(X+y|0,t,36),st.writeUint32LE(J+b|0,t,40),st.writeUint32LE(A+D|0,t,44),st.writeUint32LE(N+R|0,t,48),st.writeUint32LE(W+L|0,t,52),st.writeUint32LE(j+U|0,t,56),st.writeUint32LE(P+E|0,t,60)}function Io(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=i}for(var a=new Uint8Array(64),h=0;h<r.length;h+=64){bd(a,s,t);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^a[f-h];md(s,0,o)}return ai.wipe(a),i===0&&ai.wipe(s),n}fn.streamXOR=Io;function wd(t,e,r,n){return n===void 0&&(n=0),ai.wipe(r),Io(t,e,r,r,n)}fn.stream=wd;function md(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var To={},Ut={};Object.defineProperty(Ut,"__esModule",{value:!0});function Ed(t,e,r){return~(t-1)&e|t-1&r}Ut.select=Ed;function Dd(t,e){return(t|0)-(e|0)-1>>>31&1}Ut.lessOrEqual=Dd;function No(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Ut.compare=No;function Sd(t,e){return t.length===0||e.length===0?!1:No(t,e)!==0}Ut.equal=Sd,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ut,r=pt;t.DIGEST_LENGTH=16;var n=function(){function o(a){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=a[0]|a[1]<<8;this._r[0]=h&8191;var f=a[2]|a[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var l=a[4]|a[5]<<8;this._r[2]=(f>>>10|l<<6)&7939;var w=a[6]|a[7]<<8;this._r[3]=(l>>>7|w<<9)&8191;var y=a[8]|a[9]<<8;this._r[4]=(w>>>4|y<<12)&255,this._r[5]=y>>>1&8190;var b=a[10]|a[11]<<8;this._r[6]=(y>>>14|b<<2)&8191;var D=a[12]|a[13]<<8;this._r[7]=(b>>>11|D<<5)&8065;var R=a[14]|a[15]<<8;this._r[8]=(D>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=a[16]|a[17]<<8,this._pad[1]=a[18]|a[19]<<8,this._pad[2]=a[20]|a[21]<<8,this._pad[3]=a[22]|a[23]<<8,this._pad[4]=a[24]|a[25]<<8,this._pad[5]=a[26]|a[27]<<8,this._pad[6]=a[28]|a[29]<<8,this._pad[7]=a[30]|a[31]<<8}return o.prototype._blocks=function(a,h,f){for(var l=this._fin?0:2048,w=this._h[0],y=this._h[1],b=this._h[2],D=this._h[3],R=this._h[4],L=this._h[5],U=this._h[6],E=this._h[7],O=this._h[8],g=this._h[9],m=this._r[0],v=this._r[1],c=this._r[2],p=this._r[3],F=this._r[4],z=this._r[5],k=this._r[6],X=this._r[7],J=this._r[8],A=this._r[9];f>=16;){var N=a[h+0]|a[h+1]<<8;w+=N&8191;var W=a[h+2]|a[h+3]<<8;y+=(N>>>13|W<<3)&8191;var j=a[h+4]|a[h+5]<<8;b+=(W>>>10|j<<6)&8191;var P=a[h+6]|a[h+7]<<8;D+=(j>>>7|P<<9)&8191;var $=a[h+8]|a[h+9]<<8;R+=(P>>>4|$<<12)&8191,L+=$>>>1&8191;var M=a[h+10]|a[h+11]<<8;U+=($>>>14|M<<2)&8191;var B=a[h+12]|a[h+13]<<8;E+=(M>>>11|B<<5)&8191;var ne=a[h+14]|a[h+15]<<8;O+=(B>>>8|ne<<8)&8191,g+=ne>>>5|l;var K=0,Q=K;Q+=w*m,Q+=y*(5*A),Q+=b*(5*J),Q+=D*(5*X),Q+=R*(5*k),K=Q>>>13,Q&=8191,Q+=L*(5*z),Q+=U*(5*F),Q+=E*(5*p),Q+=O*(5*c),Q+=g*(5*v),K+=Q>>>13,Q&=8191;var Y=K;Y+=w*v,Y+=y*m,Y+=b*(5*A),Y+=D*(5*J),Y+=R*(5*X),K=Y>>>13,Y&=8191,Y+=L*(5*k),Y+=U*(5*z),Y+=E*(5*F),Y+=O*(5*p),Y+=g*(5*c),K+=Y>>>13,Y&=8191;var ae=K;ae+=w*c,ae+=y*v,ae+=b*m,ae+=D*(5*A),ae+=R*(5*J),K=ae>>>13,ae&=8191,ae+=L*(5*X),ae+=U*(5*k),ae+=E*(5*z),ae+=O*(5*F),ae+=g*(5*p),K+=ae>>>13,ae&=8191;var T=K;T+=w*p,T+=y*c,T+=b*v,T+=D*m,T+=R*(5*A),K=T>>>13,T&=8191,T+=L*(5*J),T+=U*(5*X),T+=E*(5*k),T+=O*(5*z),T+=g*(5*F),K+=T>>>13,T&=8191;var I=K;I+=w*F,I+=y*p,I+=b*c,I+=D*v,I+=R*m,K=I>>>13,I&=8191,I+=L*(5*A),I+=U*(5*J),I+=E*(5*X),I+=O*(5*k),I+=g*(5*z),K+=I>>>13,I&=8191;var S=K;S+=w*z,S+=y*F,S+=b*p,S+=D*c,S+=R*v,K=S>>>13,S&=8191,S+=L*m,S+=U*(5*A),S+=E*(5*J),S+=O*(5*X),S+=g*(5*k),K+=S>>>13,S&=8191;var u=K;u+=w*k,u+=y*z,u+=b*F,u+=D*p,u+=R*c,K=u>>>13,u&=8191,u+=L*v,u+=U*m,u+=E*(5*A),u+=O*(5*J),u+=g*(5*X),K+=u>>>13,u&=8191;var _=K;_+=w*X,_+=y*k,_+=b*z,_+=D*F,_+=R*p,K=_>>>13,_&=8191,_+=L*c,_+=U*v,_+=E*m,_+=O*(5*A),_+=g*(5*J),K+=_>>>13,_&=8191;var H=K;H+=w*J,H+=y*X,H+=b*k,H+=D*z,H+=R*F,K=H>>>13,H&=8191,H+=L*p,H+=U*c,H+=E*v,H+=O*m,H+=g*(5*A),K+=H>>>13,H&=8191;var V=K;V+=w*A,V+=y*J,V+=b*X,V+=D*k,V+=R*z,K=V>>>13,V&=8191,V+=L*F,V+=U*p,V+=E*c,V+=O*v,V+=g*m,K+=V>>>13,V&=8191,K=(K<<2)+K|0,K=K+Q|0,Q=K&8191,K=K>>>13,Y+=K,w=Q,y=Y,b=ae,D=T,R=I,L=S,U=u,E=_,O=H,g=V,h+=16,f-=16}this._h[0]=w,this._h[1]=y,this._h[2]=b,this._h[3]=D,this._h[4]=R,this._h[5]=L,this._h[6]=U,this._h[7]=E,this._h[8]=O,this._h[9]=g},o.prototype.finish=function(a,h){h===void 0&&(h=0);var f=new Uint16Array(10),l,w,y,b;if(this._leftover){for(b=this._leftover,this._buffer[b++]=1;b<16;b++)this._buffer[b]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,b=2;b<10;b++)this._h[b]+=l,l=this._h[b]>>>13,this._h[b]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,f[0]=this._h[0]+5,l=f[0]>>>13,f[0]&=8191,b=1;b<10;b++)f[b]=this._h[b]+l,l=f[b]>>>13,f[b]&=8191;for(f[9]-=1<<13,w=(l^1)-1,b=0;b<10;b++)f[b]&=w;for(w=~w,b=0;b<10;b++)this._h[b]=this._h[b]&w|f[b];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,y=this._h[0]+this._pad[0],this._h[0]=y&65535,b=1;b<8;b++)y=(this._h[b]+this._pad[b]|0)+(y>>>16)|0,this._h[b]=y&65535;return a[h+0]=this._h[0]>>>0,a[h+1]=this._h[0]>>>8,a[h+2]=this._h[1]>>>0,a[h+3]=this._h[1]>>>8,a[h+4]=this._h[2]>>>0,a[h+5]=this._h[2]>>>8,a[h+6]=this._h[3]>>>0,a[h+7]=this._h[3]>>>8,a[h+8]=this._h[4]>>>0,a[h+9]=this._h[4]>>>8,a[h+10]=this._h[5]>>>0,a[h+11]=this._h[5]>>>8,a[h+12]=this._h[6]>>>0,a[h+13]=this._h[6]>>>8,a[h+14]=this._h[7]>>>0,a[h+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(a){var h=0,f=a.length,l;if(this._leftover){l=16-this._leftover,l>f&&(l=f);for(var w=0;w<l;w++)this._buffer[this._leftover+w]=a[h+w];if(f-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(l=f-f%16,this._blocks(a,h,l),h+=l,f-=l),f){for(var w=0;w<f;w++)this._buffer[this._leftover+w]=a[h+w];this._leftover+=f}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var a=new Uint8Array(16);return this.finish(a),a},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();t.Poly1305=n;function i(o,a){var h=new n(o);h.update(a);var f=h.digest();return h.clean(),f}t.oneTimeAuth=i;function s(o,a){return o.length!==t.DIGEST_LENGTH||a.length!==t.DIGEST_LENGTH?!1:e.equal(o,a)}t.equal=s}(To),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=fn,r=To,n=pt,i=te,s=Ut;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),a=function(){function h(f){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,f.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,l,w,y){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var b=new Uint8Array(16);b.set(f,b.length-f.length);var D=new Uint8Array(32);e.stream(this._key,b,D,4);var R=l.length+this.tagLength,L;if(y){if(y.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");L=y}else L=new Uint8Array(R);return e.streamXOR(this._key,b,l,L,4),this._authenticate(L.subarray(L.length-this.tagLength,L.length),D,L.subarray(0,L.length-this.tagLength),w),n.wipe(b),L},h.prototype.open=function(f,l,w,y){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var b=new Uint8Array(16);b.set(f,b.length-f.length);var D=new Uint8Array(32);e.stream(this._key,b,D,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,D,l.subarray(0,l.length-this.tagLength),w),!s.equal(R,l.subarray(l.length-this.tagLength,l.length)))return null;var L=l.length-this.tagLength,U;if(y){if(y.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");U=y}else U=new Uint8Array(L);return e.streamXOR(this._key,b,l.subarray(0,l.length-this.tagLength),U,4),n.wipe(b),U},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,l,w,y){var b=new r.Poly1305(l);y&&(b.update(y),y.length%16>0&&b.update(o.subarray(y.length%16))),b.update(w),w.length%16>0&&b.update(o.subarray(w.length%16));var D=new Uint8Array(8);y&&i.writeUint64LE(y.length,D),b.update(D),i.writeUint64LE(w.length,D),b.update(D);for(var R=b.digest(),L=0;L<R.length;L++)f[L]=R[L];b.clean(),n.wipe(R),n.wipe(D)},h}();t.ChaCha20Poly1305=a}(oi);var Ao={},Rr={},ci={};Object.defineProperty(ci,"__esModule",{value:!0});function xd(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}ci.isSerializableHash=xd,Object.defineProperty(Rr,"__esModule",{value:!0});var xt=ci,Od=Ut,Id=pt,Lo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),xt.isSerializableHash(this._inner)&&xt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Id.wipe(n)}return t.prototype.reset=function(){if(!xt.isSerializableHash(this._inner)||!xt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){xt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),xt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!xt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!xt.isSerializableHash(this._inner)||!xt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!xt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Rr.HMAC=Lo;function Td(t,e,r){var n=new Lo(t,e);n.update(r);var i=n.digest();return n.clean(),i}Rr.hmac=Td,Rr.equal=Od.equal,Object.defineProperty(Ao,"__esModule",{value:!0});var Ro=Rr,Co=pt,Nd=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=Ro.hmac(this._hash,n,r);this._hmac=new Ro.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Co.wipe(this._buffer),Co.wipe(this._counter),this._bufpos=0},t}(),Ad=Ao.HKDF=Nd,hn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=pt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},a.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._temp,this._state,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},a.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,y=f<<3,b=f%64<56?64:128;this._buffer[l]=128;for(var D=l+1;D<b-8;D++)this._buffer[D]=0;e.writeUint32BE(w,this._buffer,b-8),e.writeUint32BE(y,this._buffer,b-4),s(this._temp,this._state,this._buffer,0,b),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)e.writeUint32BE(this._state[D],h,D*4);return this},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},a}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(a,h,f,l,w){for(;w>=64;){for(var y=h[0],b=h[1],D=h[2],R=h[3],L=h[4],U=h[5],E=h[6],O=h[7],g=0;g<16;g++){var m=l+g*4;a[g]=e.readUint32BE(f,m)}for(var g=16;g<64;g++){var v=a[g-2],c=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=a[g-15];var p=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;a[g]=(c+a[g-7]|0)+(p+a[g-16]|0)}for(var g=0;g<64;g++){var c=(((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))+(L&U^~L&E)|0)+(O+(i[g]+a[g]|0)|0)|0,p=((y>>>2|y<<32-2)^(y>>>13|y<<32-13)^(y>>>22|y<<32-22))+(y&b^y&D^b&D)|0;O=E,E=U,U=L,L=R+c|0,R=D,D=b,b=y,y=c+p|0}h[0]+=y,h[1]+=b,h[2]+=D,h[3]+=R,h[4]+=L,h[5]+=U,h[6]+=E,h[7]+=O,l+=64,w-=64}return l}function o(a){var h=new n;h.update(a);var f=h.digest();return h.clean(),f}t.hash=o})(hn);var ui={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=fr,r=pt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(g){const m=new Float64Array(16);if(g)for(let v=0;v<g.length;v++)m[v]=g[v];return m}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function o(g){let m=1;for(let v=0;v<16;v++){let c=g[v]+m+65535;m=Math.floor(c/65536),g[v]=c-m*65536}g[0]+=m-1+37*(m-1)}function a(g,m,v){const c=~(v-1);for(let p=0;p<16;p++){const F=c&(g[p]^m[p]);g[p]^=F,m[p]^=F}}function h(g,m){const v=n(),c=n();for(let p=0;p<16;p++)c[p]=m[p];o(c),o(c),o(c);for(let p=0;p<2;p++){v[0]=c[0]-65517;for(let z=1;z<15;z++)v[z]=c[z]-65535-(v[z-1]>>16&1),v[z-1]&=65535;v[15]=c[15]-32767-(v[14]>>16&1);const F=v[15]>>16&1;v[14]&=65535,a(c,v,1-F)}for(let p=0;p<16;p++)g[2*p]=c[p]&255,g[2*p+1]=c[p]>>8}function f(g,m){for(let v=0;v<16;v++)g[v]=m[2*v]+(m[2*v+1]<<8);g[15]&=32767}function l(g,m,v){for(let c=0;c<16;c++)g[c]=m[c]+v[c]}function w(g,m,v){for(let c=0;c<16;c++)g[c]=m[c]-v[c]}function y(g,m,v){let c,p,F=0,z=0,k=0,X=0,J=0,A=0,N=0,W=0,j=0,P=0,$=0,M=0,B=0,ne=0,K=0,Q=0,Y=0,ae=0,T=0,I=0,S=0,u=0,_=0,H=0,V=0,he=0,ye=0,de=0,we=0,Me=0,Ce=0,_e=v[0],pe=v[1],le=v[2],ue=v[3],ce=v[4],oe=v[5],se=v[6],ee=v[7],fe=v[8],ge=v[9],re=v[10],ve=v[11],be=v[12],Ee=v[13],De=v[14],me=v[15];c=m[0],F+=c*_e,z+=c*pe,k+=c*le,X+=c*ue,J+=c*ce,A+=c*oe,N+=c*se,W+=c*ee,j+=c*fe,P+=c*ge,$+=c*re,M+=c*ve,B+=c*be,ne+=c*Ee,K+=c*De,Q+=c*me,c=m[1],z+=c*_e,k+=c*pe,X+=c*le,J+=c*ue,A+=c*ce,N+=c*oe,W+=c*se,j+=c*ee,P+=c*fe,$+=c*ge,M+=c*re,B+=c*ve,ne+=c*be,K+=c*Ee,Q+=c*De,Y+=c*me,c=m[2],k+=c*_e,X+=c*pe,J+=c*le,A+=c*ue,N+=c*ce,W+=c*oe,j+=c*se,P+=c*ee,$+=c*fe,M+=c*ge,B+=c*re,ne+=c*ve,K+=c*be,Q+=c*Ee,Y+=c*De,ae+=c*me,c=m[3],X+=c*_e,J+=c*pe,A+=c*le,N+=c*ue,W+=c*ce,j+=c*oe,P+=c*se,$+=c*ee,M+=c*fe,B+=c*ge,ne+=c*re,K+=c*ve,Q+=c*be,Y+=c*Ee,ae+=c*De,T+=c*me,c=m[4],J+=c*_e,A+=c*pe,N+=c*le,W+=c*ue,j+=c*ce,P+=c*oe,$+=c*se,M+=c*ee,B+=c*fe,ne+=c*ge,K+=c*re,Q+=c*ve,Y+=c*be,ae+=c*Ee,T+=c*De,I+=c*me,c=m[5],A+=c*_e,N+=c*pe,W+=c*le,j+=c*ue,P+=c*ce,$+=c*oe,M+=c*se,B+=c*ee,ne+=c*fe,K+=c*ge,Q+=c*re,Y+=c*ve,ae+=c*be,T+=c*Ee,I+=c*De,S+=c*me,c=m[6],N+=c*_e,W+=c*pe,j+=c*le,P+=c*ue,$+=c*ce,M+=c*oe,B+=c*se,ne+=c*ee,K+=c*fe,Q+=c*ge,Y+=c*re,ae+=c*ve,T+=c*be,I+=c*Ee,S+=c*De,u+=c*me,c=m[7],W+=c*_e,j+=c*pe,P+=c*le,$+=c*ue,M+=c*ce,B+=c*oe,ne+=c*se,K+=c*ee,Q+=c*fe,Y+=c*ge,ae+=c*re,T+=c*ve,I+=c*be,S+=c*Ee,u+=c*De,_+=c*me,c=m[8],j+=c*_e,P+=c*pe,$+=c*le,M+=c*ue,B+=c*ce,ne+=c*oe,K+=c*se,Q+=c*ee,Y+=c*fe,ae+=c*ge,T+=c*re,I+=c*ve,S+=c*be,u+=c*Ee,_+=c*De,H+=c*me,c=m[9],P+=c*_e,$+=c*pe,M+=c*le,B+=c*ue,ne+=c*ce,K+=c*oe,Q+=c*se,Y+=c*ee,ae+=c*fe,T+=c*ge,I+=c*re,S+=c*ve,u+=c*be,_+=c*Ee,H+=c*De,V+=c*me,c=m[10],$+=c*_e,M+=c*pe,B+=c*le,ne+=c*ue,K+=c*ce,Q+=c*oe,Y+=c*se,ae+=c*ee,T+=c*fe,I+=c*ge,S+=c*re,u+=c*ve,_+=c*be,H+=c*Ee,V+=c*De,he+=c*me,c=m[11],M+=c*_e,B+=c*pe,ne+=c*le,K+=c*ue,Q+=c*ce,Y+=c*oe,ae+=c*se,T+=c*ee,I+=c*fe,S+=c*ge,u+=c*re,_+=c*ve,H+=c*be,V+=c*Ee,he+=c*De,ye+=c*me,c=m[12],B+=c*_e,ne+=c*pe,K+=c*le,Q+=c*ue,Y+=c*ce,ae+=c*oe,T+=c*se,I+=c*ee,S+=c*fe,u+=c*ge,_+=c*re,H+=c*ve,V+=c*be,he+=c*Ee,ye+=c*De,de+=c*me,c=m[13],ne+=c*_e,K+=c*pe,Q+=c*le,Y+=c*ue,ae+=c*ce,T+=c*oe,I+=c*se,S+=c*ee,u+=c*fe,_+=c*ge,H+=c*re,V+=c*ve,he+=c*be,ye+=c*Ee,de+=c*De,we+=c*me,c=m[14],K+=c*_e,Q+=c*pe,Y+=c*le,ae+=c*ue,T+=c*ce,I+=c*oe,S+=c*se,u+=c*ee,_+=c*fe,H+=c*ge,V+=c*re,he+=c*ve,ye+=c*be,de+=c*Ee,we+=c*De,Me+=c*me,c=m[15],Q+=c*_e,Y+=c*pe,ae+=c*le,T+=c*ue,I+=c*ce,S+=c*oe,u+=c*se,_+=c*ee,H+=c*fe,V+=c*ge,he+=c*re,ye+=c*ve,de+=c*be,we+=c*Ee,Me+=c*De,Ce+=c*me,F+=38*Y,z+=38*ae,k+=38*T,X+=38*I,J+=38*S,A+=38*u,N+=38*_,W+=38*H,j+=38*V,P+=38*he,$+=38*ye,M+=38*de,B+=38*we,ne+=38*Me,K+=38*Ce,p=1,c=F+p+65535,p=Math.floor(c/65536),F=c-p*65536,c=z+p+65535,p=Math.floor(c/65536),z=c-p*65536,c=k+p+65535,p=Math.floor(c/65536),k=c-p*65536,c=X+p+65535,p=Math.floor(c/65536),X=c-p*65536,c=J+p+65535,p=Math.floor(c/65536),J=c-p*65536,c=A+p+65535,p=Math.floor(c/65536),A=c-p*65536,c=N+p+65535,p=Math.floor(c/65536),N=c-p*65536,c=W+p+65535,p=Math.floor(c/65536),W=c-p*65536,c=j+p+65535,p=Math.floor(c/65536),j=c-p*65536,c=P+p+65535,p=Math.floor(c/65536),P=c-p*65536,c=$+p+65535,p=Math.floor(c/65536),$=c-p*65536,c=M+p+65535,p=Math.floor(c/65536),M=c-p*65536,c=B+p+65535,p=Math.floor(c/65536),B=c-p*65536,c=ne+p+65535,p=Math.floor(c/65536),ne=c-p*65536,c=K+p+65535,p=Math.floor(c/65536),K=c-p*65536,c=Q+p+65535,p=Math.floor(c/65536),Q=c-p*65536,F+=p-1+37*(p-1),p=1,c=F+p+65535,p=Math.floor(c/65536),F=c-p*65536,c=z+p+65535,p=Math.floor(c/65536),z=c-p*65536,c=k+p+65535,p=Math.floor(c/65536),k=c-p*65536,c=X+p+65535,p=Math.floor(c/65536),X=c-p*65536,c=J+p+65535,p=Math.floor(c/65536),J=c-p*65536,c=A+p+65535,p=Math.floor(c/65536),A=c-p*65536,c=N+p+65535,p=Math.floor(c/65536),N=c-p*65536,c=W+p+65535,p=Math.floor(c/65536),W=c-p*65536,c=j+p+65535,p=Math.floor(c/65536),j=c-p*65536,c=P+p+65535,p=Math.floor(c/65536),P=c-p*65536,c=$+p+65535,p=Math.floor(c/65536),$=c-p*65536,c=M+p+65535,p=Math.floor(c/65536),M=c-p*65536,c=B+p+65535,p=Math.floor(c/65536),B=c-p*65536,c=ne+p+65535,p=Math.floor(c/65536),ne=c-p*65536,c=K+p+65535,p=Math.floor(c/65536),K=c-p*65536,c=Q+p+65535,p=Math.floor(c/65536),Q=c-p*65536,F+=p-1+37*(p-1),g[0]=F,g[1]=z,g[2]=k,g[3]=X,g[4]=J,g[5]=A,g[6]=N,g[7]=W,g[8]=j,g[9]=P,g[10]=$,g[11]=M,g[12]=B,g[13]=ne,g[14]=K,g[15]=Q}function b(g,m){y(g,m,m)}function D(g,m){const v=n();for(let c=0;c<16;c++)v[c]=m[c];for(let c=253;c>=0;c--)b(v,v),c!==2&&c!==4&&y(v,v,m);for(let c=0;c<16;c++)g[c]=v[c]}function R(g,m){const v=new Uint8Array(32),c=new Float64Array(80),p=n(),F=n(),z=n(),k=n(),X=n(),J=n();for(let j=0;j<31;j++)v[j]=g[j];v[31]=g[31]&127|64,v[0]&=248,f(c,m);for(let j=0;j<16;j++)F[j]=c[j];p[0]=k[0]=1;for(let j=254;j>=0;--j){const P=v[j>>>3]>>>(j&7)&1;a(p,F,P),a(z,k,P),l(X,p,z),w(p,p,z),l(z,F,k),w(F,F,k),b(k,X),b(J,p),y(p,z,p),y(z,F,X),l(X,p,z),w(p,p,z),b(F,p),w(z,k,J),y(p,z,s),l(p,p,k),y(z,z,p),y(p,k,J),y(k,F,c),b(F,X),a(p,F,P),a(z,k,P)}for(let j=0;j<16;j++)c[j+16]=p[j],c[j+32]=z[j],c[j+48]=F[j],c[j+64]=k[j];const A=c.subarray(32),N=c.subarray(16);D(A,A),y(N,N,A);const W=new Uint8Array(32);return h(W,N),W}t.scalarMult=R;function L(g){return R(g,i)}t.scalarMultBase=L;function U(g){if(g.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const m=new Uint8Array(g);return{publicKey:L(m),secretKey:m}}t.generateKeyPairFromSeed=U;function E(g){const m=(0,e.randomBytes)(32,g),v=U(m);return(0,r.wipe)(m),v}t.generateKeyPair=E;function O(g,m,v=!1){if(g.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(m.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=R(g,m);if(v){let p=0;for(let F=0;F<c.length;F++)p|=c[F];if(p===0)throw new Error("X25519: invalid shared key")}return c}t.sharedKey=O})(ui);var Po=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Ld=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),Rd=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Cd=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Pd=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Fd=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),$d=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Ud=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Fo=3,Md=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$d]],$o=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function jd(t){return t?Uo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Fd:typeof navigator<"u"?Uo(navigator.userAgent):Kd()}function zd(t){return t!==""&&Md.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Uo(t){var e=zd(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Pd;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Fo&&(i=Po(Po([],i,!0),Hd(Fo-i.length),!0)):i=[];var s=i.join("."),o=Bd(t),a=Ud.exec(t);return a&&a[1]?new Cd(r,s,o,a[1]):new Ld(r,s,o)}function Bd(t){for(var e=0,r=$o.length;e<r;e++){var n=$o[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function Kd(){var t=typeof process<"u"&&process.version;return t?new Rd(process.version.slice(1)):null}function Hd(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.getLocalStorage=Te.getLocalStorageOrThrow=Te.getCrypto=Te.getCryptoOrThrow=jo=Te.getLocation=Te.getLocationOrThrow=fi=Te.getNavigator=Te.getNavigatorOrThrow=Mo=Te.getDocument=Te.getDocumentOrThrow=Te.getFromWindowOrThrow=Te.getFromWindow=void 0;function Jt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Te.getFromWindow=Jt;function hr(t){const e=Jt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Te.getFromWindowOrThrow=hr;function qd(){return hr("document")}Te.getDocumentOrThrow=qd;function Vd(){return Jt("document")}var Mo=Te.getDocument=Vd;function Gd(){return hr("navigator")}Te.getNavigatorOrThrow=Gd;function Wd(){return Jt("navigator")}var fi=Te.getNavigator=Wd;function Yd(){return hr("location")}Te.getLocationOrThrow=Yd;function kd(){return Jt("location")}var jo=Te.getLocation=kd;function Xd(){return hr("crypto")}Te.getCryptoOrThrow=Xd;function Jd(){return Jt("crypto")}Te.getCrypto=Jd;function Zd(){return hr("localStorage")}Te.getLocalStorageOrThrow=Zd;function Qd(){return Jt("localStorage")}Te.getLocalStorage=Qd;var hi={};Object.defineProperty(hi,"__esModule",{value:!0});var zo=hi.getWindowMetadata=void 0;const Bo=Te;function ep(){let t,e;try{t=Bo.getDocumentOrThrow(),e=Bo.getLocationOrThrow()}catch{return null}function r(){const w=t.getElementsByTagName("link"),y=[];for(let b=0;b<w.length;b++){const D=w[b],R=D.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const L=D.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let U=e.protocol+"//"+e.host;if(L.indexOf("/")===0)U+=L;else{const E=e.pathname.split("/");E.pop();const O=E.join("/");U+=O+"/"+L}y.push(U)}else if(L.indexOf("//")===0){const U=e.protocol+L;y.push(U)}else y.push(L)}}return y}function n(...w){const y=t.getElementsByTagName("meta");for(let b=0;b<y.length;b++){const D=y[b],R=["itemprop","property","name"].map(L=>D.getAttribute(L)).filter(L=>L?w.includes(L):!1);if(R.length&&R){const L=D.getAttribute("content");if(L)return L}}return""}function i(){let w=n("name","og:site_name","og:title","twitter:title");return w||(w=t.title),w}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),a=s(),h=e.origin,f=r();return{description:a,url:h,icons:f,name:o}}zo=hi.getWindowMetadata=ep;var Cr={},tp=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Ko="%[a-f0-9]{2}",Ho=new RegExp(Ko,"gi"),qo=new RegExp("("+Ko+")+","gi");function li(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],li(r),li(n))}function rp(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Ho),r=1;r<e.length;r++)t=li(e,r).join(""),e=t.match(Ho);return t}}function np(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=qo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=rp(r[0]);n!==r[0]&&(e[r[0]]=n)}r=qo.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var o=i[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var ip=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return np(t)}},sp=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},op=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var o=n[s],a=t[o];(i?e.indexOf(o)!==-1:e(o,a,t))&&(r[o]=a)}return r};(function(t){const e=tp,r=ip,n=sp,i=op,s=E=>E==null,o=Symbol("encodeFragmentIdentifier");function a(E){switch(E.arrayFormat){case"index":return O=>(g,m)=>{const v=g.length;return m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,[l(O,E),"[",v,"]"].join("")]:[...g,[l(O,E),"[",l(v,E),"]=",l(m,E)].join("")]};case"bracket":return O=>(g,m)=>m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,[l(O,E),"[]"].join("")]:[...g,[l(O,E),"[]=",l(m,E)].join("")];case"colon-list-separator":return O=>(g,m)=>m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,[l(O,E),":list="].join("")]:[...g,[l(O,E),":list=",l(m,E)].join("")];case"comma":case"separator":case"bracket-separator":{const O=E.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(m,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?m:(v=v===null?"":v,m.length===0?[[l(g,E),O,l(v,E)].join("")]:[[m,l(v,E)].join(E.arrayFormatSeparator)])}default:return O=>(g,m)=>m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,l(O,E)]:[...g,[l(O,E),"=",l(m,E)].join("")]}}function h(E){let O;switch(E.arrayFormat){case"index":return(g,m,v)=>{if(O=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!O){v[g]=m;return}v[g]===void 0&&(v[g]={}),v[g][O[1]]=m};case"bracket":return(g,m,v)=>{if(O=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!O){v[g]=m;return}if(v[g]===void 0){v[g]=[m];return}v[g]=[].concat(v[g],m)};case"colon-list-separator":return(g,m,v)=>{if(O=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!O){v[g]=m;return}if(v[g]===void 0){v[g]=[m];return}v[g]=[].concat(v[g],m)};case"comma":case"separator":return(g,m,v)=>{const c=typeof m=="string"&&m.includes(E.arrayFormatSeparator),p=typeof m=="string"&&!c&&w(m,E).includes(E.arrayFormatSeparator);m=p?w(m,E):m;const F=c||p?m.split(E.arrayFormatSeparator).map(z=>w(z,E)):m===null?m:w(m,E);v[g]=F};case"bracket-separator":return(g,m,v)=>{const c=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!c){v[g]=m&&w(m,E);return}const p=m===null?[]:m.split(E.arrayFormatSeparator).map(F=>w(F,E));if(v[g]===void 0){v[g]=p;return}v[g]=[].concat(v[g],p)};default:return(g,m,v)=>{if(v[g]===void 0){v[g]=m;return}v[g]=[].concat(v[g],m)}}}function f(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(E,O){return O.encode?O.strict?e(E):encodeURIComponent(E):E}function w(E,O){return O.decode?r(E):E}function y(E){return Array.isArray(E)?E.sort():typeof E=="object"?y(Object.keys(E)).sort((O,g)=>Number(O)-Number(g)).map(O=>E[O]):E}function b(E){const O=E.indexOf("#");return O!==-1&&(E=E.slice(0,O)),E}function D(E){let O="";const g=E.indexOf("#");return g!==-1&&(O=E.slice(g)),O}function R(E){E=b(E);const O=E.indexOf("?");return O===-1?"":E.slice(O+1)}function L(E,O){return O.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):O.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function U(E,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),f(O.arrayFormatSeparator);const g=h(O),m=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return m;for(const v of E.split("&")){if(v==="")continue;let[c,p]=n(O.decode?v.replace(/\+/g," "):v,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?p:w(p,O),g(w(c,O),p,m)}for(const v of Object.keys(m)){const c=m[v];if(typeof c=="object"&&c!==null)for(const p of Object.keys(c))c[p]=L(c[p],O);else m[v]=L(c,O)}return O.sort===!1?m:(O.sort===!0?Object.keys(m).sort():Object.keys(m).sort(O.sort)).reduce((v,c)=>{const p=m[c];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?v[c]=y(p):v[c]=p,v},Object.create(null))}t.extract=R,t.parse=U,t.stringify=(E,O)=>{if(!E)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),f(O.arrayFormatSeparator);const g=p=>O.skipNull&&s(E[p])||O.skipEmptyString&&E[p]==="",m=a(O),v={};for(const p of Object.keys(E))g(p)||(v[p]=E[p]);const c=Object.keys(v);return O.sort!==!1&&c.sort(O.sort),c.map(p=>{const F=E[p];return F===void 0?"":F===null?l(p,O):Array.isArray(F)?F.length===0&&O.arrayFormat==="bracket-separator"?l(p,O)+"[]":F.reduce(m(p),[]).join("&"):l(p,O)+"="+l(F,O)}).filter(p=>p.length>0).join("&")},t.parseUrl=(E,O)=>{O=Object.assign({decode:!0},O);const[g,m]=n(E,"#");return Object.assign({url:g.split("?")[0]||"",query:U(R(E),O)},O&&O.parseFragmentIdentifier&&m?{fragmentIdentifier:w(m,O)}:{})},t.stringifyUrl=(E,O)=>{O=Object.assign({encode:!0,strict:!0,[o]:!0},O);const g=b(E.url).split("?")[0]||"",m=t.extract(E.url),v=t.parse(m,{sort:!1}),c=Object.assign(v,E.query);let p=t.stringify(c,O);p&&(p=`?${p}`);let F=D(E.url);return E.fragmentIdentifier&&(F=`#${O[o]?l(E.fragmentIdentifier,O):E.fragmentIdentifier}`),`${g}${p}${F}`},t.pick=(E,O,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[o]:!1},g);const{url:m,query:v,fragmentIdentifier:c}=t.parseUrl(E,g);return t.stringifyUrl({url:m,query:i(v,O),fragmentIdentifier:c},g)},t.exclude=(E,O,g)=>{const m=Array.isArray(O)?v=>!O.includes(v):(v,c)=>!O(v,c);return t.pick(E,m,g)}})(Cr);const ap={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},Vo="base10",ht="base16",di="base64pad",pi="utf8",Go=0,Zt=1,cp=0,Wo=1,gi=12,_i=32;function up(){const t=ui.generateKeyPair();return{privateKey:ut(t.secretKey,ht),publicKey:ut(t.publicKey,ht)}}function yi(){const t=fr.randomBytes(_i);return ut(t,ht)}function fp(t,e){const r=ui.sharedKey(ft(t,ht),ft(e,ht)),n=new Ad(hn.SHA256,r).expand(_i);return ut(n,ht)}function hp(t){const e=hn.hash(ft(t,ht));return ut(e,ht)}function ln(t){const e=hn.hash(ft(t,pi));return ut(e,ht)}function lp(t){return ft(`${t}`,Vo)}function Pr(t){return Number(ut(t,Vo))}function dp(t){const e=lp(typeof t.type<"u"?t.type:Go);if(Pr(e)===Zt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ft(t.senderPublicKey,ht):void 0,n=typeof t.iv<"u"?ft(t.iv,ht):fr.randomBytes(gi),i=new oi.ChaCha20Poly1305(ft(t.symKey,ht)).seal(n,ft(t.message,pi));return gp({type:e,sealed:i,iv:n,senderPublicKey:r})}function pp(t){const e=new oi.ChaCha20Poly1305(ft(t.symKey,ht)),{sealed:r,iv:n}=vi(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return ut(i,pi)}function gp(t){if(Pr(t.type)===Zt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ut(ri([t.type,t.senderPublicKey,t.iv,t.sealed]),di)}return ut(ri([t.type,t.iv,t.sealed]),di)}function vi(t){const e=ft(t,di),r=e.slice(cp,Wo),n=Wo;if(Pr(r)===Zt){const a=n+_i,h=a+gi,f=e.slice(n,a),l=e.slice(a,h),w=e.slice(h);return{type:r,sealed:w,iv:l,senderPublicKey:f}}const i=n+gi,s=e.slice(n,i),o=e.slice(i);return{type:r,sealed:o,iv:s}}function _p(t,e){const r=vi(t);return Yo({type:Pr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ut(r.senderPublicKey,ht):void 0,receiverPublicKey:e?.receiverPublicKey})}function Yo(t){const e=t?.type||Go;if(e===Zt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function ko(t){return t.type===Zt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var yp=Object.defineProperty,Xo=Object.getOwnPropertySymbols,vp=Object.prototype.hasOwnProperty,bp=Object.prototype.propertyIsEnumerable,Jo=(t,e,r)=>e in t?yp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Zo=(t,e)=>{for(var r in e||(e={}))vp.call(e,r)&&Jo(t,r,e[r]);if(Xo)for(var r of Xo(e))bp.call(e,r)&&Jo(t,r,e[r]);return t};const wp="ReactNative",Fr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},mp="js";function Qo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ep(){return!Mo()&&!!fi()&&navigator.product===wp}function Dp(){return!Qo()&&!!fi()}function Sp(){return Ep()?Fr.reactNative:Qo()?Fr.node:Dp()?Fr.browser:Fr.unknown}function xp(t,e){let r=Cr.parse(t);return r=Zo(Zo({},r),e),t=Cr.stringify(r),t}function Op(){return zo()||{name:"",description:"",url:"",icons:[""]}}function Ip(){const t=jd();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Tp(){var t;const e=Sp();return e===Fr.browser?[e,((t=jo())==null?void 0:t.host)||"unknown"].join(":"):e}function Np(t,e,r){const n=Ip(),i=Tp();return[[t,e].join("-"),[mp,r].join("-"),n,i].join("/")}function Ap({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const o=r.split("?"),a=Np(t,e,n),h={auth:i,ua:a,projectId:s},f=xp(o[1]||"",h);return o[0]+"?"+f}function lt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function ea(t){return Object.fromEntries(t.entries())}function ta(t){return new Map(Object.entries(t))}function At(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function Mt(t){return Z.fromMiliseconds(Date.now())>=Z.toMiliseconds(t)}function Qt(){const t=Z.toMiliseconds(Z.FIVE_MINUTES);let e,r,n;return{resolve:i=>{n&&e&&(clearTimeout(n),e(i))},reject:i=>{n&&r&&(clearTimeout(n),r(i))},done:()=>new Promise((i,s)=>{n=setTimeout(s,t),e=i,r=s})}}function ra(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Lp(t){return ra("topic",t)}function Rp(t){return ra("id",t)}function na(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Ue(t,e){return`${t}${e?`:${e}`:""}`}const Cp="irn";function bi(t){return t?.relay||{protocol:Cp}}function wi(t){const e=ap[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Pp=Object.defineProperty,ia=Object.getOwnPropertySymbols,Fp=Object.prototype.hasOwnProperty,$p=Object.prototype.propertyIsEnumerable,sa=(t,e,r)=>e in t?Pp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Up=(t,e)=>{for(var r in e||(e={}))Fp.call(e,r)&&sa(t,r,e[r]);if(ia)for(var r of ia(e))$p.call(e,r)&&sa(t,r,e[r]);return t};function Mp(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function jp(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Cr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:o.symKey,relay:Mp(o)}}function zp(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function Bp(t){return`${t.protocol}:${t.topic}@${t.version}?`+Cr.stringify(Up({symKey:t.symKey},zp(t.relay)))}function Ot(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function Kp(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Ot(r.accounts)),r.extension&&r.extension.forEach(n=>{e.push(...Ot(n.accounts))})}),e}function Hp(t,e){const r=[];return Object.values(t).forEach(n=>{Ot(n.accounts).includes(e)&&r.push(...n.methods),n.extension&&n.extension.forEach(i=>{Ot(i.accounts).includes(e)&&r.push(...i.methods)})}),r}function qp(t,e){const r=[];return Object.values(t).forEach(n=>{Ot(n.accounts).includes(e)&&r.push(...n.events),n.extension&&n.extension.forEach(i=>{Ot(i.accounts).includes(e)&&r.push(...i.events)})}),r}const Vp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Gp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function q(t,e){const{message:r,code:n}=Gp[t];return{message:e?`${r} ${e}`:r,code:n}}function Ve(t,e){const{message:r,code:n}=Vp[t];return{message:e?`${r} ${e}`:r,code:n}}function $r(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function oa(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function yt(t){return typeof t>"u"}function rt(t,e){return e&&yt(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function aa(t,e){return e&&yt(t)?!0:typeof t=="number"&&!isNaN(t)}function Wp(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return lt(i,n)?(n.forEach(o=>{const{accounts:a,methods:h,events:f,extension:l}=t.namespaces[o],w=Ot(a),y=r[o];(!lt(y.chains,w)||!lt(y.methods,h)||!lt(y.events,f))&&(s=!1),s&&l&&l.forEach(b=>{var D;const{accounts:R,methods:L,events:U}=b,E=Ot(R);(D=y.extension)!=null&&D.find(O=>lt(O.chains,E)&&lt(O.methods,L)&&lt(O.events,U))||(s=!1)})}),s):!1}function mi(t){return rt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Yp(t){if(rt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&mi(r)}}return!1}function kp(t){if(rt(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Xp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Jp(t){return t?.topic}function Zp(t,e){let r=null;return rt(t?.publicKey,!1)||(r=q("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Ei(t,e){let r=null;return yt(t?.extension)||(!$r(t.extension)||!t.extension.length)&&(r=q("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function ca(t){let e=!0;return $r(t)?t.length&&(e=t.every(r=>rt(r,!1))):e=!1,e}function ua(t,e,r){let n=null;return $r(e)?e.forEach(i=>{n||(!mi(i)||!i.includes(t))&&(n=Ve("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ve("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function Qp(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const s=ua(n,i?.chains,`${e} requiredNamespace`),o=Ei(i,e);s?r=s:o?r=o:i.extension&&i.extension.forEach(a=>{if(r)return;const h=ua(n,a.chains,`${e} extension`);h&&(r=h)})}),r}function fa(t,e){let r=null;return $r(t)?t.forEach(n=>{r||Yp(n)||(r=Ve("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Ve("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function eg(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=fa(n?.accounts,`${e} namespace`),s=Ei(n,e);i?r=i:s?r=s:n.extension&&n.extension.forEach(o=>{if(r)return;const a=fa(o.accounts,`${e} extension`);a&&(r=a)})}),r}function ha(t,e){let r=null;return ca(t?.methods)?ca(t?.events)||(r=Ve("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ve("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function la(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=ha(n,`${e}, namespace`),s=Ei(n,e);i?r=i:s?r=s:n.extension&&n.extension.forEach(o=>{if(r)return;const a=ha(o,`${e}, extension`);a&&(r=a)})}),r}function tg(t,e){let r=null;if(t&&oa(t)){const n=la(t,e);n&&(r=n);const i=Qp(t,e);i&&(r=i)}else r=q("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function Di(t,e){let r=null;if(t&&oa(t)){const n=la(t,e);n&&(r=n);const i=eg(t,e);i&&(r=i)}else r=q("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function da(t){return rt(t.protocol,!0)}function rg(t,e){let r=!1;return e&&!t?r=!0:t&&$r(t)&&t.length&&t.forEach(n=>{r=da(n)}),r}function ng(t){return typeof t=="number"}function dt(t){return typeof t<"u"&&typeof t!==null}function ig(t){return!(!t||typeof t!="object"||!t.code||!aa(t.code,!1)||!t.message||!rt(t.message,!1))}function sg(t){return!(yt(t)||!rt(t.method,!1))}function og(t){return!(yt(t)||yt(t.result)&&yt(t.error)||!aa(t.id,!1)||!rt(t.jsonrpc,!1))}function ag(t){return!(yt(t)||!rt(t.name,!1))}function pa(t,e){return!(!mi(e)||!Kp(t).includes(e))}function cg(t,e,r){return rt(r,!1)?Hp(t,e).includes(r):!1}function ug(t,e,r){return rt(r,!1)?qp(t,e).includes(r):!1}function ga(t,e,r){let n=null;const i=Object.keys(t),s=Object.keys(e);return lt(i,s)?i.forEach(o=>{var a;if(n)return;const h=t[o].chains,f=Ot(e[o].accounts);lt(h,f)?lt(t[o].methods,e[o].methods)?lt(t[o].events,e[o].events)?t[o].extension&&!e[o].extension?n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${o}`):t[o].extension&&e[o].extension&&((a=t[o].extension)==null||a.forEach(({methods:l,events:w,chains:y})=>{var b;n||(b=e[o].extension)!=null&&b.find(D=>{const R=Ot(D.accounts);return lt(y,R)&&lt(w,D.events)&&lt(l,D.methods)})||(n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${o}`))})):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${o}`):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${o}`):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${o}`)}):n=q("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),n}var _a=ps();const fg="PARSE_ERROR",hg="INVALID_REQUEST",lg="METHOD_NOT_FOUND",dg="INVALID_PARAMS",ya="INTERNAL_ERROR",Si="SERVER_ERROR",pg=[-32700,-32600,-32601,-32602,-32603],Ur={[fg]:{code:-32700,message:"Parse error"},[hg]:{code:-32600,message:"Invalid Request"},[lg]:{code:-32601,message:"Method not found"},[dg]:{code:-32602,message:"Invalid params"},[ya]:{code:-32603,message:"Internal error"},[Si]:{code:-32e3,message:"Server error"}},va=Si;function gg(t){return pg.includes(t)}function ba(t){return Object.keys(Ur).includes(t)?Ur[t]:Ur[va]}function _g(t){const e=Object.values(Ur).find(r=>r.code===t);return e||Ur[va]}function yg(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var wa={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xi=function(t,e){return xi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},xi(t,e)};function vg(t,e){xi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Oi=function(){return Oi=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Oi.apply(this,arguments)};function bg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function wg(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function mg(t,e){return function(r,n){e(r,n,t)}}function Eg(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Dg(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(a,h)}f((n=n.apply(t,e||[])).next())})}function Sg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function xg(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Og(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ii(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ma(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Ig(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ma(arguments[e]));return t}function Tg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Mr(t){return this instanceof Mr?(this.v=t,this):new Mr(t)}function Ng(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(b){return new Promise(function(D,R){s.push([y,b,D,R])>1||a(y,b)})})}function a(y,b){try{h(n[y](b))}catch(D){w(s[0][3],D)}}function h(y){y.value instanceof Mr?Promise.resolve(y.value.v).then(f,l):w(s[0][2],y)}function f(y){a("next",y)}function l(y){a("throw",y)}function w(y,b){y(b),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Ag(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Mr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Lg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ii=="function"?Ii(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,h){o=t[s](o),i(a,h,o.done,o.value)})}}function i(s,o,a,h){Promise.resolve(h).then(function(f){s({value:f,done:a})},o)}}function Rg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Cg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Pg(t){return t&&t.__esModule?t:{default:t}}function Fg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function $g(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ug=Object.freeze({__proto__:null,__extends:vg,get __assign(){return Oi},__rest:bg,__decorate:wg,__param:mg,__metadata:Eg,__awaiter:Dg,__generator:Sg,__createBinding:xg,__exportStar:Og,__values:Ii,__read:ma,__spread:Ig,__spreadArrays:Tg,__await:Mr,__asyncGenerator:Ng,__asyncDelegator:Ag,__asyncValues:Lg,__makeTemplateObject:Rg,__importStar:Cg,__importDefault:Pg,__classPrivateFieldGet:Fg,__classPrivateFieldSet:$g}),Mg=Vt(Ug),Lt={},Ea;function jg(){if(Ea)return Lt;Ea=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.isBrowserCryptoAvailable=Lt.getSubtleCrypto=Lt.getBrowerCrypto=void 0;function t(){return et?.crypto||et?.msCrypto||{}}Lt.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Lt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Lt.isBrowserCryptoAvailable=r,Lt}var Rt={},Da;function zg(){if(Da)return Rt;Da=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.isBrowser=Rt.isNode=Rt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Rt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Rt.isNode=e;function r(){return!t()&&!e()}return Rt.isBrowser=r,Rt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Mg;e.__exportStar(jg(),t),e.__exportStar(zg(),t)})(wa);function Bg(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function dn(t,e,r){return{id:r||Bg(),jsonrpc:"2.0",method:t,params:e}}function Ti(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Ni(t,e,r){return{id:t,jsonrpc:"2.0",error:Kg(e,r)}}function Kg(t,e){return typeof t>"u"?ba(ya):(typeof t=="string"&&(t=Object.assign(Object.assign({},ba(Si)),{message:t})),typeof e<"u"&&(t.data=e),gg(t.code)&&(t=_g(t.code)),t)}class Hg{}class qg extends Hg{constructor(){super()}}class Vg extends qg{constructor(e){super()}}const Gg="^wss?:";function Wg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Yg(t,e){const r=Wg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Sa(t){return Yg(t,Gg)}function kg(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function xa(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Ai(t){return xa(t)&&"method"in t}function Li(t){return xa(t)&&(Ct(t)||mt(t))}function Ct(t){return"result"in t}function mt(t){return"error"in t}class Xg extends Vg{constructor(e){super(e),this.events=new _a.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(dn(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{mt(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Li(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const Oa=10,Jg=(()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"))();class Zg{constructor(e){if(this.url=e,this.events=new _a.EventEmitter,this.registering=!1,!Sa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Xn(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Sa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=wa.isReactNative()?void 0:{rejectUnauthorized:!kg(e)},s=new Jg(e,[],i);s.onopen=()=>{this.onOpen(s),r(s)},s.onerror=o=>{const a=o,h=this.parseError(a.error||new Error(`WebSocket connection failed for URL: ${e}`));this.events.emit("register_error",h),this.onClose(),n(h)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),e.onerror=r=>{const n=r,i=this.parseError(n.error||new Error(`WebSocket connection failed for URL: ${this.url}`));this.events.emit("error",i)},this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Ys(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Ni(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return yg(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Oa&&this.events.setMaxListeners(Oa)}}var Ri={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",w="[object Date]",y="[object Error]",b="[object Function]",D="[object GeneratorFunction]",R="[object Map]",L="[object Number]",U="[object Null]",E="[object Object]",O="[object Promise]",g="[object Proxy]",m="[object RegExp]",v="[object Set]",c="[object String]",p="[object Symbol]",F="[object Undefined]",z="[object WeakMap]",k="[object ArrayBuffer]",X="[object DataView]",J="[object Float32Array]",A="[object Float64Array]",N="[object Int8Array]",W="[object Int16Array]",j="[object Int32Array]",P="[object Uint8Array]",$="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[A]=Y[N]=Y[W]=Y[j]=Y[P]=Y[$]=Y[M]=Y[B]=!0,Y[a]=Y[h]=Y[k]=Y[l]=Y[X]=Y[w]=Y[y]=Y[b]=Y[R]=Y[L]=Y[E]=Y[m]=Y[v]=Y[c]=Y[z]=!1;var ae=typeof et=="object"&&et&&et.Object===Object&&et,T=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||T||Function("return this")(),S=e&&!e.nodeType&&e,u=S&&!0&&t&&!t.nodeType&&t,_=u&&u.exports===S,H=_&&ae.process,V=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),he=V&&V.isTypedArray;function ye(d,x){for(var C=-1,G=d==null?0:d.length,Ne=0,ie=[];++C<G;){var $e=d[C];x($e,C,d)&&(ie[Ne++]=$e)}return ie}function de(d,x){for(var C=-1,G=x.length,Ne=d.length;++C<G;)d[Ne+C]=x[C];return d}function we(d,x){for(var C=-1,G=d==null?0:d.length;++C<G;)if(x(d[C],C,d))return!0;return!1}function Me(d,x){for(var C=-1,G=Array(d);++C<d;)G[C]=x(C);return G}function Ce(d){return function(x){return d(x)}}function _e(d,x){return d.has(x)}function pe(d,x){return d?.[x]}function le(d){var x=-1,C=Array(d.size);return d.forEach(function(G,Ne){C[++x]=[Ne,G]}),C}function ue(d,x){return function(C){return d(x(C))}}function ce(d){var x=-1,C=Array(d.size);return d.forEach(function(G){C[++x]=G}),C}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,fe=I["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,ve=function(){var d=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),be=ee.toString,Ee=RegExp("^"+ge.call(re).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=_?I.Buffer:void 0,me=I.Symbol,Et=I.Uint8Array,Tt=ee.propertyIsEnumerable,Bt=oe.splice,gt=me?me.toStringTag:void 0,er=Object.getOwnPropertySymbols,Hr=De?De.isBuffer:void 0,mn=ue(Object.keys,Object),je=gr(I,"DataView"),Pe=gr(I,"Map"),ze=gr(I,"Promise"),Be=gr(I,"Set"),Ke=gr(I,"WeakMap"),Fe=gr(Object,"create"),Ge=rr(je),We=rr(Pe),Ye=rr(ze),ke=rr(Be),Xe=rr(Ke),qe=me?me.prototype:void 0,He=qe?qe.valueOf:void 0;function Ae(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function Je(){this.__data__=Fe?Fe(null):{},this.size=0}function Ze(d){var x=this.has(d)&&delete this.__data__[d];return this.size-=x?1:0,x}function Vy(d){var x=this.__data__;if(Fe){var C=x[d];return C===n?void 0:C}return re.call(x,d)?x[d]:void 0}function Gy(d){var x=this.__data__;return Fe?x[d]!==void 0:re.call(x,d)}function Wy(d,x){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Fe&&x===void 0?n:x,this}Ae.prototype.clear=Je,Ae.prototype.delete=Ze,Ae.prototype.get=Vy,Ae.prototype.has=Gy,Ae.prototype.set=Wy;function Ft(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function Yy(){this.__data__=[],this.size=0}function ky(d){var x=this.__data__,C=Dn(x,d);if(C<0)return!1;var G=x.length-1;return C==G?x.pop():Bt.call(x,C,1),--this.size,!0}function Xy(d){var x=this.__data__,C=Dn(x,d);return C<0?void 0:x[C][1]}function Jy(d){return Dn(this.__data__,d)>-1}function Zy(d,x){var C=this.__data__,G=Dn(C,d);return G<0?(++this.size,C.push([d,x])):C[G][1]=x,this}Ft.prototype.clear=Yy,Ft.prototype.delete=ky,Ft.prototype.get=Xy,Ft.prototype.has=Jy,Ft.prototype.set=Zy;function tr(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function Qy(){this.size=0,this.__data__={hash:new Ae,map:new(Pe||Ft),string:new Ae}}function e1(d){var x=Sn(this,d).delete(d);return this.size-=x?1:0,x}function t1(d){return Sn(this,d).get(d)}function r1(d){return Sn(this,d).has(d)}function n1(d,x){var C=Sn(this,d),G=C.size;return C.set(d,x),this.size+=C.size==G?0:1,this}tr.prototype.clear=Qy,tr.prototype.delete=e1,tr.prototype.get=t1,tr.prototype.has=r1,tr.prototype.set=n1;function En(d){var x=-1,C=d==null?0:d.length;for(this.__data__=new tr;++x<C;)this.add(d[x])}function i1(d){return this.__data__.set(d,n),this}function s1(d){return this.__data__.has(d)}En.prototype.add=En.prototype.push=i1,En.prototype.has=s1;function Kt(d){var x=this.__data__=new Ft(d);this.size=x.size}function o1(){this.__data__=new Ft,this.size=0}function a1(d){var x=this.__data__,C=x.delete(d);return this.size=x.size,C}function c1(d){return this.__data__.get(d)}function u1(d){return this.__data__.has(d)}function f1(d,x){var C=this.__data__;if(C instanceof Ft){var G=C.__data__;if(!Pe||G.length<r-1)return G.push([d,x]),this.size=++C.size,this;C=this.__data__=new tr(G)}return C.set(d,x),this.size=C.size,this}Kt.prototype.clear=o1,Kt.prototype.delete=a1,Kt.prototype.get=c1,Kt.prototype.has=u1,Kt.prototype.set=f1;function h1(d,x){var C=xn(d),G=!C&&O1(d),Ne=!C&&!G&&qi(d),ie=!C&&!G&&!Ne&&Tc(d),$e=C||G||Ne||ie,Qe=$e?Me(d.length,String):[],it=Qe.length;for(var Re in d)(x||re.call(d,Re))&&!($e&&(Re=="length"||Ne&&(Re=="offset"||Re=="parent")||ie&&(Re=="buffer"||Re=="byteLength"||Re=="byteOffset")||m1(Re,it)))&&Qe.push(Re);return Qe}function Dn(d,x){for(var C=d.length;C--;)if(Sc(d[C][0],x))return C;return-1}function l1(d,x,C){var G=x(d);return xn(d)?G:de(G,C(d))}function qr(d){return d==null?d===void 0?F:U:gt&&gt in Object(d)?b1(d):x1(d)}function wc(d){return Vr(d)&&qr(d)==a}function mc(d,x,C,G,Ne){return d===x?!0:d==null||x==null||!Vr(d)&&!Vr(x)?d!==d&&x!==x:d1(d,x,C,G,mc,Ne)}function d1(d,x,C,G,Ne,ie){var $e=xn(d),Qe=xn(x),it=$e?h:Ht(d),Re=Qe?h:Ht(x);it=it==a?E:it,Re=Re==a?E:Re;var _t=it==E,Dt=Re==E,ot=it==Re;if(ot&&qi(d)){if(!qi(x))return!1;$e=!0,_t=!1}if(ot&&!_t)return ie||(ie=new Kt),$e||Tc(d)?Ec(d,x,C,G,Ne,ie):y1(d,x,it,C,G,Ne,ie);if(!(C&i)){var bt=_t&&re.call(d,"__wrapped__"),wt=Dt&&re.call(x,"__wrapped__");if(bt||wt){var qt=bt?d.value():d,$t=wt?x.value():x;return ie||(ie=new Kt),Ne(qt,$t,C,G,ie)}}return ot?(ie||(ie=new Kt),v1(d,x,C,G,Ne,ie)):!1}function p1(d){if(!Ic(d)||D1(d))return!1;var x=xc(d)?Ee:K;return x.test(rr(d))}function g1(d){return Vr(d)&&Oc(d.length)&&!!Y[qr(d)]}function _1(d){if(!S1(d))return mn(d);var x=[];for(var C in Object(d))re.call(d,C)&&C!="constructor"&&x.push(C);return x}function Ec(d,x,C,G,Ne,ie){var $e=C&i,Qe=d.length,it=x.length;if(Qe!=it&&!($e&&it>Qe))return!1;var Re=ie.get(d);if(Re&&ie.get(x))return Re==x;var _t=-1,Dt=!0,ot=C&s?new En:void 0;for(ie.set(d,x),ie.set(x,d);++_t<Qe;){var bt=d[_t],wt=x[_t];if(G)var qt=$e?G(wt,bt,_t,x,d,ie):G(bt,wt,_t,d,x,ie);if(qt!==void 0){if(qt)continue;Dt=!1;break}if(ot){if(!we(x,function($t,nr){if(!_e(ot,nr)&&(bt===$t||Ne(bt,$t,C,G,ie)))return ot.push(nr)})){Dt=!1;break}}else if(!(bt===wt||Ne(bt,wt,C,G,ie))){Dt=!1;break}}return ie.delete(d),ie.delete(x),Dt}function y1(d,x,C,G,Ne,ie,$e){switch(C){case X:if(d.byteLength!=x.byteLength||d.byteOffset!=x.byteOffset)return!1;d=d.buffer,x=x.buffer;case k:return!(d.byteLength!=x.byteLength||!ie(new Et(d),new Et(x)));case l:case w:case L:return Sc(+d,+x);case y:return d.name==x.name&&d.message==x.message;case m:case c:return d==x+"";case R:var Qe=le;case v:var it=G&i;if(Qe||(Qe=ce),d.size!=x.size&&!it)return!1;var Re=$e.get(d);if(Re)return Re==x;G|=s,$e.set(d,x);var _t=Ec(Qe(d),Qe(x),G,Ne,ie,$e);return $e.delete(d),_t;case p:if(He)return He.call(d)==He.call(x)}return!1}function v1(d,x,C,G,Ne,ie){var $e=C&i,Qe=Dc(d),it=Qe.length,Re=Dc(x),_t=Re.length;if(it!=_t&&!$e)return!1;for(var Dt=it;Dt--;){var ot=Qe[Dt];if(!($e?ot in x:re.call(x,ot)))return!1}var bt=ie.get(d);if(bt&&ie.get(x))return bt==x;var wt=!0;ie.set(d,x),ie.set(x,d);for(var qt=$e;++Dt<it;){ot=Qe[Dt];var $t=d[ot],nr=x[ot];if(G)var Nc=$e?G(nr,$t,ot,x,d,ie):G($t,nr,ot,d,x,ie);if(!(Nc===void 0?$t===nr||Ne($t,nr,C,G,ie):Nc)){wt=!1;break}qt||(qt=ot=="constructor")}if(wt&&!qt){var On=d.constructor,In=x.constructor;On!=In&&"constructor"in d&&"constructor"in x&&!(typeof On=="function"&&On instanceof On&&typeof In=="function"&&In instanceof In)&&(wt=!1)}return ie.delete(d),ie.delete(x),wt}function Dc(d){return l1(d,N1,w1)}function Sn(d,x){var C=d.__data__;return E1(x)?C[typeof x=="string"?"string":"hash"]:C.map}function gr(d,x){var C=pe(d,x);return p1(C)?C:void 0}function b1(d){var x=re.call(d,gt),C=d[gt];try{d[gt]=void 0;var G=!0}catch{}var Ne=be.call(d);return G&&(x?d[gt]=C:delete d[gt]),Ne}var w1=er?function(d){return d==null?[]:(d=Object(d),ye(er(d),function(x){return Tt.call(d,x)}))}:A1,Ht=qr;(je&&Ht(new je(new ArrayBuffer(1)))!=X||Pe&&Ht(new Pe)!=R||ze&&Ht(ze.resolve())!=O||Be&&Ht(new Be)!=v||Ke&&Ht(new Ke)!=z)&&(Ht=function(d){var x=qr(d),C=x==E?d.constructor:void 0,G=C?rr(C):"";if(G)switch(G){case Ge:return X;case We:return R;case Ye:return O;case ke:return v;case Xe:return z}return x});function m1(d,x){return x=x??o,!!x&&(typeof d=="number"||Q.test(d))&&d>-1&&d%1==0&&d<x}function E1(d){var x=typeof d;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?d!=="__proto__":d===null}function D1(d){return!!ve&&ve in d}function S1(d){var x=d&&d.constructor,C=typeof x=="function"&&x.prototype||ee;return d===C}function x1(d){return be.call(d)}function rr(d){if(d!=null){try{return ge.call(d)}catch{}try{return d+""}catch{}}return""}function Sc(d,x){return d===x||d!==d&&x!==x}var O1=wc(function(){return arguments}())?wc:function(d){return Vr(d)&&re.call(d,"callee")&&!Tt.call(d,"callee")},xn=Array.isArray;function I1(d){return d!=null&&Oc(d.length)&&!xc(d)}var qi=Hr||L1;function T1(d,x){return mc(d,x)}function xc(d){if(!Ic(d))return!1;var x=qr(d);return x==b||x==D||x==f||x==g}function Oc(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=o}function Ic(d){var x=typeof d;return d!=null&&(x=="object"||x=="function")}function Vr(d){return d!=null&&typeof d=="object"}var Tc=he?Ce(he):g1;function N1(d){return I1(d)?h1(d):_1(d)}function A1(){return[]}function L1(){return!1}t.exports=T1})(Ri,Ri.exports);var Qg=Ri.exports,e0=Object.defineProperty,Ia=Object.getOwnPropertySymbols,t0=Object.prototype.hasOwnProperty,r0=Object.prototype.propertyIsEnumerable,Ta=(t,e,r)=>e in t?e0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ct=(t,e)=>{for(var r in e||(e={}))t0.call(e,r)&&Ta(t,r,e[r]);if(Ia)for(var r of Ia(e))r0.call(e,r)&&Ta(t,r,e[r]);return t};function n0(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,h=t.charAt(0),f=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function w(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var R=0,L=0,U=0,E=D.length;U!==E&&D[U]===0;)U++,R++;for(var O=(E-U)*l+1>>>0,g=new Uint8Array(O);U!==E;){for(var m=D[U],v=0,c=O-1;(m!==0||v<L)&&c!==-1;c--,v++)m+=256*g[c]>>>0,g[c]=m%a>>>0,m=m/a>>>0;if(m!==0)throw new Error("Non-zero carry");L=v,U++}for(var p=O-L;p!==O&&g[p]===0;)p++;for(var F=h.repeat(R);p<O;++p)F+=t.charAt(g[p]);return F}function y(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var R=0;if(D[R]!==" "){for(var L=0,U=0;D[R]===h;)L++,R++;for(var E=(D.length-R)*f+1>>>0,O=new Uint8Array(E);D[R];){var g=r[D.charCodeAt(R)];if(g===255)return;for(var m=0,v=E-1;(g!==0||m<U)&&v!==-1;v--,m++)g+=a*O[v]>>>0,O[v]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");U=m,R++}if(D[R]!==" "){for(var c=E-U;c!==E&&O[c]===0;)c++;for(var p=new Uint8Array(L+(E-c)),F=L;c!==E;)p[F++]=O[c++];return p}}}function b(D){var R=y(D);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:y,decode:b}}var i0=n0,s0=i0;const Na=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},o0=t=>new TextEncoder().encode(t),a0=t=>new TextDecoder().decode(t);class c0{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class u0{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Aa(this,e)}}class f0{constructor(e){this.decoders=e}or(e){return Aa(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Aa=(t,e)=>new f0(ct(ct({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class h0{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new c0(e,r,n),this.decoder=new u0(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pn=({name:t,prefix:e,encode:r,decode:n})=>new h0(t,e,r,n),jr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=s0(r,e);return pn({prefix:t,name:e,encode:n,decode:s=>Na(i(s))})},l0=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,h=0,f=0;for(let l=0;l<s;++l){const w=i[t[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|w,a+=r,a>=8&&(a-=8,o[f++]=255&h>>a)}if(a>=r||255&h<<8-a)throw new SyntaxError("Unexpected end of data");return o},d0=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let h=0;h<t.length;++h)for(a=a<<8|t[h],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},nt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>pn({prefix:e,name:t,encode(i){return d0(i,n,r)},decode(i){return l0(i,n,r,t)}}),p0=pn({prefix:"\0",name:"identity",encode:t=>a0(t),decode:t=>o0(t)});var g0=Object.freeze({__proto__:null,identity:p0});const _0=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var y0=Object.freeze({__proto__:null,base2:_0});const v0=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var b0=Object.freeze({__proto__:null,base8:v0});const w0=jr({prefix:"9",name:"base10",alphabet:"0123456789"});var m0=Object.freeze({__proto__:null,base10:w0});const E0=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),D0=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var S0=Object.freeze({__proto__:null,base16:E0,base16upper:D0});const x0=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),O0=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),I0=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),T0=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),N0=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),A0=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),L0=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),R0=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),C0=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var P0=Object.freeze({__proto__:null,base32:x0,base32upper:O0,base32pad:I0,base32padupper:T0,base32hex:N0,base32hexupper:A0,base32hexpad:L0,base32hexpadupper:R0,base32z:C0});const F0=jr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$0=jr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var U0=Object.freeze({__proto__:null,base36:F0,base36upper:$0});const M0=jr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),j0=jr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var z0=Object.freeze({__proto__:null,base58btc:M0,base58flickr:j0});const B0=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),K0=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),H0=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),q0=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var V0=Object.freeze({__proto__:null,base64:B0,base64pad:K0,base64url:H0,base64urlpad:q0});const La=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),G0=La.reduce((t,e,r)=>(t[r]=e,t),[]),W0=La.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Y0(t){return t.reduce((e,r)=>(e+=G0[r],e),"")}function k0(t){const e=[];for(const r of t){const n=W0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const X0=pn({prefix:"\u{1F680}",name:"base256emoji",encode:Y0,decode:k0});var J0=Object.freeze({__proto__:null,base256emoji:X0}),Z0=Ca,Ra=128,Q0=127,e_=~Q0,t_=Math.pow(2,31);function Ca(t,e,r){e=e||[],r=r||0;for(var n=r;t>=t_;)e[r++]=t&255|Ra,t/=128;for(;t&e_;)e[r++]=t&255|Ra,t>>>=7;return e[r]=t|0,Ca.bytes=r-n+1,e}var r_=Ci,n_=128,Pa=127;function Ci(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw Ci.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Pa)<<i:(o&Pa)*Math.pow(2,i),i+=7}while(o>=n_);return Ci.bytes=s-n,r}var i_=Math.pow(2,7),s_=Math.pow(2,14),o_=Math.pow(2,21),a_=Math.pow(2,28),c_=Math.pow(2,35),u_=Math.pow(2,42),f_=Math.pow(2,49),h_=Math.pow(2,56),l_=Math.pow(2,63),d_=function(t){return t<i_?1:t<s_?2:t<o_?3:t<a_?4:t<c_?5:t<u_?6:t<f_?7:t<h_?8:t<l_?9:10},p_={encode:Z0,decode:r_,encodingLength:d_},Fa=p_;const $a=(t,e,r=0)=>(Fa.encode(t,e,r),e),Ua=t=>Fa.encodingLength(t),Pi=(t,e)=>{const r=e.byteLength,n=Ua(t),i=n+Ua(r),s=new Uint8Array(i+r);return $a(t,s,0),$a(r,s,n),s.set(e,i),new g_(t,r,e,s)};class g_{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Ma=({name:t,code:e,encode:r})=>new __(t,e,r);class __{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Pi(this.code,r):r.then(n=>Pi(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ja=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),y_=Ma({name:"sha2-256",code:18,encode:ja("SHA-256")}),v_=Ma({name:"sha2-512",code:19,encode:ja("SHA-512")});var b_=Object.freeze({__proto__:null,sha256:y_,sha512:v_});const za=0,w_="identity",Ba=Na;var m_=Object.freeze({__proto__:null,identity:{code:za,name:w_,encode:Ba,digest:t=>Pi(za,Ba(t))}});new TextEncoder,new TextDecoder;const Ka=ct(ct(ct(ct(ct(ct(ct(ct(ct(ct({},g0),y0),b0),m0),S0),P0),U0),z0),V0),J0);ct(ct({},b_),m_);function E_(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ha(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const qa=Ha("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Fi=Ha("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=E_(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),D_=ct({utf8:qa,"utf-8":qa,hex:Ka.base16,latin1:Fi,ascii:Fi,binary:Fi},Ka);function S_(t,e="utf8"){const r=D_[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Va="wc",x_=2,$i="core",jt=`${Va}@${2}:${$i}:`,O_={name:$i,logger:"error"},I_={database:":memory:"},T_="crypto",Ga="client_ed25519_seed",N_=Z.ONE_DAY,A_="keychain",L_="0.3",R_="messages",C_="0.3",P_=Z.SIX_HOURS,F_="publisher",Wa="irn",$_="error",U_="wss://relay.walletconnect.com",M_="relayer",lr={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error"},j_="_subscription",dr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},z_=Z.ONE_SECOND,B_="2.1.3",K_="0.3",Pt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},H_="subscription",q_="0.3",V_=Z.FIVE_SECONDS*1e3,G_="pairing",W_="0.3",zr={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},It={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Y_="history",k_="0.3",X_="expirer",vt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},J_="0.3";class Z_{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=A_,this.version=L_,this.initialized=!1,this.storagePrefix=jt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=q("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ea(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ta(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Q_{constructor(e,r,n){this.core=e,this.logger=r,this.name=T_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Oo(i);return xo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=up();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Oo(s),a=yi();return await yd(a,i,N_,o)},this.generateSharedKey=(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),h=fp(a,s);return this.setSymKey(h,o)},this.setSymKey=async(i,s)=>{this.isInitialized();const o=s||hp(i);return await this.keychain.set(o,i),o},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,o)=>{this.isInitialized();const a=Yo(o),h=Xn(s);if(ko(a)){const y=a.senderPublicKey,b=a.receiverPublicKey;i=await this.generateSharedKey(y,b)}const f=this.getSymKey(i),{type:l,senderPublicKey:w}=a;return dp({type:l,symKey:f,message:h,senderPublicKey:w})},this.decode=async(i,s,o)=>{this.isInitialized();const a=_p(s,o);if(ko(a)){const l=a.receiverPublicKey,w=a.senderPublicKey;i=await this.generateSharedKey(l,w)}const h=this.getSymKey(i),f=pp({symKey:h,encoded:s});return Ys(f)},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.keychain=n||new Z_(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}getPayloadType(e){const r=vi(e);return Pr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ga)}catch{e=yi(),await this.keychain.set(Ga,e)}return S_(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ey extends eh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=R_,this.version=C_,this.initialized=!1,this.storagePrefix=jt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=ln(i);let o=this.messages.get(n);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=i,this.messages.set(n,o),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),o=ln(i);return typeof s[o]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=xe.generateChildLogger(e,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ea(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ta(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ty extends th{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Nt.exports.EventEmitter,this.name=F_,this.queue=new Map,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const o=s?.ttl||P_,a=bi(s),h=s?.prompt||!1,f=s?.tag||0,l={topic:n,message:i,opts:{ttl:o,relay:a,prompt:h,tag:f}},w=ln(i);this.queue.set(w,l),await this.rpcPublish(n,i,o,a,h,f),this.onPublish(w,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,o){var a,h,f,l;const w={method:wi(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:o}};return yt((a=w.params)==null?void 0:a.prompt)&&((h=w.params)==null||delete h.prompt),yt((f=w.params)==null?void 0:f.tag)&&((l=w.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.provider.request(w)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:{ttl:i,relay:s,prompt:o,tag:a}}=e,h=ln(n);await this.rpcPublish(r,n,i,s,o,a),this.onPublish(h,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Dr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class ry{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var ny=Object.defineProperty,iy=Object.defineProperties,sy=Object.getOwnPropertyDescriptors,Ya=Object.getOwnPropertySymbols,oy=Object.prototype.hasOwnProperty,ay=Object.prototype.propertyIsEnumerable,ka=(t,e,r)=>e in t?ny(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,gn=(t,e)=>{for(var r in e||(e={}))oy.call(e,r)&&ka(t,r,e[r]);if(Ya)for(var r of Ya(e))ay.call(e,r)&&ka(t,r,e[r]);return t},Ui=(t,e)=>iy(t,sy(e));class cy extends ih{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new ry,this.events=new Nt.exports.EventEmitter,this.name=H_,this.version=q_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=jt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=bi(i),o={topic:n,relay:s};this.pending.set(n,o);const a=await this.rpcSubscribe(n,s);return this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const o=new Z.Watch;o.start(this.pendingSubscriptionWatchLabel);const a=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),i(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=V_&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=bi(n);await this.rpcUnsubscribe(e,r,i);const s=Ve("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:wi(r.protocol).subscribe,params:{topic:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),await this.relayer.provider.request(n)}rpcUnsubscribe(e,r,n){const i={method:wi(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,r){this.setSubscription(e,Ui(gn({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Ui(gn({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,gn({},r)),this.topicMap.set(r.topic,e),this.events.emit(Pt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Pt.deleted,Ui(gn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Pt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Pt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:n}=e,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Dr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.provider.on(dr.connect,async()=>{await this.onConnect()}),this.relayer.provider.on(dr.disconnect,()=>{this.onDisconnect()}),this.events.on(Pt.created,async e=>{const r=Pt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Pt.deleted,async e=>{const r=Pt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var uy=Object.defineProperty,Xa=Object.getOwnPropertySymbols,fy=Object.prototype.hasOwnProperty,hy=Object.prototype.propertyIsEnumerable,Ja=(t,e,r)=>e in t?uy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ly=(t,e)=>{for(var r in e||(e={}))fy.call(e,r)&&Ja(t,r,e[r]);if(Xa)for(var r of Xa(e))hy.call(e,r)&&Ja(t,r,e[r]);return t};class dy extends rh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Nt.exports.EventEmitter,this.name=M_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?xe.generateChildLogger(e.logger,this.name):Gr(xe.getDefaultLoggerOptions({level:e.logger||$_})),this.messages=new ey(this.logger,e.core),this.subscriber=new cy(this,this.logger),this.publisher=new ty(this,this.logger),this.relayUrl=e?.relayUrl||U_,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.provider.connect(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){return this.isInitialized(),await this.subscriber.subscribe(e,r)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,await this.provider.disconnect()}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,await this.provider.connect(),await new Promise(r=>{this.subscriber.once(Pt.resubscribed,()=>{r()})})}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Xg(new Zg(Ap({sdkVersion:B_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ai(e)){if(!e.method.endsWith(j_))return;const r=e.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ly({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(lr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Ti(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(dr.payload,e=>this.onProviderPayload(e)),this.provider.on(dr.connect,()=>{this.events.emit(lr.connect)}),this.provider.on(dr.disconnect,()=>{this.events.emit(lr.disconnect),this.attemptToReconnect()}),this.provider.on(dr.error,e=>this.events.emit(lr.error,e))}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(()=>{this.provider.connect()},Z.toMiliseconds(z_))}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var py=Object.defineProperty,Za=Object.getOwnPropertySymbols,gy=Object.prototype.hasOwnProperty,_y=Object.prototype.propertyIsEnumerable,Qa=(t,e,r)=>e in t?py(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ec=(t,e)=>{for(var r in e||(e={}))gy.call(e,r)&&Qa(t,r,e[r]);if(Za)for(var r of Za(e))_y.call(e,r)&&Qa(t,r,e[r]);return t};class Mi extends nh{constructor(e,r,n,i=jt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=K_,this.cached=[],this.initialized=!1,this.storagePrefix=jt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{Xp(o)?this.map.set(o.id,o):Jp(o)?this.map.set(o.topic,o):this.getKey&&o!==null&&!yt(o)&&this.map.set(this.getKey(o),o)}),this.cached=[],this.initialized=!0)},this.set=async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(h=>Qg(a[h],o[h]))):this.values),this.update=async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const h=ec(ec({},this.getData(o)),a);this.map.set(o,h),await this.persist()},this.delete=async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yy{constructor(e,r){this.core=e,this.logger=r,this.name=G_,this.version=W_,this.events=new Nt.exports,this.initialized=!1,this.storagePrefix=jt,this.ignoredPayloadTypes=[Zt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=yi(),i=await this.core.crypto.setSymKey(n),s=At(Z.FIVE_MINUTES),o={protocol:Wa},a={topic:i,expiry:s,relay:o,active:!1},h=Bp({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:o});return await this.pairings.set(i,a),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:o}=jp(n.uri),a=At(Z.FIVE_MINUTES),h={topic:i,relay:o,expiry:a,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:o}),this.core.expirer.set(i,a),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=At(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:h}=Qt();this.events.once(Ue("pairing_ping",s),({error:f})=>{f?h(f):a()}),await o()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ve("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const o=dn(i,s),a=await this.core.crypto.encode(n,o),h=zr[i].req;return this.core.history.set(n,o),await this.core.relayer.publish(n,a,h),o.id},this.sendResult=async(n,i,s)=>{const o=Ti(n,s),a=await this.core.crypto.encode(i,o),h=await this.core.history.get(i,n),f=zr[h.request.method].res;await this.core.relayer.publish(i,a,f),await this.core.history.resolve(o)},this.sendError=async(n,i,s)=>{const o=Ni(n,s),a=await this.core.crypto.encode(i,o),h=await this.core.history.get(i,n),f=zr[h.request.method]?zr[h.request.method].res:zr.unregistered_method.res;await this.core.relayer.publish(i,a,f),await this.core.history.resolve(o)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ve("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>Mt(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Ct(i)?this.events.emit(Ue("pairing_ping",s),{}):mt(i)&&this.events.emit(Ue("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Ve("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ve("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!dt(n)){const{message:i}=q("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!kp(n.uri)){const{message:i}=q("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!dt(n)){const{message:s}=q("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!dt(n)){const{message:s}=q("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!rt(n,!1)){const{message:i}=q("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(Mt(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=q("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new Mi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(lr.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Ai(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Li(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(vt.expired,async e=>{const{topic:r}=na(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class vy extends Qf{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Nt.exports.EventEmitter,this.name=Y_,this.version=k_,this.cached=[],this.initialized=!1,this.storagePrefix=jt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(It.created,o)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=mt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(It.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(It.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:dn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(It.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(It.created,e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.updated,e=>{const r=It.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.deleted,e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}class by extends sh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Nt.exports.EventEmitter,this.name=X_,this.version=J_,this.cached=[],this.initialized=!1,this.storagePrefix=jt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(vt.created,{target:s,expiration:o})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{this.isInitialized();const i=this.formatTarget(n);if(this.has(i)){const s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(vt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Lp(e);if(typeof e=="number")return Rp(e);const{message:r}=q("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=q("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(vt.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Dr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(vt.created,e=>{const r=vt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(vt.expired,e=>{const r=vt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(vt.deleted,e=>{const r=vt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}}var wy=Object.defineProperty,tc=Object.getOwnPropertySymbols,my=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable,rc=(t,e,r)=>e in t?wy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,nc=(t,e)=>{for(var r in e||(e={}))my.call(e,r)&&rc(t,r,e[r]);if(tc)for(var r of tc(e))Ey.call(e,r)&&rc(t,r,e[r]);return t};class ji extends Zf{constructor(e){super(e),this.protocol=Va,this.version=x_,this.name=$i,this.events=new Nt.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Gr(xe.getDefaultLoggerOptions({level:e?.logger||O_.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new Dr.HeartBeat,this.crypto=new Q_(this,this.logger,e?.keychain),this.history=new vy(this,this.logger),this.expirer=new by(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Du(nc(nc({},I_),e?.storageOptions)),this.relayer=new dy({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new yy(this,this.logger)}static async init(e){const r=new ji(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(e){throw this.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Dy=ji;var _n={exports:{}},pr=typeof Reflect=="object"?Reflect:null,ic=pr&&typeof pr.apply=="function"?pr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},yn;pr&&typeof pr.ownKeys=="function"?yn=pr.ownKeys:Object.getOwnPropertySymbols?yn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:yn=function(e){return Object.getOwnPropertyNames(e)};function Sy(t){console&&console.warn&&console.warn(t)}var sc=Number.isNaN||function(e){return e!==e};function Ie(){Ie.init.call(this)}_n.exports=Ie,_n.exports.once=Ty,Ie.EventEmitter=Ie,Ie.prototype._events=void 0,Ie.prototype._eventsCount=0,Ie.prototype._maxListeners=void 0;var oc=10;function vn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ie,"defaultMaxListeners",{enumerable:!0,get:function(){return oc},set:function(t){if(typeof t!="number"||t<0||sc(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");oc=t}}),Ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ie.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||sc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ac(t){return t._maxListeners===void 0?Ie.defaultMaxListeners:t._maxListeners}Ie.prototype.getMaxListeners=function(){return ac(this)},Ie.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")ic(h,this,r);else for(var f=h.length,l=lc(h,f),n=0;n<f;++n)ic(l[n],this,r);return!0};function cc(t,e,r,n){var i,s,o;if(vn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=ac(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Sy(a)}return t}Ie.prototype.addListener=function(e,r){return cc(this,e,r,!1)},Ie.prototype.on=Ie.prototype.addListener,Ie.prototype.prependListener=function(e,r){return cc(this,e,r,!0)};function xy(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uc(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=xy.bind(n);return i.listener=r,n.wrapFn=i,i}Ie.prototype.once=function(e,r){return vn(r),this.on(e,uc(this,e,r)),this},Ie.prototype.prependOnceListener=function(e,r){return vn(r),this.prependListener(e,uc(this,e,r)),this},Ie.prototype.removeListener=function(e,r){var n,i,s,o,a;if(vn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Oy(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Ie.prototype.off=Ie.prototype.removeListener,Ie.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function fc(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Iy(i):lc(i,i.length)}Ie.prototype.listeners=function(e){return fc(this,e,!0)},Ie.prototype.rawListeners=function(e){return fc(this,e,!1)},Ie.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):hc.call(t,e)},Ie.prototype.listenerCount=hc;function hc(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ie.prototype.eventNames=function(){return this._eventsCount>0?yn(this._events):[]};function lc(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Oy(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Iy(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Ty(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}dc(t,e,s,{once:!0}),e!=="error"&&Ny(t,i,{once:!0})})}function Ny(t,e,r){typeof t.on=="function"&&dc(t,"error",e,r)}function dc(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const zi="wc",Bi=2,Ki="client",Hi=`${zi}@${Bi}:${Ki}:`,bn={name:Ki,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ay={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_event:"session_event",proposal_expire:"proposal_expire"},Ly={database:":memory:"},Ry={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Cy="history",Py="0.3",pc="proposal",Fy=Z.THIRTY_DAYS,gc="session",Br=Z.SEVEN_DAYS,_c="engine",Kr={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}};var $y=Object.defineProperty,Uy=Object.defineProperties,My=Object.getOwnPropertyDescriptors,yc=Object.getOwnPropertySymbols,jy=Object.prototype.hasOwnProperty,zy=Object.prototype.propertyIsEnumerable,vc=(t,e,r)=>e in t?$y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zt=(t,e)=>{for(var r in e||(e={}))jy.call(e,r)&&vc(t,r,e[r]);if(yc)for(var r of yc(e))zy.call(e,r)&&vc(t,r,e[r]);return t},bc=(t,e)=>Uy(t,My(e));class By extends ah{constructor(e){super(e),this.name=_c,this.events=new _n.exports,this.initialized=!1,this.ignoredPayloadTypes=[Zt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Kr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;let o=n,a,h=!1;if(o&&(h=this.client.core.pairing.pairings.get(o).active),!o||!h){const{topic:L,uri:U}=await this.client.core.pairing.create();o=L,a=U}const f=await this.client.core.crypto.generateKeyPair(),l={requiredNamespaces:i,relays:s??[{protocol:Wa}],proposer:{publicKey:f,metadata:this.client.metadata}},{reject:w,resolve:y,done:b}=Qt();if(this.events.once(Ue("session_connect"),async({error:L,session:U})=>{if(L)w(L);else if(U){U.self.publicKey=f;const E=bc(zt({},U),{requiredNamespaces:i});await this.client.session.set(U.topic,E),await this.setExpiry(U.topic,U.expiry),o&&await this.client.core.pairing.updateMetadata({topic:o,metadata:U.peer.metadata}),y(E)}}),!o){const{message:L}=q("NO_MATCHING_KEY",`connect() pairing topic: ${o}`);throw new Error(L)}const D=await this.sendRequest(o,"wc_sessionPropose",l),R=At(Z.FIVE_MINUTES);return await this.setProposal(D,zt({id:D,expiry:R},l)),{uri:a,approval:b}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s}=r,{pairingTopic:o,proposer:a,requiredNamespaces:h}=this.client.proposal.get(n),f=await this.client.core.crypto.generateKeyPair(),l=a.publicKey,w=await this.client.core.crypto.generateSharedKey(f,l),y={relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:h,controller:{publicKey:f,metadata:this.client.metadata},expiry:At(Br)};await this.client.core.relayer.subscribe(w);const b=await this.sendRequest(w,"wc_sessionSettle",y),{done:D,resolve:R,reject:L}=Qt();this.events.once(Ue("session_approve",b),({error:E})=>{E?L(E):R(this.client.session.get(w))});const U=bc(zt({},y),{topic:w,acknowledged:!1,self:y.controller,peer:{publicKey:a.publicKey,metadata:a.metadata},controller:f});return await this.client.session.set(w,U),await this.setExpiry(w,At(Br)),o&&await this.client.core.pairing.updateMetadata({topic:o,metadata:U.peer.metadata}),o&&n&&(await this.sendResult(n,o,{relay:{protocol:i??"irn"},responderPublicKey:f}),await this.client.proposal.delete(n,Ve("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:o})),{topic:w,acknowledged:D}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,Ve("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:o,resolve:a,reject:h}=Qt();return this.events.once(Ue("session_update",s),({error:f})=>{f?h(f):a()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:o,reject:a}=Qt();return this.events.once(Ue("session_extend",i),({error:h})=>{h?a(h):o()}),await this.setExpiry(n,At(Br)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s}=r,o=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n}),{done:a,resolve:h,reject:f}=Qt();return this.events.once(Ue("session_request",o),({error:l,result:w})=>{l?f(l):h(w)}),await a()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;Ct(i)?await this.sendResult(s,n,i.result):mt(i)&&await this.sendError(s,n,i.error)},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:o,reject:a}=Qt();this.events.once(Ue("session_ping",i),({error:h})=>{h?a(h):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ve("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>Wp(n,r))),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ve("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ve("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.sendRequest=async(r,n,i)=>{const s=dn(n,i),o=await this.client.core.crypto.encode(r,s),a=Kr[n].req;return this.client.core.history.set(r,s),this.client.core.relayer.publish(r,o,a),s.id},this.sendResult=async(r,n,i)=>{const s=Ti(r,i),o=await this.client.core.crypto.encode(n,s),a=await this.client.core.history.get(n,r),h=Kr[a.request.method].res;this.client.core.relayer.publish(n,o,h),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=Ni(r,i),o=await this.client.core.crypto.encode(n,s),a=await this.client.core.history.get(n,r),h=Kr[a.request.method].res;this.client.core.relayer.publish(n,o,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{Mt(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{Mt(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(zt({},n.params));const o=At(Z.FIVE_MINUTES),a=zt({id:s,pairingTopic:r,expiry:o},i);await this.setProposal(s,a),this.client.events.emit("session_proposal",{id:s,params:a})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Ct(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const a=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const f=await this.client.core.crypto.generateSharedKey(a,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:f});const l=await this.client.core.relayer.subscribe(f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:r})}else mt(n)&&(await this.client.proposal.delete(i,Ve("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:h,namespaces:f}=n.params,l={topic:r,relay:o,expiry:h,namespaces:f,acknowledged:!0,controller:a.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}};await this.sendResult(n.id,r,!0),this.events.emit(Ue("session_connect"),{session:l})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Ct(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ue("session_approve",i),{})):mt(n)&&(await this.client.session.delete(r,Ve("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(zt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Ct(n)?this.events.emit(Ue("session_update",i),{}):mt(n)&&this.events.emit(Ue("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,At(Br)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Ct(n)?this.events.emit(Ue("session_extend",i),{}):mt(n)&&this.events.emit(Ue("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Ct(n)?this.events.emit(Ue("session_ping",i),{}):mt(n)&&this.events.emit(Ue("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await this.sendResult(i,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(zt({topic:r},s)),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Ct(n)?this.events.emit(Ue("session_request",i),{result:n.result}):mt(n)&&this.events.emit(Ue("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(zt({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!dt(r)){const{message:a}=q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(a)}const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;yt(n)||await this.isValidPairingTopic(n);const o=tg(i,"connect()");if(o)throw new Error(o.message);if(!rg(s,!0)){const{message:a}=q("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(a)}},this.isValidApprove=async r=>{if(!dt(r))throw new Error(q("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s}=r;await this.isValidProposalId(n);const o=this.client.proposal.get(n),a=Di(i,"approve()");if(a)throw new Error(a.message);const h=ga(o.requiredNamespaces,i,"update()");if(h)throw new Error(h.message);if(!rt(s,!0)){const{message:f}=q("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}},this.isValidReject=async r=>{if(!dt(r)){const{message:s}=q("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!ig(i)){const{message:s}=q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!dt(r)){const{message:f}=q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(f)}const{relay:n,controller:i,namespaces:s,expiry:o}=r;if(!da(n)){const{message:f}=q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(f)}const a=Zp(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const h=Di(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(Mt(o)){const{message:f}=q("EXPIRED","onSessionSettleRequest()");throw new Error(f)}},this.isValidUpdate=async r=>{if(!dt(r)){const{message:h}=q("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=Di(i,"update()");if(o)throw new Error(o.message);const a=ga(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)},this.isValidExtend=async r=>{if(!dt(r)){const{message:i}=q("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!dt(r)){const{message:a}=q("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(a)}const{topic:n,request:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!pa(o,s)){const{message:a}=q("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(a)}if(!sg(i)){const{message:a}=q("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(a)}if(!cg(o,s,i.method)){const{message:a}=q("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(a)}},this.isValidRespond=async r=>{if(!dt(r)){const{message:s}=q("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!og(i)){const{message:s}=q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!dt(r)){const{message:i}=q("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!dt(r)){const{message:a}=q("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!pa(o,s)){const{message:a}=q("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!ag(i)){const{message:a}=q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!ug(o,s,i.name)){const{message:a}=q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}},this.isValidDisconnect=async r=>{if(!dt(r)){const{message:i}=q("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}}isInitialized(){if(!this.initialized){const{message:e}=q("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(lr.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);Ai(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Li(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(vt.expired,async e=>{const{topic:r,id:n}=na(e.target);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&await this.deleteProposal(n,!0)})}isValidPairingTopic(e){if(!rt(e,!1)){const{message:r}=q("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Mt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=q("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!rt(e,!1)){const{message:r}=q("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=q("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Mt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=q("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(rt(e,!1)){const{message:r}=q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!ng(e)){const{message:r}=q("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=q("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Mt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=q("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Ky extends Mi{constructor(e,r){super(e,r,pc,Hi),this.core=e,this.logger=r}}class Hy extends Mi{constructor(e,r){super(e,r,gc,Hi),this.core=e,this.logger=r}}class wn extends oh{constructor(e){super(e),this.protocol=zi,this.version=Bi,this.name=bn.name,this.events=new _n.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||bn.name,this.metadata=e?.metadata||Op();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Gr(xe.getDefaultLoggerOptions({level:e?.logger||bn.logger}));this.core=e?.core||new Dy(e),this.logger=xe.generateChildLogger(r,this.name),this.session=new Hy(this.core,this.logger),this.proposal=new Ky(this.core,this.logger),this.engine=new By(this)}static async init(e){const r=new wn(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.engine.init(),this.logger.info("SignClient Initilization Success")}catch(e){throw this.logger.info("SignClient Initilization Failure"),this.logger.error(e.message),e}}}const qy=wn;Le.ENGINE_CONTEXT=_c,Le.ENGINE_RPC_OPTS=Kr,Le.HISTORY_CONTEXT=Cy,Le.HISTORY_EVENTS=Ry,Le.HISTORY_STORAGE_VERSION=Py,Le.PROPOSAL_CONTEXT=pc,Le.PROPOSAL_EXPIRY=Fy,Le.SESSION_CONTEXT=gc,Le.SESSION_EXPIRY=Br,Le.SIGN_CLIENT_CONTEXT=Ki,Le.SIGN_CLIENT_DEFAULT=bn,Le.SIGN_CLIENT_EVENTS=Ay,Le.SIGN_CLIENT_PROTOCOL=zi,Le.SIGN_CLIENT_STORAGE_OPTIONS=Ly,Le.SIGN_CLIENT_STORAGE_PREFIX=Hi,Le.SIGN_CLIENT_VERSION=Bi,Le.SignClient=qy,Le.default=wn,Object.defineProperty(Le,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map

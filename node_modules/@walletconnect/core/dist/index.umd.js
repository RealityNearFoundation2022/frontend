(function(X,Je){typeof exports=="object"&&typeof module<"u"?Je(exports):typeof define=="function"&&define.amd?define(["exports"],Je):(X=typeof globalThis<"u"?globalThis:X||self,Je(X["@walletconnect/core"]={}))})(this,function(X){"use strict";var Je=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lt(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var bt={exports:{}},Ht=typeof Reflect=="object"?Reflect:null,hi=Ht&&typeof Ht.apply=="function"?Ht.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},xr;Ht&&typeof Ht.ownKeys=="function"?xr=Ht.ownKeys:Object.getOwnPropertySymbols?xr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:xr=function(t){return Object.getOwnPropertyNames(t)};function Va(e){console&&console.warn&&console.warn(e)}var li=Number.isNaN||function(t){return t!==t};function Se(){Se.init.call(this)}bt.exports=Se,bt.exports.once=Xa,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var di=10;function Tr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return di},set:function(e){if(typeof e!="number"||e<0||li(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");di=e}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||li(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function _i(e){return e._maxListeners===void 0?Se.defaultMaxListeners:e._maxListeners}Se.prototype.getMaxListeners=function(){return _i(this)},Se.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var u;if(r.length>0&&(u=r[0]),u instanceof Error)throw u;var c=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw c.context=u,c}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")hi(h,this,r);else for(var f=h.length,l=bi(h,f),n=0;n<f;++n)hi(l[n],this,r);return!0};function gi(e,t,r,n){var i,s,u;if(Tr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),u=s[t]),u===void 0)u=s[t]=r,++e._eventsCount;else if(typeof u=="function"?u=s[t]=n?[r,u]:[u,r]:n?u.unshift(r):u.push(r),i=_i(e),i>0&&u.length>i&&!u.warned){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=u.length,Va(c)}return e}Se.prototype.addListener=function(t,r){return gi(this,t,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(t,r){return gi(this,t,r,!0)};function qa(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pi(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=qa.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(t,r){return Tr(r),this.on(t,pi(this,t,r)),this},Se.prototype.prependOnceListener=function(t,r){return Tr(r),this.prependListener(t,pi(this,t,r)),this},Se.prototype.removeListener=function(t,r){var n,i,s,u,c;if(Tr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,u=n.length-1;u>=0;u--)if(n[u]===r||n[u].listener===r){c=n[u].listener,s=u;break}if(s<0)return this;s===0?n.shift():Wa(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),u;for(i=0;i<s.length;++i)u=s[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function yi(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Ya(i):bi(i,i.length)}Se.prototype.listeners=function(t){return yi(this,t,!0)},Se.prototype.rawListeners=function(t){return yi(this,t,!1)},Se.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):vi.call(e,t)},Se.prototype.listenerCount=vi;function vi(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?xr(this._events):[]};function bi(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Wa(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Ya(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Xa(e,t){return new Promise(function(r,n){function i(u){e.removeListener(t,s),n(u)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}Ei(e,t,s,{once:!0}),t!=="error"&&ka(e,i,{once:!0})})}function ka(e,t,r){typeof e.on=="function"&&Ei(e,"error",t,r)}function Ei(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}function Ja(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Za=Qa;function Qa(e,t,r){var n=r&&r.stringify||Ja,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var u=new Array(s);u[0]=n(e);for(var c=1;c<s;c++)u[c]=n(t[c]);return u.join(" ")}if(typeof e!="string")return e;var h=t.length;if(h===0)return e;for(var f="",l=1-i,w=-1,b=e&&e.length||0,v=0;v<b;){if(e.charCodeAt(v)===37&&v+1<b){switch(w=w>-1?w:0,e.charCodeAt(v+1)){case 100:case 102:if(l>=h||t[l]==null)break;w<v&&(f+=e.slice(w,v)),f+=Number(t[l]),w=v+2,v++;break;case 105:if(l>=h||t[l]==null)break;w<v&&(f+=e.slice(w,v)),f+=Math.floor(Number(t[l])),w=v+2,v++;break;case 79:case 111:case 106:if(l>=h||t[l]===void 0)break;w<v&&(f+=e.slice(w,v));var T=typeof t[l];if(T==="string"){f+="'"+t[l]+"'",w=v+2,v++;break}if(T==="function"){f+=t[l].name||"<anonymous>",w=v+2,v++;break}f+=n(t[l]),w=v+2,v++;break;case 115:if(l>=h)break;w<v&&(f+=e.slice(w,v)),f+=String(t[l]),w=v+2,v++;break;case 37:w<v&&(f+=e.slice(w,v)),f+="%",w=v+2,v++,l--;break}++l}++v}return w===-1?e:(w<b&&(f+=e.slice(w)),f)}const wi=Za;var nn=gt;const er=cu().console||{},eu={mapHttpRequest:Ir,mapHttpResponse:Ir,wrapRequestSerializer:on,wrapResponseSerializer:on,wrapErrorSerializer:on,req:Ir,res:Ir,err:su};function tu(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function gt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||er;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=tu(e.browser.serialize,n);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const u=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const c=e.level||"info",h=Object.create(r);h.log||(h.log=tr),Object.defineProperty(h,"levelVal",{get:l}),Object.defineProperty(h,"level",{get:w,set:b});const f={transmit:t,serialize:i,asObject:e.browser.asObject,levels:u,timestamp:ou(e)};h.levels=gt.levels,h.level=c,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=tr,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=v,t&&(h._logEvent=sn());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function b(T){if(T!=="silent"&&!this.levels.values[T])throw Error("unknown level "+T);this._level=T,Kt(f,h,"error","log"),Kt(f,h,"fatal","error"),Kt(f,h,"warn","error"),Kt(f,h,"info","log"),Kt(f,h,"debug","log"),Kt(f,h,"trace","log")}function v(T,U){if(!T)throw new Error("missing bindings for child Pino");U=U||{},i&&T.serializers&&(U.serializers=T.serializers);const P=U.serializers;if(i&&P){var K=Object.assign({},n,P),S=e.browser.serialize===!0?Object.keys(K):i;delete T.serializers,Rr([T],S,K,this._stdErrSerialize)}function R(p){this._childLevel=(p._childLevel|0)+1,this.error=Gt(p,T,"error"),this.fatal=Gt(p,T,"fatal"),this.warn=Gt(p,T,"warn"),this.info=Gt(p,T,"info"),this.debug=Gt(p,T,"debug"),this.trace=Gt(p,T,"trace"),K&&(this.serializers=K,this._serialize=S),t&&(this._logEvent=sn([].concat(p._logEvent.bindings,T)))}return R.prototype=this,new R(this)}return h}gt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},gt.stdSerializers=eu,gt.stdTimeFunctions=Object.assign({},{nullTime:mi,epochTime:Di,unixTime:au,isoTime:uu});function Kt(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?tr:i[r]?i[r]:er[r]||er[n]||tr,ru(e,t,r)}function ru(e,t,r){!e.transmit&&t[r]===tr||(t[r]=function(n){return function(){const s=e.timestamp(),u=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===er?er:this;for(var h=0;h<u.length;h++)u[h]=arguments[h];if(e.serialize&&!e.asObject&&Rr(u,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(c,nu(this,r,u,s)):n.apply(c,u),e.transmit){const f=e.transmit.level||t.level,l=gt.levels.values[f],w=gt.levels.values[r];if(w<l)return;iu(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:f,transmitValue:gt.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},u)}}}(t[r]))}function nu(e,t,r,n){e._serialize&&Rr(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let s=i[0];const u={};n&&(u.time=n),u.level=gt.levels.values[t];let c=(e._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof i[0]=="object";)Object.assign(u,i.shift());s=i.length?wi(i.shift(),i):void 0}else typeof s=="string"&&(s=wi(i.shift(),i));return s!==void 0&&(u.msg=s),u}function Rr(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=gt.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(const s in e[i])t&&t.indexOf(s)>-1&&s in r&&(e[i][s]=r[s](e[i][s]))}function Gt(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function iu(e,t,r){const n=t.send,i=t.ts,s=t.methodLevel,u=t.methodValue,c=t.val,h=e._logEvent.bindings;Rr(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),e._logEvent.level.label=s,e._logEvent.level.value=u,n(s,e._logEvent,c),e._logEvent=sn(h)}function sn(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function su(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function ou(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?mi:Di}function Ir(){return{}}function on(e){return e}function tr(){}function mi(){return!1}function Di(){return Date.now()}function au(){return Math.round(Date.now()/1e3)}function uu(){return new Date(Date.now()).toISOString()}function cu(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}var Lr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var an=function(e,t){return an=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},an(e,t)};function fu(e,t){an(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var un=function(){return un=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},un.apply(this,arguments)};function hu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function lu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(u=e[c])&&(s=(i<3?u(s):i>3?u(t,r,s):u(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function du(e,t){return function(r,n){t(r,n,e)}}function _u(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function gu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(l){try{f(n.next(l))}catch(w){u(w)}}function h(l){try{f(n.throw(l))}catch(w){u(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function pu(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function yu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function vu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function cn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Si(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],u;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return s}function bu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Si(arguments[t]));return e}function Eu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],u=0,c=s.length;u<c;u++,i++)n[i]=s[u];return n}function rr(e){return this instanceof rr?(this.v=e,this):new rr(e)}function wu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof rr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function mu(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(u){return(r=!r)?{value:rr(e[i](u)),done:i==="return"}:s?s(u):u}:s}}function Du(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof cn=="function"?cn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(u){return new Promise(function(c,h){u=e[s](u),i(c,h,u.done,u.value)})}}function i(s,u,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},u)}}function Su(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Ou(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function xu(e){return e&&e.__esModule?e:{default:e}}function Tu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Ru(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Iu=Object.freeze({__proto__:null,__extends:fu,get __assign(){return un},__rest:hu,__decorate:lu,__param:du,__metadata:_u,__awaiter:gu,__generator:pu,__createBinding:yu,__exportStar:vu,__values:cn,__read:Si,__spread:bu,__spreadArrays:Eu,__await:rr,__asyncGenerator:wu,__asyncDelegator:mu,__asyncValues:Du,__makeTemplateObject:Su,__importStar:Ou,__importDefault:xu,__classPrivateFieldGet:Tu,__classPrivateFieldSet:Ru}),Oi=Lt(Iu),nr={};Object.defineProperty(nr,"__esModule",{value:!0});function Lu(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}nr.safeJsonParse=Lu;function Au(e){return typeof e=="string"?e:JSON.stringify(e,(t,r)=>typeof r>"u"?null:r)}nr.safeJsonStringify=Au;var ir={exports:{}},xi;function Cu(){return xi||(xi=1,function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,n){this[r]=String(n)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Je<"u"&&Je.localStorage?ir.exports=Je.localStorage:typeof window<"u"&&window.localStorage?ir.exports=window.localStorage:ir.exports=new t}()),ir.exports}var fn={},sr={},Ti;function Pu(){if(Ti)return sr;Ti=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.IKeyValueStorage=void 0;class e{}return sr.IKeyValueStorage=e,sr}var or={},Ri;function Nu(){if(Ri)return or;Ri=1,Object.defineProperty(or,"__esModule",{value:!0}),or.parseEntry=void 0;const e=nr;function t(r){var n;return[r[0],e.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return or.parseEntry=t,or}var Ii;function Uu(){return Ii||(Ii=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Oi;t.__exportStar(Pu(),e),t.__exportStar(Nu(),e)}(fn)),fn}Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.KeyValueStorage=void 0;const Vt=Oi,Li=nr,Mu=Vt.__importDefault(Cu()),ju=Uu();class Ai{constructor(){this.localStorage=Mu.default}getKeys(){return Vt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Vt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(ju.parseEntry)})}getItem(t){return Vt.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Li.safeJsonParse(r)})}setItem(t,r){return Vt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Li.safeJsonStringify(r))})}removeItem(t){return Vt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Lr.KeyValueStorage=Ai;var $u=Lr.default=Ai,ar={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var hn=function(e,t){return hn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},hn(e,t)};function Fu(e,t){hn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ln=function(){return ln=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ln.apply(this,arguments)};function Bu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function zu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(u=e[c])&&(s=(i<3?u(s):i>3?u(t,r,s):u(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Hu(e,t){return function(r,n){t(r,n,e)}}function Ku(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Gu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(l){try{f(n.next(l))}catch(w){u(w)}}function h(l){try{f(n.throw(l))}catch(w){u(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function Vu(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function qu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Wu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function dn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ci(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],u;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return s}function Yu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ci(arguments[t]));return e}function Xu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],u=0,c=s.length;u<c;u++,i++)n[i]=s[u];return n}function ur(e){return this instanceof ur?(this.v=e,this):new ur(e)}function ku(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof ur?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ju(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(u){return(r=!r)?{value:ur(e[i](u)),done:i==="return"}:s?s(u):u}:s}}function Zu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof dn=="function"?dn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(u){return new Promise(function(c,h){u=e[s](u),i(c,h,u.done,u.value)})}}function i(s,u,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},u)}}function Qu(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function ec(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function tc(e){return e&&e.__esModule?e:{default:e}}function rc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function nc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var ic=Object.freeze({__proto__:null,__extends:Fu,get __assign(){return ln},__rest:Bu,__decorate:zu,__param:Hu,__metadata:Ku,__awaiter:Gu,__generator:Vu,__createBinding:qu,__exportStar:Wu,__values:dn,__read:Ci,__spread:Yu,__spreadArrays:Xu,__await:ur,__asyncGenerator:ku,__asyncDelegator:Ju,__asyncValues:Zu,__makeTemplateObject:Qu,__importStar:ec,__importDefault:tc,__classPrivateFieldGet:rc,__classPrivateFieldSet:nc}),Ar=Lt(ic),cr={},_n,Pi;function Ni(){if(Pi)return _n;Pi=1;function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}_n=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(s){if(!r(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},e.prototype.emit=function(s){var u,c,h,f,l,w;if(this._events||(this._events={}),s==="error"&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(u=arguments[1],u instanceof Error)throw u;var b=new Error('Uncaught, unspecified "error" event. ('+u+")");throw b.context=u,b}if(c=this._events[s],i(c))return!1;if(t(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(n(c))for(f=Array.prototype.slice.call(arguments,1),w=c.slice(),h=w.length,l=0;l<h;l++)w[l].apply(this,f);return!0},e.prototype.addListener=function(s,u){var c;if(!t(u))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,t(u.listener)?u.listener:u),this._events[s]?n(this._events[s])?this._events[s].push(u):this._events[s]=[this._events[s],u]:this._events[s]=u,n(this._events[s])&&!this._events[s].warned&&(i(this._maxListeners)?c=e.defaultMaxListeners:c=this._maxListeners,c&&c>0&&this._events[s].length>c&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(s,u){if(!t(u))throw TypeError("listener must be a function");var c=!1;function h(){this.removeListener(s,h),c||(c=!0,u.apply(this,arguments))}return h.listener=u,this.on(s,h),this},e.prototype.removeListener=function(s,u){var c,h,f,l;if(!t(u))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(c=this._events[s],f=c.length,h=-1,c===u||t(c.listener)&&c.listener===u)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,u);else if(n(c)){for(l=f;l-- >0;)if(c[l]===u||c[l].listener&&c[l].listener===u){h=l;break}if(h<0)return this;c.length===1?(c.length=0,delete this._events[s]):c.splice(h,1),this._events.removeListener&&this.emit("removeListener",s,u)}return this},e.prototype.removeAllListeners=function(s){var u,c;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(u in this._events)u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[s],t(c))this.removeListener(s,c);else if(c)for(;c.length;)this.removeListener(s,c[c.length-1]);return delete this._events[s],this},e.prototype.listeners=function(s){var u;return!this._events||!this._events[s]?u=[]:t(this._events[s])?u=[this._events[s]]:u=this._events[s].slice(),u},e.prototype.listenerCount=function(s){if(this._events){var u=this._events[s];if(t(u))return 1;if(u)return u.length}return 0},e.listenerCount=function(s,u){return s.listenerCount(u)};function t(s){return typeof s=="function"}function r(s){return typeof s=="number"}function n(s){return typeof s=="object"&&s!==null}function i(s){return s===void 0}return _n}var De={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var gn=function(e,t){return gn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},gn(e,t)};function sc(e,t){gn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var pn=function(){return pn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},pn.apply(this,arguments)};function oc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function ac(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(u=e[c])&&(s=(i<3?u(s):i>3?u(t,r,s):u(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function uc(e,t){return function(r,n){t(r,n,e)}}function cc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function fc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(l){try{f(n.next(l))}catch(w){u(w)}}function h(l){try{f(n.throw(l))}catch(w){u(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function hc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function lc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function dc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function yn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ui(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],u;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return s}function _c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ui(arguments[t]));return e}function gc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],u=0,c=s.length;u<c;u++,i++)n[i]=s[u];return n}function fr(e){return this instanceof fr?(this.v=e,this):new fr(e)}function pc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof fr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function yc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(u){return(r=!r)?{value:fr(e[i](u)),done:i==="return"}:s?s(u):u}:s}}function vc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof yn=="function"?yn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(u){return new Promise(function(c,h){u=e[s](u),i(c,h,u.done,u.value)})}}function i(s,u,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},u)}}function bc(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Ec(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function wc(e){return e&&e.__esModule?e:{default:e}}function mc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Dc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Sc=Object.freeze({__proto__:null,__extends:sc,get __assign(){return pn},__rest:oc,__decorate:ac,__param:uc,__metadata:cc,__awaiter:fc,__generator:hc,__createBinding:lc,__exportStar:dc,__values:yn,__read:Ui,__spread:_c,__spreadArrays:gc,__await:fr,__asyncGenerator:pc,__asyncDelegator:yc,__asyncValues:vc,__makeTemplateObject:bc,__importStar:Ec,__importDefault:wc,__classPrivateFieldGet:mc,__classPrivateFieldSet:Dc}),Cr=Lt(Sc),vn={},hr={},Mi;function Oc(){if(Mi)return hr;Mi=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return hr.delay=e,hr}var At={},bn={},Ct={},ji;function xc(){return ji||(ji=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ONE_THOUSAND=Ct.ONE_HUNDRED=void 0,Ct.ONE_HUNDRED=100,Ct.ONE_THOUSAND=1e3),Ct}var En={},$i;function Tc(){return $i||($i=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(En)),En}var Fi;function Bi(){return Fi||(Fi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Cr;t.__exportStar(xc(),e),t.__exportStar(Tc(),e)}(bn)),bn}var zi;function Rc(){if(zi)return At;zi=1,Object.defineProperty(At,"__esModule",{value:!0}),At.fromMiliseconds=At.toMiliseconds=void 0;const e=Bi();function t(n){return n*e.ONE_THOUSAND}At.toMiliseconds=t;function r(n){return Math.floor(n/e.ONE_THOUSAND)}return At.fromMiliseconds=r,At}var Hi;function Ic(){return Hi||(Hi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Cr;t.__exportStar(Oc(),e),t.__exportStar(Rc(),e)}(vn)),vn}var qt={},Ki;function Lc(){if(Ki)return qt;Ki=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return qt.Watch=e,qt.default=e,qt}var wn={},lr={},Gi;function Ac(){if(Gi)return lr;Gi=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.IWatch=void 0;class e{}return lr.IWatch=e,lr}var Vi;function Cc(){return Vi||(Vi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Cr.__exportStar(Ac(),e)}(wn)),wn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Cr;t.__exportStar(Ic(),e),t.__exportStar(Lc(),e),t.__exportStar(Cc(),e),t.__exportStar(Bi(),e)})(De);var mn={},dr={};class Pt{}var Pc=Object.freeze({__proto__:null,IEvents:Pt}),Nc=Lt(Pc),qi;function Uc(){if(qi)return dr;qi=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.IHeartBeat=void 0;const e=Nc;class t extends e.IEvents{constructor(n){super()}}return dr.IHeartBeat=t,dr}var Wi;function Yi(){return Wi||(Wi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Ar.__exportStar(Uc(),e)}(mn)),mn}var Dn={},Nt={},Xi;function Mc(){if(Xi)return Nt;Xi=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.HEARTBEAT_EVENTS=Nt.HEARTBEAT_INTERVAL=void 0;const e=De;return Nt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Nt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Nt}var ki;function Ji(){return ki||(ki=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Ar.__exportStar(Mc(),e)}(Dn)),Dn}var Zi;function jc(){if(Zi)return cr;Zi=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.HeartBeat=void 0;const e=Ar,t=Ni(),r=De,n=Yi(),i=Ji();class s extends n.IHeartBeat{constructor(c){super(c),this.events=new t.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=c?.interval||i.HEARTBEAT_INTERVAL}static init(c){return e.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return cr.HeartBeat=s,cr}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ar;t.__exportStar(jc(),e),t.__exportStar(Yi(),e),t.__exportStar(Ji(),e)})(ar);var Re={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Sn=function(e,t){return Sn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Sn(e,t)};function $c(e,t){Sn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var On=function(){return On=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},On.apply(this,arguments)};function Fc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Bc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(u=e[c])&&(s=(i<3?u(s):i>3?u(t,r,s):u(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function zc(e,t){return function(r,n){t(r,n,e)}}function Hc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Kc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(l){try{f(n.next(l))}catch(w){u(w)}}function h(l){try{f(n.throw(l))}catch(w){u(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function Gc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Vc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function qc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function xn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qi(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],u;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return s}function Wc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Qi(arguments[t]));return e}function Yc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],u=0,c=s.length;u<c;u++,i++)n[i]=s[u];return n}function _r(e){return this instanceof _r?(this.v=e,this):new _r(e)}function Xc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof _r?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function kc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(u){return(r=!r)?{value:_r(e[i](u)),done:i==="return"}:s?s(u):u}:s}}function Jc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof xn=="function"?xn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(u){return new Promise(function(c,h){u=e[s](u),i(c,h,u.done,u.value)})}}function i(s,u,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},u)}}function Zc(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Qc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function ef(e){return e&&e.__esModule?e:{default:e}}function tf(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function rf(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var nf=Object.freeze({__proto__:null,__extends:$c,get __assign(){return On},__rest:Fc,__decorate:Bc,__param:zc,__metadata:Hc,__awaiter:Kc,__generator:Gc,__createBinding:Vc,__exportStar:qc,__values:xn,__read:Qi,__spread:Wc,__spreadArrays:Yc,__await:_r,__asyncGenerator:Xc,__asyncDelegator:kc,__asyncValues:Jc,__makeTemplateObject:Zc,__importStar:Qc,__importDefault:ef,__classPrivateFieldGet:tf,__classPrivateFieldSet:rf}),sf=Lt(nf),Ut={},es;function ts(){return es||(es=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.PINO_CUSTOM_CONTEXT_KEY=Ut.PINO_LOGGER_DEFAULTS=void 0,Ut.PINO_LOGGER_DEFAULTS={level:"info"},Ut.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ut}var rt={},rs;function of(){if(rs)return rt;rs=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.generateChildLogger=rt.formatChildLoggerContext=rt.getLoggerContext=rt.setBrowserLoggerContext=rt.getBrowserLoggerContext=rt.getDefaultLoggerOptions=void 0;const e=ts();function t(c){return Object.assign(Object.assign({},c),{level:c?.level||e.PINO_LOGGER_DEFAULTS.level})}rt.getDefaultLoggerOptions=t;function r(c,h=e.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}rt.getBrowserLoggerContext=r;function n(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){return c[f]=h,c}rt.setBrowserLoggerContext=n;function i(c,h=e.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof c.bindings>"u"?f=r(c,h):f=c.bindings().context||"",f}rt.getLoggerContext=i;function s(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const l=i(c,f);return l.trim()?`${l}/${h}`:h}rt.formatChildLoggerContext=s;function u(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const l=s(c,h,f),w=c.child({context:l});return n(w,l,f)}return rt.generateChildLogger=u,rt}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pino=void 0;const t=sf,r=t.__importDefault(nn);Object.defineProperty(e,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(ts(),e),t.__exportStar(of(),e)})(Re);var ns={exports:{}},Wt=typeof Reflect=="object"?Reflect:null,is=Wt&&typeof Wt.apply=="function"?Wt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Pr;Wt&&typeof Wt.ownKeys=="function"?Pr=Wt.ownKeys:Object.getOwnPropertySymbols?Pr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Pr=function(t){return Object.getOwnPropertyNames(t)};function af(e){console&&console.warn&&console.warn(e)}var ss=Number.isNaN||function(t){return t!==t};function Oe(){Oe.init.call(this)}ns.exports=Oe,ns.exports.once=hf,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var os=10;function Nr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return os},set:function(e){if(typeof e!="number"||e<0||ss(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");os=e}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ss(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function as(e){return e._maxListeners===void 0?Oe.defaultMaxListeners:e._maxListeners}Oe.prototype.getMaxListeners=function(){return as(this)},Oe.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var u;if(r.length>0&&(u=r[0]),u instanceof Error)throw u;var c=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw c.context=u,c}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")is(h,this,r);else for(var f=h.length,l=ls(h,f),n=0;n<f;++n)is(l[n],this,r);return!0};function us(e,t,r,n){var i,s,u;if(Nr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),u=s[t]),u===void 0)u=s[t]=r,++e._eventsCount;else if(typeof u=="function"?u=s[t]=n?[r,u]:[u,r]:n?u.unshift(r):u.push(r),i=as(e),i>0&&u.length>i&&!u.warned){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=u.length,af(c)}return e}Oe.prototype.addListener=function(t,r){return us(this,t,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(t,r){return us(this,t,r,!0)};function uf(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function cs(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=uf.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(t,r){return Nr(r),this.on(t,cs(this,t,r)),this},Oe.prototype.prependOnceListener=function(t,r){return Nr(r),this.prependListener(t,cs(this,t,r)),this},Oe.prototype.removeListener=function(t,r){var n,i,s,u,c;if(Nr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,u=n.length-1;u>=0;u--)if(n[u]===r||n[u].listener===r){c=n[u].listener,s=u;break}if(s<0)return this;s===0?n.shift():cf(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),u;for(i=0;i<s.length;++i)u=s[i],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function fs(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?ff(i):ls(i,i.length)}Oe.prototype.listeners=function(t){return fs(this,t,!0)},Oe.prototype.rawListeners=function(t){return fs(this,t,!1)},Oe.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):hs.call(e,t)},Oe.prototype.listenerCount=hs;function hs(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Pr(this._events):[]};function ls(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function cf(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function ff(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function hf(e,t){return new Promise(function(r,n){function i(u){e.removeListener(t,s),n(u)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}ds(e,t,s,{once:!0}),t!=="error"&&lf(e,i,{once:!0})})}function lf(e,t,r){typeof e.on=="function"&&ds(e,"error",t,r)}function ds(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}class df extends Pt{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class _f extends Pt{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class gf{constructor(t,r){this.logger=t,this.core=r}}class pf extends Pt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class yf extends Pt{constructor(t){super()}}class vf{constructor(t,r,n,i){this.core=t,this.logger=r,this.name=n}}class bf extends Pt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Ef extends Pt{constructor(t,r){super(),this.core=t,this.logger=r}}function _s(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}function Tn(e){return typeof e=="string"?e:JSON.stringify(e)}var Rn={},Yt={},Ur={},Mr={};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.BrowserRandomSource=void 0;const gs=65536;class wf{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let n=0;n<r.length;n+=gs)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,gs)));return r}}Mr.BrowserRandomSource=wf;function mf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jr={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});function Df(e){for(var t=0;t<e.length;t++)e[t]=0;return e}ot.wipe=Df;var Sf={},Of=Object.freeze({__proto__:null,default:Sf}),xf=Lt(Of);Object.defineProperty(jr,"__esModule",{value:!0}),jr.NodeRandomSource=void 0;const Tf=ot;class Rf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof mf<"u"){const t=xf;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Tf.wipe)(r),n}}jr.NodeRandomSource=Rf,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.SystemRandomSource=void 0;const If=Mr,Lf=jr;class Af{constructor(){if(this.isAvailable=!1,this.name="",this._source=new If.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Lf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Ur.SystemRandomSource=Af;var ee={},ps={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(c,h){var f=c>>>16&65535,l=c&65535,w=h>>>16&65535,b=h&65535;return l*b+(f*b+l*w<<16>>>0)|0}e.mul=Math.imul||t;function r(c,h){return c+h|0}e.add=r;function n(c,h){return c-h|0}e.sub=n;function i(c,h){return c<<h|c>>>32-h}e.rotl=i;function s(c,h){return c<<32-h|c>>>h}e.rotr=s;function u(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}e.isInteger=Number.isInteger||u,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(c){return e.isInteger(c)&&c>=-e.MAX_SAFE_INTEGER&&c<=e.MAX_SAFE_INTEGER}})(ps),Object.defineProperty(ee,"__esModule",{value:!0});var ys=ps;function Cf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}ee.readInt16BE=Cf;function Pf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}ee.readUint16BE=Pf;function Nf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}ee.readInt16LE=Nf;function Uf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}ee.readUint16LE=Uf;function vs(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}ee.writeUint16BE=vs,ee.writeInt16BE=vs;function bs(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}ee.writeUint16LE=bs,ee.writeInt16LE=bs;function In(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}ee.readInt32BE=In;function Ln(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}ee.readUint32BE=Ln;function An(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}ee.readInt32LE=An;function Cn(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}ee.readUint32LE=Cn;function $r(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}ee.writeUint32BE=$r,ee.writeInt32BE=$r;function Fr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}ee.writeUint32LE=Fr,ee.writeInt32LE=Fr;function Mf(e,t){t===void 0&&(t=0);var r=In(e,t),n=In(e,t+4);return r*4294967296+n-(n>>31)*4294967296}ee.readInt64BE=Mf;function jf(e,t){t===void 0&&(t=0);var r=Ln(e,t),n=Ln(e,t+4);return r*4294967296+n}ee.readUint64BE=jf;function $f(e,t){t===void 0&&(t=0);var r=An(e,t),n=An(e,t+4);return n*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=$f;function Ff(e,t){t===void 0&&(t=0);var r=Cn(e,t),n=Cn(e,t+4);return n*4294967296+r}ee.readUint64LE=Ff;function Es(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),$r(e/4294967296>>>0,t,r),$r(e>>>0,t,r+4),t}ee.writeUint64BE=Es,ee.writeInt64BE=Es;function ws(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Fr(e>>>0,t,r),Fr(e/4294967296>>>0,t,r+4),t}ee.writeUint64LE=ws,ee.writeInt64LE=ws;function Bf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}ee.readUintBE=Bf;function zf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}ee.readUintLE=zf;function Hf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ys.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}ee.writeUintBE=Hf;function Kf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ys.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}ee.writeUintLE=Kf;function Gf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}ee.readFloat32BE=Gf;function Vf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}ee.readFloat32LE=Vf;function qf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}ee.readFloat64BE=qf;function Wf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}ee.readFloat64LE=Wf;function Yf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}ee.writeFloat32BE=Yf;function Xf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}ee.writeFloat32LE=Xf;function kf(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}ee.writeFloat64BE=kf;function Jf(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}ee.writeFloat64LE=Jf,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=Ur,r=ee,n=ot;e.defaultRandomSource=new t.SystemRandomSource;function i(f,l=e.defaultRandomSource){return l.randomBytes(f)}e.randomBytes=i;function s(f=e.defaultRandomSource){const l=i(4,f),w=(0,r.readUint32LE)(l);return(0,n.wipe)(l),w}e.randomUint32=s;const u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(f,l=u,w=e.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let b="";const v=l.length,T=256-256%v;for(;f>0;){const U=i(Math.ceil(f*256/T),w);for(let P=0;P<U.length&&f>0;P++){const K=U[P];K<T&&(b+=l.charAt(K%v),f--)}(0,n.wipe)(U)}return b}e.randomString=c;function h(f,l=u,w=e.defaultRandomSource){const b=Math.ceil(f/(Math.log(l.length)/Math.LN2));return c(b,l,w)}e.randomStringForEntropy=h}(Yt);var ms={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ee,r=ot;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,b=f<<3,v=f%128<112?128:256;this._buffer[l]=128;for(var T=l+1;T<v-8;T++)this._buffer[T]=0;t.writeUint32BE(w,this._buffer,v-8),t.writeUint32BE(b,this._buffer,v-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],h,T*8),t.writeUint32BE(this._stateLo[T],h,T*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,f,l,w,b,v){for(var T=f[0],U=f[1],P=f[2],K=f[3],S=f[4],R=f[5],p=f[6],E=f[7],y=l[0],o=l[1],_=l[2],j=l[3],F=l[4],Y=l[5],k=l[6],J=l[7],L,I,q,$,C,N,M,B;v>=128;){for(var re=0;re<16;re++){var z=8*re+b;c[re]=t.readUint32BE(w,z),h[re]=t.readUint32BE(w,z+4)}for(var re=0;re<80;re++){var Z=T,W=U,oe=P,x=K,O=S,m=R,a=p,g=E,H=y,G=o,fe=_,pe=j,le=F,be=Y,Me=k,Ce=J;if(L=E,I=J,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=(S>>>14|F<<32-14)^(S>>>18|F<<32-18)^(F>>>41-32|S<<32-(41-32)),I=(F>>>14|S<<32-14)^(F>>>18|S<<32-18)^(S>>>41-32|F<<32-(41-32)),C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,L=S&R^~S&p,I=F&Y^~F&k,C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,L=i[re*2],I=i[re*2+1],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,L=c[re%16],I=h[re%16],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,q=M&65535|B<<16,$=C&65535|N<<16,L=q,I=$,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=(T>>>28|y<<32-28)^(y>>>34-32|T<<32-(34-32))^(y>>>39-32|T<<32-(39-32)),I=(y>>>28|T<<32-28)^(T>>>34-32|y<<32-(34-32))^(T>>>39-32|y<<32-(39-32)),C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,L=T&U^T&P^U&P,I=y&o^y&_^o&_,C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,g=M&65535|B<<16,Ce=C&65535|N<<16,L=x,I=pe,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=q,I=$,C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,x=M&65535|B<<16,pe=C&65535|N<<16,U=Z,P=W,K=oe,S=x,R=O,p=m,E=a,T=g,o=H,_=G,j=fe,F=pe,Y=le,k=be,J=Me,y=Ce,re%16===15)for(var z=0;z<16;z++)L=c[z],I=h[z],C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=c[(z+9)%16],I=h[(z+9)%16],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,q=c[(z+1)%16],$=h[(z+1)%16],L=(q>>>1|$<<32-1)^(q>>>8|$<<32-8)^q>>>7,I=($>>>1|q<<32-1)^($>>>8|q<<32-8)^($>>>7|q<<32-7),C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,q=c[(z+14)%16],$=h[(z+14)%16],L=(q>>>19|$<<32-19)^($>>>61-32|q<<32-(61-32))^q>>>6,I=($>>>19|q<<32-19)^(q>>>61-32|$<<32-(61-32))^($>>>6|q<<32-6),C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,c[z]=M&65535|B<<16,h[z]=C&65535|N<<16}L=T,I=y,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[0],I=l[0],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[0]=T=M&65535|B<<16,l[0]=y=C&65535|N<<16,L=U,I=o,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[1],I=l[1],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[1]=U=M&65535|B<<16,l[1]=o=C&65535|N<<16,L=P,I=_,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[2],I=l[2],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[2]=P=M&65535|B<<16,l[2]=_=C&65535|N<<16,L=K,I=j,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[3],I=l[3],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[3]=K=M&65535|B<<16,l[3]=j=C&65535|N<<16,L=S,I=F,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[4],I=l[4],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[4]=S=M&65535|B<<16,l[4]=F=C&65535|N<<16,L=R,I=Y,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[5],I=l[5],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[5]=R=M&65535|B<<16,l[5]=Y=C&65535|N<<16,L=p,I=k,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[6],I=l[6],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[6]=p=M&65535|B<<16,l[6]=k=C&65535|N<<16,L=E,I=J,C=I&65535,N=I>>>16,M=L&65535,B=L>>>16,L=f[7],I=l[7],C+=I&65535,N+=I>>>16,M+=L&65535,B+=L>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[7]=E=M&65535|B<<16,l[7]=J=C&65535|N<<16,b+=128,v-=128}return b}function u(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}e.hash=u})(ms),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=Yt,r=ms,n=ot;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function i(x){const O=new Float64Array(16);if(x)for(let m=0;m<x.length;m++)O[m]=x[m];return O}const s=new Uint8Array(32);s[0]=9;const u=i(),c=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(x,O){for(let m=0;m<16;m++)x[m]=O[m]|0}function T(x){let O=1;for(let m=0;m<16;m++){let a=x[m]+O+65535;O=Math.floor(a/65536),x[m]=a-O*65536}x[0]+=O-1+37*(O-1)}function U(x,O,m){const a=~(m-1);for(let g=0;g<16;g++){const H=a&(x[g]^O[g]);x[g]^=H,O[g]^=H}}function P(x,O){const m=i(),a=i();for(let g=0;g<16;g++)a[g]=O[g];T(a),T(a),T(a);for(let g=0;g<2;g++){m[0]=a[0]-65517;for(let G=1;G<15;G++)m[G]=a[G]-65535-(m[G-1]>>16&1),m[G-1]&=65535;m[15]=a[15]-32767-(m[14]>>16&1);const H=m[15]>>16&1;m[14]&=65535,U(a,m,1-H)}for(let g=0;g<16;g++)x[2*g]=a[g]&255,x[2*g+1]=a[g]>>8}function K(x,O){let m=0;for(let a=0;a<32;a++)m|=x[a]^O[a];return(1&m-1>>>8)-1}function S(x,O){const m=new Uint8Array(32),a=new Uint8Array(32);return P(m,x),P(a,O),K(m,a)}function R(x){const O=new Uint8Array(32);return P(O,x),O[0]&1}function p(x,O){for(let m=0;m<16;m++)x[m]=O[2*m]+(O[2*m+1]<<8);x[15]&=32767}function E(x,O,m){for(let a=0;a<16;a++)x[a]=O[a]+m[a]}function y(x,O,m){for(let a=0;a<16;a++)x[a]=O[a]-m[a]}function o(x,O,m){let a,g,H=0,G=0,fe=0,pe=0,le=0,be=0,Me=0,Ce=0,ge=0,de=0,he=0,ue=0,ae=0,se=0,ie=0,Q=0,ce=0,_e=0,te=0,ye=0,ve=0,we=0,me=0,Ee=0,dt=0,vt=0,xt=0,at=0,$t=0,Dr=0,kr=0,je=m[0],Pe=m[1],$e=m[2],Fe=m[3],Be=m[4],Ne=m[5],Ke=m[6],Ge=m[7],Ve=m[8],qe=m[9],We=m[10],He=m[11],ze=m[12],Le=m[13],Ye=m[14],Xe=m[15];a=O[0],H+=a*je,G+=a*Pe,fe+=a*$e,pe+=a*Fe,le+=a*Be,be+=a*Ne,Me+=a*Ke,Ce+=a*Ge,ge+=a*Ve,de+=a*qe,he+=a*We,ue+=a*He,ae+=a*ze,se+=a*Le,ie+=a*Ye,Q+=a*Xe,a=O[1],G+=a*je,fe+=a*Pe,pe+=a*$e,le+=a*Fe,be+=a*Be,Me+=a*Ne,Ce+=a*Ke,ge+=a*Ge,de+=a*Ve,he+=a*qe,ue+=a*We,ae+=a*He,se+=a*ze,ie+=a*Le,Q+=a*Ye,ce+=a*Xe,a=O[2],fe+=a*je,pe+=a*Pe,le+=a*$e,be+=a*Fe,Me+=a*Be,Ce+=a*Ne,ge+=a*Ke,de+=a*Ge,he+=a*Ve,ue+=a*qe,ae+=a*We,se+=a*He,ie+=a*ze,Q+=a*Le,ce+=a*Ye,_e+=a*Xe,a=O[3],pe+=a*je,le+=a*Pe,be+=a*$e,Me+=a*Fe,Ce+=a*Be,ge+=a*Ne,de+=a*Ke,he+=a*Ge,ue+=a*Ve,ae+=a*qe,se+=a*We,ie+=a*He,Q+=a*ze,ce+=a*Le,_e+=a*Ye,te+=a*Xe,a=O[4],le+=a*je,be+=a*Pe,Me+=a*$e,Ce+=a*Fe,ge+=a*Be,de+=a*Ne,he+=a*Ke,ue+=a*Ge,ae+=a*Ve,se+=a*qe,ie+=a*We,Q+=a*He,ce+=a*ze,_e+=a*Le,te+=a*Ye,ye+=a*Xe,a=O[5],be+=a*je,Me+=a*Pe,Ce+=a*$e,ge+=a*Fe,de+=a*Be,he+=a*Ne,ue+=a*Ke,ae+=a*Ge,se+=a*Ve,ie+=a*qe,Q+=a*We,ce+=a*He,_e+=a*ze,te+=a*Le,ye+=a*Ye,ve+=a*Xe,a=O[6],Me+=a*je,Ce+=a*Pe,ge+=a*$e,de+=a*Fe,he+=a*Be,ue+=a*Ne,ae+=a*Ke,se+=a*Ge,ie+=a*Ve,Q+=a*qe,ce+=a*We,_e+=a*He,te+=a*ze,ye+=a*Le,ve+=a*Ye,we+=a*Xe,a=O[7],Ce+=a*je,ge+=a*Pe,de+=a*$e,he+=a*Fe,ue+=a*Be,ae+=a*Ne,se+=a*Ke,ie+=a*Ge,Q+=a*Ve,ce+=a*qe,_e+=a*We,te+=a*He,ye+=a*ze,ve+=a*Le,we+=a*Ye,me+=a*Xe,a=O[8],ge+=a*je,de+=a*Pe,he+=a*$e,ue+=a*Fe,ae+=a*Be,se+=a*Ne,ie+=a*Ke,Q+=a*Ge,ce+=a*Ve,_e+=a*qe,te+=a*We,ye+=a*He,ve+=a*ze,we+=a*Le,me+=a*Ye,Ee+=a*Xe,a=O[9],de+=a*je,he+=a*Pe,ue+=a*$e,ae+=a*Fe,se+=a*Be,ie+=a*Ne,Q+=a*Ke,ce+=a*Ge,_e+=a*Ve,te+=a*qe,ye+=a*We,ve+=a*He,we+=a*ze,me+=a*Le,Ee+=a*Ye,dt+=a*Xe,a=O[10],he+=a*je,ue+=a*Pe,ae+=a*$e,se+=a*Fe,ie+=a*Be,Q+=a*Ne,ce+=a*Ke,_e+=a*Ge,te+=a*Ve,ye+=a*qe,ve+=a*We,we+=a*He,me+=a*ze,Ee+=a*Le,dt+=a*Ye,vt+=a*Xe,a=O[11],ue+=a*je,ae+=a*Pe,se+=a*$e,ie+=a*Fe,Q+=a*Be,ce+=a*Ne,_e+=a*Ke,te+=a*Ge,ye+=a*Ve,ve+=a*qe,we+=a*We,me+=a*He,Ee+=a*ze,dt+=a*Le,vt+=a*Ye,xt+=a*Xe,a=O[12],ae+=a*je,se+=a*Pe,ie+=a*$e,Q+=a*Fe,ce+=a*Be,_e+=a*Ne,te+=a*Ke,ye+=a*Ge,ve+=a*Ve,we+=a*qe,me+=a*We,Ee+=a*He,dt+=a*ze,vt+=a*Le,xt+=a*Ye,at+=a*Xe,a=O[13],se+=a*je,ie+=a*Pe,Q+=a*$e,ce+=a*Fe,_e+=a*Be,te+=a*Ne,ye+=a*Ke,ve+=a*Ge,we+=a*Ve,me+=a*qe,Ee+=a*We,dt+=a*He,vt+=a*ze,xt+=a*Le,at+=a*Ye,$t+=a*Xe,a=O[14],ie+=a*je,Q+=a*Pe,ce+=a*$e,_e+=a*Fe,te+=a*Be,ye+=a*Ne,ve+=a*Ke,we+=a*Ge,me+=a*Ve,Ee+=a*qe,dt+=a*We,vt+=a*He,xt+=a*ze,at+=a*Le,$t+=a*Ye,Dr+=a*Xe,a=O[15],Q+=a*je,ce+=a*Pe,_e+=a*$e,te+=a*Fe,ye+=a*Be,ve+=a*Ne,we+=a*Ke,me+=a*Ge,Ee+=a*Ve,dt+=a*qe,vt+=a*We,xt+=a*He,at+=a*ze,$t+=a*Le,Dr+=a*Ye,kr+=a*Xe,H+=38*ce,G+=38*_e,fe+=38*te,pe+=38*ye,le+=38*ve,be+=38*we,Me+=38*me,Ce+=38*Ee,ge+=38*dt,de+=38*vt,he+=38*xt,ue+=38*at,ae+=38*$t,se+=38*Dr,ie+=38*kr,g=1,a=H+g+65535,g=Math.floor(a/65536),H=a-g*65536,a=G+g+65535,g=Math.floor(a/65536),G=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=pe+g+65535,g=Math.floor(a/65536),pe=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=be+g+65535,g=Math.floor(a/65536),be=a-g*65536,a=Me+g+65535,g=Math.floor(a/65536),Me=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ge+g+65535,g=Math.floor(a/65536),ge=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=he+g+65535,g=Math.floor(a/65536),he=a-g*65536,a=ue+g+65535,g=Math.floor(a/65536),ue=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ie+g+65535,g=Math.floor(a/65536),ie=a-g*65536,a=Q+g+65535,g=Math.floor(a/65536),Q=a-g*65536,H+=g-1+37*(g-1),g=1,a=H+g+65535,g=Math.floor(a/65536),H=a-g*65536,a=G+g+65535,g=Math.floor(a/65536),G=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=pe+g+65535,g=Math.floor(a/65536),pe=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=be+g+65535,g=Math.floor(a/65536),be=a-g*65536,a=Me+g+65535,g=Math.floor(a/65536),Me=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ge+g+65535,g=Math.floor(a/65536),ge=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=he+g+65535,g=Math.floor(a/65536),he=a-g*65536,a=ue+g+65535,g=Math.floor(a/65536),ue=a-g*65536,a=ae+g+65535,g=Math.floor(a/65536),ae=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ie+g+65535,g=Math.floor(a/65536),ie=a-g*65536,a=Q+g+65535,g=Math.floor(a/65536),Q=a-g*65536,H+=g-1+37*(g-1),x[0]=H,x[1]=G,x[2]=fe,x[3]=pe,x[4]=le,x[5]=be,x[6]=Me,x[7]=Ce,x[8]=ge,x[9]=de,x[10]=he,x[11]=ue,x[12]=ae,x[13]=se,x[14]=ie,x[15]=Q}function _(x,O){o(x,O,O)}function j(x,O){const m=i();let a;for(a=0;a<16;a++)m[a]=O[a];for(a=253;a>=0;a--)_(m,m),a!==2&&a!==4&&o(m,m,O);for(a=0;a<16;a++)x[a]=m[a]}function F(x,O){const m=i();let a;for(a=0;a<16;a++)m[a]=O[a];for(a=250;a>=0;a--)_(m,m),a!==1&&o(m,m,O);for(a=0;a<16;a++)x[a]=m[a]}function Y(x,O){const m=i(),a=i(),g=i(),H=i(),G=i(),fe=i(),pe=i(),le=i(),be=i();y(m,x[1],x[0]),y(be,O[1],O[0]),o(m,m,be),E(a,x[0],x[1]),E(be,O[0],O[1]),o(a,a,be),o(g,x[3],O[3]),o(g,g,f),o(H,x[2],O[2]),E(H,H,H),y(G,a,m),y(fe,H,g),E(pe,H,g),E(le,a,m),o(x[0],G,fe),o(x[1],le,pe),o(x[2],pe,fe),o(x[3],G,le)}function k(x,O,m){for(let a=0;a<4;a++)U(x[a],O[a],m)}function J(x,O){const m=i(),a=i(),g=i();j(g,O[2]),o(m,O[0],g),o(a,O[1],g),P(x,a),x[31]^=R(m)<<7}function L(x,O,m){v(x[0],u),v(x[1],c),v(x[2],c),v(x[3],u);for(let a=255;a>=0;--a){const g=m[a/8|0]>>(a&7)&1;k(x,O,g),Y(O,x),Y(x,x),k(x,O,g)}}function I(x,O){const m=[i(),i(),i(),i()];v(m[0],l),v(m[1],w),v(m[2],c),o(m[3],l,w),L(x,m,O)}function q(x){if(x.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const O=(0,r.hash)(x);O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(32),a=[i(),i(),i(),i()];I(a,O),J(m,a);const g=new Uint8Array(64);return g.set(x),g.set(m,32),{publicKey:m,secretKey:g}}e.generateKeyPairFromSeed=q;function $(x){const O=(0,t.randomBytes)(32,x),m=q(O);return(0,n.wipe)(O),m}e.generateKeyPair=$;function C(x){if(x.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}e.extractPublicKeyFromSecretKey=C;const N=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(x,O){let m,a,g,H;for(a=63;a>=32;--a){for(m=0,g=a-32,H=a-12;g<H;++g)O[g]+=m-16*O[a]*N[g-(a-32)],m=Math.floor((O[g]+128)/256),O[g]-=m*256;O[g]+=m,O[a]=0}for(m=0,g=0;g<32;g++)O[g]+=m-(O[31]>>4)*N[g],m=O[g]>>8,O[g]&=255;for(g=0;g<32;g++)O[g]-=m*N[g];for(a=0;a<32;a++)O[a+1]+=O[a]>>8,x[a]=O[a]&255}function B(x){const O=new Float64Array(64);for(let m=0;m<64;m++)O[m]=x[m];for(let m=0;m<64;m++)x[m]=0;M(x,O)}function re(x,O){const m=new Float64Array(64),a=[i(),i(),i(),i()],g=(0,r.hash)(x.subarray(0,32));g[0]&=248,g[31]&=127,g[31]|=64;const H=new Uint8Array(64);H.set(g.subarray(32),32);const G=new r.SHA512;G.update(H.subarray(32)),G.update(O);const fe=G.digest();G.clean(),B(fe),I(a,fe),J(H,a),G.reset(),G.update(H.subarray(0,32)),G.update(x.subarray(32)),G.update(O);const pe=G.digest();B(pe);for(let le=0;le<32;le++)m[le]=fe[le];for(let le=0;le<32;le++)for(let be=0;be<32;be++)m[le+be]+=pe[le]*g[be];return M(H.subarray(32),m),H}e.sign=re;function z(x,O){const m=i(),a=i(),g=i(),H=i(),G=i(),fe=i(),pe=i();return v(x[2],c),p(x[1],O),_(g,x[1]),o(H,g,h),y(g,g,x[2]),E(H,x[2],H),_(G,H),_(fe,G),o(pe,fe,G),o(m,pe,g),o(m,m,H),F(m,m),o(m,m,g),o(m,m,H),o(m,m,H),o(x[0],m,H),_(a,x[0]),o(a,a,H),S(a,g)&&o(x[0],x[0],b),_(a,x[0]),o(a,a,H),S(a,g)?-1:(R(x[0])===O[31]>>7&&y(x[0],u,x[0]),o(x[3],x[0],x[1]),0)}function Z(x,O,m){const a=new Uint8Array(32),g=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(m.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(z(H,x))return!1;const G=new r.SHA512;G.update(m.subarray(0,32)),G.update(x),G.update(O);const fe=G.digest();return B(fe),L(g,H,fe),I(H,m.subarray(32)),Y(g,H),J(a,g),!K(m,a)}e.verify=Z;function W(x){let O=[i(),i(),i(),i()];if(z(O,x))throw new Error("Ed25519: invalid public key");let m=i(),a=i(),g=O[1];E(m,c,g),y(a,c,g),j(a,a),o(m,m,a);let H=new Uint8Array(32);return P(H,m),H}e.convertPublicKeyToX25519=W;function oe(x){const O=(0,r.hash)(x.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(O.subarray(0,32));return(0,n.wipe)(O),m}e.convertSecretKeyToX25519=oe}(Rn);const Zf="EdDSA",Qf="JWT",Ds=".",Ss="base64url",eh="utf8",th="utf8",rh=":",nh="did",ih="key",Os="base58btc",sh="z",oh="K36",ah=32;function xs(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Pn(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const r=xs(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}function uh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),u=s.charCodeAt(0);if(r[u]!==255)throw new TypeError(s+" is ambiguous");r[u]=i}var c=e.length,h=e.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function w(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var U=0,P=0,K=0,S=T.length;K!==S&&T[K]===0;)K++,U++;for(var R=(S-K)*l+1>>>0,p=new Uint8Array(R);K!==S;){for(var E=T[K],y=0,o=R-1;(E!==0||y<P)&&o!==-1;o--,y++)E+=256*p[o]>>>0,p[o]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");P=y,K++}for(var _=R-P;_!==R&&p[_]===0;)_++;for(var j=h.repeat(U);_<R;++_)j+=e.charAt(p[_]);return j}function b(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var U=0;if(T[U]!==" "){for(var P=0,K=0;T[U]===h;)P++,U++;for(var S=(T.length-U)*f+1>>>0,R=new Uint8Array(S);T[U];){var p=r[T.charCodeAt(U)];if(p===255)return;for(var E=0,y=S-1;(p!==0||E<K)&&y!==-1;y--,E++)p+=c*R[y]>>>0,R[y]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");K=E,U++}if(T[U]!==" "){for(var o=S-K;o!==S&&R[o]===0;)o++;for(var _=new Uint8Array(P+(S-o)),j=P;o!==S;)_[j++]=R[o++];return _}}}function v(T){var U=b(T);if(U)return U;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:b,decode:v}}var ch=uh,fh=ch;const Ts=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},hh=e=>new TextEncoder().encode(e),lh=e=>new TextDecoder().decode(e);class dh{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class _h{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Rs(this,t)}}class gh{constructor(t){this.decoders=t}or(t){return Rs(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Rs=(e,t)=>new gh({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ph{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new dh(t,r,n),this.decoder=new _h(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Br=({name:e,prefix:t,encode:r,decode:n})=>new ph(e,t,r,n),gr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=fh(r,t);return Br({prefix:e,name:t,encode:n,decode:s=>Ts(i(s))})},yh=(e,t,r,n)=>{const i={};for(let l=0;l<t.length;++l)i[t[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;const u=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let l=0;l<s;++l){const w=i[e[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|w,c+=r,c>=8&&(c-=8,u[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return u},vh=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",u=0,c=0;for(let h=0;h<e.length;++h)for(c=c<<8|e[h],u+=8;u>r;)u-=r,s+=t[i&c>>u];if(u&&(s+=t[i&c<<r-u]),n)for(;s.length*r&7;)s+="=";return s},Ze=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Br({prefix:t,name:e,encode(i){return vh(i,n,r)},decode(i){return yh(i,n,r,e)}}),bh=Br({prefix:"\0",name:"identity",encode:e=>lh(e),decode:e=>hh(e)});var Eh=Object.freeze({__proto__:null,identity:bh});const wh=Ze({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var mh=Object.freeze({__proto__:null,base2:wh});const Dh=Ze({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Sh=Object.freeze({__proto__:null,base8:Dh});const Oh=gr({prefix:"9",name:"base10",alphabet:"0123456789"});var xh=Object.freeze({__proto__:null,base10:Oh});const Th=Ze({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rh=Ze({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ih=Object.freeze({__proto__:null,base16:Th,base16upper:Rh});const Lh=Ze({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ah=Ze({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ch=Ze({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ph=Ze({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Nh=Ze({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Uh=Ze({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mh=Ze({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jh=Ze({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$h=Ze({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Fh=Object.freeze({__proto__:null,base32:Lh,base32upper:Ah,base32pad:Ch,base32padupper:Ph,base32hex:Nh,base32hexupper:Uh,base32hexpad:Mh,base32hexpadupper:jh,base32z:$h});const Bh=gr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zh=gr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Hh=Object.freeze({__proto__:null,base36:Bh,base36upper:zh});const Kh=gr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Gh=gr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Vh=Object.freeze({__proto__:null,base58btc:Kh,base58flickr:Gh});const qh=Ze({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wh=Ze({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yh=Ze({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Xh=Ze({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var kh=Object.freeze({__proto__:null,base64:qh,base64pad:Wh,base64url:Yh,base64urlpad:Xh});const Is=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Jh=Is.reduce((e,t,r)=>(e[r]=t,e),[]),Zh=Is.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function Qh(e){return e.reduce((t,r)=>(t+=Jh[r],t),"")}function el(e){const t=[];for(const r of e){const n=Zh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const tl=Br({prefix:"\u{1F680}",name:"base256emoji",encode:Qh,decode:el});var rl=Object.freeze({__proto__:null,base256emoji:tl}),nl=As,Ls=128,il=127,sl=~il,ol=Math.pow(2,31);function As(e,t,r){t=t||[],r=r||0;for(var n=r;e>=ol;)t[r++]=e&255|Ls,e/=128;for(;e&sl;)t[r++]=e&255|Ls,e>>>=7;return t[r]=e|0,As.bytes=r-n+1,t}var al=Nn,ul=128,Cs=127;function Nn(e,n){var r=0,n=n||0,i=0,s=n,u,c=e.length;do{if(s>=c)throw Nn.bytes=0,new RangeError("Could not decode varint");u=e[s++],r+=i<28?(u&Cs)<<i:(u&Cs)*Math.pow(2,i),i+=7}while(u>=ul);return Nn.bytes=s-n,r}var cl=Math.pow(2,7),fl=Math.pow(2,14),hl=Math.pow(2,21),ll=Math.pow(2,28),dl=Math.pow(2,35),_l=Math.pow(2,42),gl=Math.pow(2,49),pl=Math.pow(2,56),yl=Math.pow(2,63),vl=function(e){return e<cl?1:e<fl?2:e<hl?3:e<ll?4:e<dl?5:e<_l?6:e<gl?7:e<pl?8:e<yl?9:10},bl={encode:nl,decode:al,encodingLength:vl},Ps=bl;const Ns=(e,t,r=0)=>(Ps.encode(e,t,r),t),Us=e=>Ps.encodingLength(e),Un=(e,t)=>{const r=t.byteLength,n=Us(e),i=n+Us(r),s=new Uint8Array(i+r);return Ns(e,s,0),Ns(r,s,n),s.set(t,i),new El(e,r,t,s)};class El{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const Ms=({name:e,code:t,encode:r})=>new wl(e,t,r);class wl{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Un(this.code,r):r.then(n=>Un(this.code,n))}else throw Error("Unknown type, must be binary type")}}const js=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ml=Ms({name:"sha2-256",code:18,encode:js("SHA-256")}),Dl=Ms({name:"sha2-512",code:19,encode:js("SHA-512")});var Sl=Object.freeze({__proto__:null,sha256:ml,sha512:Dl});const $s=0,Ol="identity",Fs=Ts;var xl=Object.freeze({__proto__:null,identity:{code:$s,name:Ol,encode:Fs,digest:e=>Un($s,Fs(e))}});new TextEncoder,new TextDecoder;const Bs={...Eh,...mh,...Sh,...xh,...Ih,...Fh,...Hh,...Vh,...kh,...rl};({...Sl,...xl});function zs(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Hs=zs("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Mn=zs("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=xs(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Ks={utf8:Hs,"utf-8":Hs,hex:Bs.base16,latin1:Mn,ascii:Mn,binary:Mn,...Bs};function it(e,t="utf8"){const r=Ks[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function nt(e,t="utf8"){const r=Ks[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function zr(e){return it(nt(Tn(e),eh),Ss)}function Gs(e){const t=nt(oh,Os),r=sh+it(Pn([t,e]),Os);return[nh,ih,r].join(rh)}function Tl(e){return it(e,Ss)}function Rl(e){return nt([zr(e.header),zr(e.payload)].join(Ds),th)}function Il(e){return[zr(e.header),zr(e.payload),Tl(e.signature)].join(Ds)}function Vs(e=Yt.randomBytes(ah)){return Rn.generateKeyPairFromSeed(e)}async function Ll(e,t,r,n,i=De.fromMiliseconds(Date.now())){const s={alg:Zf,typ:Qf},u=Gs(n.publicKey),c=i+r,h={iss:u,sub:e,aud:t,iat:i,exp:c},f=Rl({header:s,payload:h}),l=Rn.sign(n.secretKey,f);return Il({header:s,payload:h,signature:l})}var jn={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});var et=ee,$n=ot,Al=20;function Cl(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,u=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],b=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],T=r[31]<<24|r[30]<<16|r[29]<<8|r[28],U=t[3]<<24|t[2]<<16|t[1]<<8|t[0],P=t[7]<<24|t[6]<<16|t[5]<<8|t[4],K=t[11]<<24|t[10]<<16|t[9]<<8|t[8],S=t[15]<<24|t[14]<<16|t[13]<<8|t[12],R=n,p=i,E=s,y=u,o=c,_=h,j=f,F=l,Y=w,k=b,J=v,L=T,I=U,q=P,$=K,C=S,N=0;N<Al;N+=2)R=R+o|0,I^=R,I=I>>>32-16|I<<16,Y=Y+I|0,o^=Y,o=o>>>32-12|o<<12,p=p+_|0,q^=p,q=q>>>32-16|q<<16,k=k+q|0,_^=k,_=_>>>32-12|_<<12,E=E+j|0,$^=E,$=$>>>32-16|$<<16,J=J+$|0,j^=J,j=j>>>32-12|j<<12,y=y+F|0,C^=y,C=C>>>32-16|C<<16,L=L+C|0,F^=L,F=F>>>32-12|F<<12,E=E+j|0,$^=E,$=$>>>32-8|$<<8,J=J+$|0,j^=J,j=j>>>32-7|j<<7,y=y+F|0,C^=y,C=C>>>32-8|C<<8,L=L+C|0,F^=L,F=F>>>32-7|F<<7,p=p+_|0,q^=p,q=q>>>32-8|q<<8,k=k+q|0,_^=k,_=_>>>32-7|_<<7,R=R+o|0,I^=R,I=I>>>32-8|I<<8,Y=Y+I|0,o^=Y,o=o>>>32-7|o<<7,R=R+_|0,C^=R,C=C>>>32-16|C<<16,J=J+C|0,_^=J,_=_>>>32-12|_<<12,p=p+j|0,I^=p,I=I>>>32-16|I<<16,L=L+I|0,j^=L,j=j>>>32-12|j<<12,E=E+F|0,q^=E,q=q>>>32-16|q<<16,Y=Y+q|0,F^=Y,F=F>>>32-12|F<<12,y=y+o|0,$^=y,$=$>>>32-16|$<<16,k=k+$|0,o^=k,o=o>>>32-12|o<<12,E=E+F|0,q^=E,q=q>>>32-8|q<<8,Y=Y+q|0,F^=Y,F=F>>>32-7|F<<7,y=y+o|0,$^=y,$=$>>>32-8|$<<8,k=k+$|0,o^=k,o=o>>>32-7|o<<7,p=p+j|0,I^=p,I=I>>>32-8|I<<8,L=L+I|0,j^=L,j=j>>>32-7|j<<7,R=R+_|0,C^=R,C=C>>>32-8|C<<8,J=J+C|0,_^=J,_=_>>>32-7|_<<7;et.writeUint32LE(R+n|0,e,0),et.writeUint32LE(p+i|0,e,4),et.writeUint32LE(E+s|0,e,8),et.writeUint32LE(y+u|0,e,12),et.writeUint32LE(o+c|0,e,16),et.writeUint32LE(_+h|0,e,20),et.writeUint32LE(j+f|0,e,24),et.writeUint32LE(F+l|0,e,28),et.writeUint32LE(Y+w|0,e,32),et.writeUint32LE(k+b|0,e,36),et.writeUint32LE(J+v|0,e,40),et.writeUint32LE(L+T|0,e,44),et.writeUint32LE(I+U|0,e,48),et.writeUint32LE(q+P|0,e,52),et.writeUint32LE($+K|0,e,56),et.writeUint32LE(C+S|0,e,60)}function qs(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,u;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),u=s.length-t.length,s.set(t,u)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,u=i}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Cl(c,s,e);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^c[f-h];Nl(s,0,u)}return $n.wipe(c),i===0&&$n.wipe(s),n}Hr.streamXOR=qs;function Pl(e,t,r,n){return n===void 0&&(n=0),$n.wipe(r),qs(e,t,r,r,n)}Hr.stream=Pl;function Nl(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}var Ws={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});function Ul(e,t,r){return~(e-1)&t|e-1&r}Ot.select=Ul;function Ml(e,t){return(e|0)-(t|0)-1>>>31&1}Ot.lessOrEqual=Ml;function Ys(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Ot.compare=Ys;function jl(e,t){return e.length===0||t.length===0?!1:Ys(e,t)!==0}Ot.equal=jl,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Ot,r=ot;e.DIGEST_LENGTH=16;var n=function(){function u(c){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var f=c[2]|c[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var l=c[4]|c[5]<<8;this._r[2]=(f>>>10|l<<6)&7939;var w=c[6]|c[7]<<8;this._r[3]=(l>>>7|w<<9)&8191;var b=c[8]|c[9]<<8;this._r[4]=(w>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var v=c[10]|c[11]<<8;this._r[6]=(b>>>14|v<<2)&8191;var T=c[12]|c[13]<<8;this._r[7]=(v>>>11|T<<5)&8065;var U=c[14]|c[15]<<8;this._r[8]=(T>>>8|U<<8)&8191,this._r[9]=U>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return u.prototype._blocks=function(c,h,f){for(var l=this._fin?0:2048,w=this._h[0],b=this._h[1],v=this._h[2],T=this._h[3],U=this._h[4],P=this._h[5],K=this._h[6],S=this._h[7],R=this._h[8],p=this._h[9],E=this._r[0],y=this._r[1],o=this._r[2],_=this._r[3],j=this._r[4],F=this._r[5],Y=this._r[6],k=this._r[7],J=this._r[8],L=this._r[9];f>=16;){var I=c[h+0]|c[h+1]<<8;w+=I&8191;var q=c[h+2]|c[h+3]<<8;b+=(I>>>13|q<<3)&8191;var $=c[h+4]|c[h+5]<<8;v+=(q>>>10|$<<6)&8191;var C=c[h+6]|c[h+7]<<8;T+=($>>>7|C<<9)&8191;var N=c[h+8]|c[h+9]<<8;U+=(C>>>4|N<<12)&8191,P+=N>>>1&8191;var M=c[h+10]|c[h+11]<<8;K+=(N>>>14|M<<2)&8191;var B=c[h+12]|c[h+13]<<8;S+=(M>>>11|B<<5)&8191;var re=c[h+14]|c[h+15]<<8;R+=(B>>>8|re<<8)&8191,p+=re>>>5|l;var z=0,Z=z;Z+=w*E,Z+=b*(5*L),Z+=v*(5*J),Z+=T*(5*k),Z+=U*(5*Y),z=Z>>>13,Z&=8191,Z+=P*(5*F),Z+=K*(5*j),Z+=S*(5*_),Z+=R*(5*o),Z+=p*(5*y),z+=Z>>>13,Z&=8191;var W=z;W+=w*y,W+=b*E,W+=v*(5*L),W+=T*(5*J),W+=U*(5*k),z=W>>>13,W&=8191,W+=P*(5*Y),W+=K*(5*F),W+=S*(5*j),W+=R*(5*_),W+=p*(5*o),z+=W>>>13,W&=8191;var oe=z;oe+=w*o,oe+=b*y,oe+=v*E,oe+=T*(5*L),oe+=U*(5*J),z=oe>>>13,oe&=8191,oe+=P*(5*k),oe+=K*(5*Y),oe+=S*(5*F),oe+=R*(5*j),oe+=p*(5*_),z+=oe>>>13,oe&=8191;var x=z;x+=w*_,x+=b*o,x+=v*y,x+=T*E,x+=U*(5*L),z=x>>>13,x&=8191,x+=P*(5*J),x+=K*(5*k),x+=S*(5*Y),x+=R*(5*F),x+=p*(5*j),z+=x>>>13,x&=8191;var O=z;O+=w*j,O+=b*_,O+=v*o,O+=T*y,O+=U*E,z=O>>>13,O&=8191,O+=P*(5*L),O+=K*(5*J),O+=S*(5*k),O+=R*(5*Y),O+=p*(5*F),z+=O>>>13,O&=8191;var m=z;m+=w*F,m+=b*j,m+=v*_,m+=T*o,m+=U*y,z=m>>>13,m&=8191,m+=P*E,m+=K*(5*L),m+=S*(5*J),m+=R*(5*k),m+=p*(5*Y),z+=m>>>13,m&=8191;var a=z;a+=w*Y,a+=b*F,a+=v*j,a+=T*_,a+=U*o,z=a>>>13,a&=8191,a+=P*y,a+=K*E,a+=S*(5*L),a+=R*(5*J),a+=p*(5*k),z+=a>>>13,a&=8191;var g=z;g+=w*k,g+=b*Y,g+=v*F,g+=T*j,g+=U*_,z=g>>>13,g&=8191,g+=P*o,g+=K*y,g+=S*E,g+=R*(5*L),g+=p*(5*J),z+=g>>>13,g&=8191;var H=z;H+=w*J,H+=b*k,H+=v*Y,H+=T*F,H+=U*j,z=H>>>13,H&=8191,H+=P*_,H+=K*o,H+=S*y,H+=R*E,H+=p*(5*L),z+=H>>>13,H&=8191;var G=z;G+=w*L,G+=b*J,G+=v*k,G+=T*Y,G+=U*F,z=G>>>13,G&=8191,G+=P*j,G+=K*_,G+=S*o,G+=R*y,G+=p*E,z+=G>>>13,G&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,W+=z,w=Z,b=W,v=oe,T=x,U=O,P=m,K=a,S=g,R=H,p=G,h+=16,f-=16}this._h[0]=w,this._h[1]=b,this._h[2]=v,this._h[3]=T,this._h[4]=U,this._h[5]=P,this._h[6]=K,this._h[7]=S,this._h[8]=R,this._h[9]=p},u.prototype.finish=function(c,h){h===void 0&&(h=0);var f=new Uint16Array(10),l,w,b,v;if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=l,l=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,f[0]=this._h[0]+5,l=f[0]>>>13,f[0]&=8191,v=1;v<10;v++)f[v]=this._h[v]+l,l=f[v]>>>13,f[v]&=8191;for(f[9]-=1<<13,w=(l^1)-1,v=0;v<10;v++)f[v]&=w;for(w=~w,v=0;v<10;v++)this._h[v]=this._h[v]&w|f[v];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,v=1;v<8;v++)b=(this._h[v]+this._pad[v]|0)+(b>>>16)|0,this._h[v]=b&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},u.prototype.update=function(c){var h=0,f=c.length,l;if(this._leftover){l=16-this._leftover,l>f&&(l=f);for(var w=0;w<l;w++)this._buffer[this._leftover+w]=c[h+w];if(f-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(l=f-f%16,this._blocks(c,h,l),h+=l,f-=l),f){for(var w=0;w<f;w++)this._buffer[this._leftover+w]=c[h+w];this._leftover+=f}return this},u.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},u.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},u}();e.Poly1305=n;function i(u,c){var h=new n(u);h.update(c);var f=h.digest();return h.clean(),f}e.oneTimeAuth=i;function s(u,c){return u.length!==e.DIGEST_LENGTH||c.length!==e.DIGEST_LENGTH?!1:t.equal(u,c)}e.equal=s}(Ws),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Hr,r=Ws,n=ot,i=ee,s=Ot;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var u=new Uint8Array(16),c=function(){function h(f){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,f.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,l,w,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(f,v.length-f.length);var T=new Uint8Array(32);t.stream(this._key,v,T,4);var U=l.length+this.tagLength,P;if(b){if(b.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");P=b}else P=new Uint8Array(U);return t.streamXOR(this._key,v,l,P,4),this._authenticate(P.subarray(P.length-this.tagLength,P.length),T,P.subarray(0,P.length-this.tagLength),w),n.wipe(v),P},h.prototype.open=function(f,l,w,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(f,v.length-f.length);var T=new Uint8Array(32);t.stream(this._key,v,T,4);var U=new Uint8Array(this.tagLength);if(this._authenticate(U,T,l.subarray(0,l.length-this.tagLength),w),!s.equal(U,l.subarray(l.length-this.tagLength,l.length)))return null;var P=l.length-this.tagLength,K;if(b){if(b.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");K=b}else K=new Uint8Array(P);return t.streamXOR(this._key,v,l.subarray(0,l.length-this.tagLength),K,4),n.wipe(v),K},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,l,w,b){var v=new r.Poly1305(l);b&&(v.update(b),b.length%16>0&&v.update(u.subarray(b.length%16))),v.update(w),w.length%16>0&&v.update(u.subarray(w.length%16));var T=new Uint8Array(8);b&&i.writeUint64LE(b.length,T),v.update(T),i.writeUint64LE(w.length,T),v.update(T);for(var U=v.digest(),P=0;P<U.length;P++)f[P]=U[P];v.clean(),n.wipe(U),n.wipe(T)},h}();e.ChaCha20Poly1305=c}(jn);var Xs={},pr={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});function $l(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}Fn.isSerializableHash=$l,Object.defineProperty(pr,"__esModule",{value:!0});var pt=Fn,Fl=Ot,Bl=ot,ks=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),pt.isSerializableHash(this._inner)&&pt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Bl.wipe(n)}return e.prototype.reset=function(){if(!pt.isSerializableHash(this._inner)||!pt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){pt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),pt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!pt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!pt.isSerializableHash(this._inner)||!pt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!pt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();pr.HMAC=ks;function zl(e,t,r){var n=new ks(e,t);n.update(r);var i=n.digest();return n.clean(),i}pr.hmac=zl,pr.equal=Fl.equal,Object.defineProperty(Xs,"__esModule",{value:!0});var Js=pr,Zs=ot,Hl=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=Js.hmac(this._hash,n,r);this._hmac=new Js.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),Zs.wipe(this._buffer),Zs.wipe(this._counter),this._bufpos=0},e}(),Kl=Xs.HKDF=Hl,Kr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ee,r=ot;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._temp,this._state,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,b=f<<3,v=f%64<56?64:128;this._buffer[l]=128;for(var T=l+1;T<v-8;T++)this._buffer[T]=0;t.writeUint32BE(w,this._buffer,v-8),t.writeUint32BE(b,this._buffer,v-4),s(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(var T=0;T<this.digestLength/4;T++)t.writeUint32BE(this._state[T],h,T*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,f,l,w){for(;w>=64;){for(var b=h[0],v=h[1],T=h[2],U=h[3],P=h[4],K=h[5],S=h[6],R=h[7],p=0;p<16;p++){var E=l+p*4;c[p]=t.readUint32BE(f,E)}for(var p=16;p<64;p++){var y=c[p-2],o=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=c[p-15];var _=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;c[p]=(o+c[p-7]|0)+(_+c[p-16]|0)}for(var p=0;p<64;p++){var o=(((P>>>6|P<<26)^(P>>>11|P<<21)^(P>>>25|P<<7))+(P&K^~P&S)|0)+(R+(i[p]+c[p]|0)|0)|0,_=((b>>>2|b<<32-2)^(b>>>13|b<<32-13)^(b>>>22|b<<32-22))+(b&v^b&T^v&T)|0;R=S,S=K,K=P,P=U+o|0,U=T,T=v,v=b,b=o+_|0}h[0]+=b,h[1]+=v,h[2]+=T,h[3]+=U,h[4]+=P,h[5]+=K,h[6]+=S,h[7]+=R,l+=64,w-=64}return l}function u(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}e.hash=u})(Kr);var Bn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=Yt,r=ot;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(p){const E=new Float64Array(16);if(p)for(let y=0;y<p.length;y++)E[y]=p[y];return E}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function u(p){let E=1;for(let y=0;y<16;y++){let o=p[y]+E+65535;E=Math.floor(o/65536),p[y]=o-E*65536}p[0]+=E-1+37*(E-1)}function c(p,E,y){const o=~(y-1);for(let _=0;_<16;_++){const j=o&(p[_]^E[_]);p[_]^=j,E[_]^=j}}function h(p,E){const y=n(),o=n();for(let _=0;_<16;_++)o[_]=E[_];u(o),u(o),u(o);for(let _=0;_<2;_++){y[0]=o[0]-65517;for(let F=1;F<15;F++)y[F]=o[F]-65535-(y[F-1]>>16&1),y[F-1]&=65535;y[15]=o[15]-32767-(y[14]>>16&1);const j=y[15]>>16&1;y[14]&=65535,c(o,y,1-j)}for(let _=0;_<16;_++)p[2*_]=o[_]&255,p[2*_+1]=o[_]>>8}function f(p,E){for(let y=0;y<16;y++)p[y]=E[2*y]+(E[2*y+1]<<8);p[15]&=32767}function l(p,E,y){for(let o=0;o<16;o++)p[o]=E[o]+y[o]}function w(p,E,y){for(let o=0;o<16;o++)p[o]=E[o]-y[o]}function b(p,E,y){let o,_,j=0,F=0,Y=0,k=0,J=0,L=0,I=0,q=0,$=0,C=0,N=0,M=0,B=0,re=0,z=0,Z=0,W=0,oe=0,x=0,O=0,m=0,a=0,g=0,H=0,G=0,fe=0,pe=0,le=0,be=0,Me=0,Ce=0,ge=y[0],de=y[1],he=y[2],ue=y[3],ae=y[4],se=y[5],ie=y[6],Q=y[7],ce=y[8],_e=y[9],te=y[10],ye=y[11],ve=y[12],we=y[13],me=y[14],Ee=y[15];o=E[0],j+=o*ge,F+=o*de,Y+=o*he,k+=o*ue,J+=o*ae,L+=o*se,I+=o*ie,q+=o*Q,$+=o*ce,C+=o*_e,N+=o*te,M+=o*ye,B+=o*ve,re+=o*we,z+=o*me,Z+=o*Ee,o=E[1],F+=o*ge,Y+=o*de,k+=o*he,J+=o*ue,L+=o*ae,I+=o*se,q+=o*ie,$+=o*Q,C+=o*ce,N+=o*_e,M+=o*te,B+=o*ye,re+=o*ve,z+=o*we,Z+=o*me,W+=o*Ee,o=E[2],Y+=o*ge,k+=o*de,J+=o*he,L+=o*ue,I+=o*ae,q+=o*se,$+=o*ie,C+=o*Q,N+=o*ce,M+=o*_e,B+=o*te,re+=o*ye,z+=o*ve,Z+=o*we,W+=o*me,oe+=o*Ee,o=E[3],k+=o*ge,J+=o*de,L+=o*he,I+=o*ue,q+=o*ae,$+=o*se,C+=o*ie,N+=o*Q,M+=o*ce,B+=o*_e,re+=o*te,z+=o*ye,Z+=o*ve,W+=o*we,oe+=o*me,x+=o*Ee,o=E[4],J+=o*ge,L+=o*de,I+=o*he,q+=o*ue,$+=o*ae,C+=o*se,N+=o*ie,M+=o*Q,B+=o*ce,re+=o*_e,z+=o*te,Z+=o*ye,W+=o*ve,oe+=o*we,x+=o*me,O+=o*Ee,o=E[5],L+=o*ge,I+=o*de,q+=o*he,$+=o*ue,C+=o*ae,N+=o*se,M+=o*ie,B+=o*Q,re+=o*ce,z+=o*_e,Z+=o*te,W+=o*ye,oe+=o*ve,x+=o*we,O+=o*me,m+=o*Ee,o=E[6],I+=o*ge,q+=o*de,$+=o*he,C+=o*ue,N+=o*ae,M+=o*se,B+=o*ie,re+=o*Q,z+=o*ce,Z+=o*_e,W+=o*te,oe+=o*ye,x+=o*ve,O+=o*we,m+=o*me,a+=o*Ee,o=E[7],q+=o*ge,$+=o*de,C+=o*he,N+=o*ue,M+=o*ae,B+=o*se,re+=o*ie,z+=o*Q,Z+=o*ce,W+=o*_e,oe+=o*te,x+=o*ye,O+=o*ve,m+=o*we,a+=o*me,g+=o*Ee,o=E[8],$+=o*ge,C+=o*de,N+=o*he,M+=o*ue,B+=o*ae,re+=o*se,z+=o*ie,Z+=o*Q,W+=o*ce,oe+=o*_e,x+=o*te,O+=o*ye,m+=o*ve,a+=o*we,g+=o*me,H+=o*Ee,o=E[9],C+=o*ge,N+=o*de,M+=o*he,B+=o*ue,re+=o*ae,z+=o*se,Z+=o*ie,W+=o*Q,oe+=o*ce,x+=o*_e,O+=o*te,m+=o*ye,a+=o*ve,g+=o*we,H+=o*me,G+=o*Ee,o=E[10],N+=o*ge,M+=o*de,B+=o*he,re+=o*ue,z+=o*ae,Z+=o*se,W+=o*ie,oe+=o*Q,x+=o*ce,O+=o*_e,m+=o*te,a+=o*ye,g+=o*ve,H+=o*we,G+=o*me,fe+=o*Ee,o=E[11],M+=o*ge,B+=o*de,re+=o*he,z+=o*ue,Z+=o*ae,W+=o*se,oe+=o*ie,x+=o*Q,O+=o*ce,m+=o*_e,a+=o*te,g+=o*ye,H+=o*ve,G+=o*we,fe+=o*me,pe+=o*Ee,o=E[12],B+=o*ge,re+=o*de,z+=o*he,Z+=o*ue,W+=o*ae,oe+=o*se,x+=o*ie,O+=o*Q,m+=o*ce,a+=o*_e,g+=o*te,H+=o*ye,G+=o*ve,fe+=o*we,pe+=o*me,le+=o*Ee,o=E[13],re+=o*ge,z+=o*de,Z+=o*he,W+=o*ue,oe+=o*ae,x+=o*se,O+=o*ie,m+=o*Q,a+=o*ce,g+=o*_e,H+=o*te,G+=o*ye,fe+=o*ve,pe+=o*we,le+=o*me,be+=o*Ee,o=E[14],z+=o*ge,Z+=o*de,W+=o*he,oe+=o*ue,x+=o*ae,O+=o*se,m+=o*ie,a+=o*Q,g+=o*ce,H+=o*_e,G+=o*te,fe+=o*ye,pe+=o*ve,le+=o*we,be+=o*me,Me+=o*Ee,o=E[15],Z+=o*ge,W+=o*de,oe+=o*he,x+=o*ue,O+=o*ae,m+=o*se,a+=o*ie,g+=o*Q,H+=o*ce,G+=o*_e,fe+=o*te,pe+=o*ye,le+=o*ve,be+=o*we,Me+=o*me,Ce+=o*Ee,j+=38*W,F+=38*oe,Y+=38*x,k+=38*O,J+=38*m,L+=38*a,I+=38*g,q+=38*H,$+=38*G,C+=38*fe,N+=38*pe,M+=38*le,B+=38*be,re+=38*Me,z+=38*Ce,_=1,o=j+_+65535,_=Math.floor(o/65536),j=o-_*65536,o=F+_+65535,_=Math.floor(o/65536),F=o-_*65536,o=Y+_+65535,_=Math.floor(o/65536),Y=o-_*65536,o=k+_+65535,_=Math.floor(o/65536),k=o-_*65536,o=J+_+65535,_=Math.floor(o/65536),J=o-_*65536,o=L+_+65535,_=Math.floor(o/65536),L=o-_*65536,o=I+_+65535,_=Math.floor(o/65536),I=o-_*65536,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=$+_+65535,_=Math.floor(o/65536),$=o-_*65536,o=C+_+65535,_=Math.floor(o/65536),C=o-_*65536,o=N+_+65535,_=Math.floor(o/65536),N=o-_*65536,o=M+_+65535,_=Math.floor(o/65536),M=o-_*65536,o=B+_+65535,_=Math.floor(o/65536),B=o-_*65536,o=re+_+65535,_=Math.floor(o/65536),re=o-_*65536,o=z+_+65535,_=Math.floor(o/65536),z=o-_*65536,o=Z+_+65535,_=Math.floor(o/65536),Z=o-_*65536,j+=_-1+37*(_-1),_=1,o=j+_+65535,_=Math.floor(o/65536),j=o-_*65536,o=F+_+65535,_=Math.floor(o/65536),F=o-_*65536,o=Y+_+65535,_=Math.floor(o/65536),Y=o-_*65536,o=k+_+65535,_=Math.floor(o/65536),k=o-_*65536,o=J+_+65535,_=Math.floor(o/65536),J=o-_*65536,o=L+_+65535,_=Math.floor(o/65536),L=o-_*65536,o=I+_+65535,_=Math.floor(o/65536),I=o-_*65536,o=q+_+65535,_=Math.floor(o/65536),q=o-_*65536,o=$+_+65535,_=Math.floor(o/65536),$=o-_*65536,o=C+_+65535,_=Math.floor(o/65536),C=o-_*65536,o=N+_+65535,_=Math.floor(o/65536),N=o-_*65536,o=M+_+65535,_=Math.floor(o/65536),M=o-_*65536,o=B+_+65535,_=Math.floor(o/65536),B=o-_*65536,o=re+_+65535,_=Math.floor(o/65536),re=o-_*65536,o=z+_+65535,_=Math.floor(o/65536),z=o-_*65536,o=Z+_+65535,_=Math.floor(o/65536),Z=o-_*65536,j+=_-1+37*(_-1),p[0]=j,p[1]=F,p[2]=Y,p[3]=k,p[4]=J,p[5]=L,p[6]=I,p[7]=q,p[8]=$,p[9]=C,p[10]=N,p[11]=M,p[12]=B,p[13]=re,p[14]=z,p[15]=Z}function v(p,E){b(p,E,E)}function T(p,E){const y=n();for(let o=0;o<16;o++)y[o]=E[o];for(let o=253;o>=0;o--)v(y,y),o!==2&&o!==4&&b(y,y,E);for(let o=0;o<16;o++)p[o]=y[o]}function U(p,E){const y=new Uint8Array(32),o=new Float64Array(80),_=n(),j=n(),F=n(),Y=n(),k=n(),J=n();for(let $=0;$<31;$++)y[$]=p[$];y[31]=p[31]&127|64,y[0]&=248,f(o,E);for(let $=0;$<16;$++)j[$]=o[$];_[0]=Y[0]=1;for(let $=254;$>=0;--$){const C=y[$>>>3]>>>($&7)&1;c(_,j,C),c(F,Y,C),l(k,_,F),w(_,_,F),l(F,j,Y),w(j,j,Y),v(Y,k),v(J,_),b(_,F,_),b(F,j,k),l(k,_,F),w(_,_,F),v(j,_),w(F,Y,J),b(_,F,s),l(_,_,Y),b(F,F,_),b(_,Y,J),b(Y,j,o),v(j,k),c(_,j,C),c(F,Y,C)}for(let $=0;$<16;$++)o[$+16]=_[$],o[$+32]=F[$],o[$+48]=j[$],o[$+64]=Y[$];const L=o.subarray(32),I=o.subarray(16);T(L,L),b(I,I,L);const q=new Uint8Array(32);return h(q,I),q}e.scalarMult=U;function P(p){return U(p,i)}e.scalarMultBase=P;function K(p){if(p.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(p);return{publicKey:P(E),secretKey:E}}e.generateKeyPairFromSeed=K;function S(p){const E=(0,t.randomBytes)(32,p),y=K(E);return(0,r.wipe)(E),y}e.generateKeyPair=S;function R(p,E,y=!1){if(p.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=U(p,E);if(y){let _=0;for(let j=0;j<o.length;j++)_|=o[j];if(_===0)throw new Error("X25519: invalid shared key")}return o}e.sharedKey=R})(Bn);var Qs=function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Gl=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),Vl=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),ql=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),Wl=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),Yl=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),Xl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,kl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,eo=3,Jl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Xl]],to=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Zl(e){return e?ro(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Yl:typeof navigator<"u"?ro(navigator.userAgent):td()}function Ql(e){return e!==""&&Jl.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]},!1)}function ro(e){var t=Ql(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new Wl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<eo&&(i=Qs(Qs([],i,!0),rd(eo-i.length),!0)):i=[];var s=i.join("."),u=ed(e),c=kl.exec(e);return c&&c[1]?new ql(r,s,u,c[1]):new Gl(r,s,u)}function ed(e){for(var t=0,r=to.length;t<r;t++){var n=to[t],i=n[0],s=n[1],u=s.exec(e);if(u)return i}return null}function td(){var e=typeof process<"u"&&process.version;return e?new Vl(process.version.slice(1)):null}function rd(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var xe={};Object.defineProperty(xe,"__esModule",{value:!0}),xe.getLocalStorage=xe.getLocalStorageOrThrow=xe.getCrypto=xe.getCryptoOrThrow=io=xe.getLocation=xe.getLocationOrThrow=zn=xe.getNavigator=xe.getNavigatorOrThrow=no=xe.getDocument=xe.getDocumentOrThrow=xe.getFromWindowOrThrow=xe.getFromWindow=void 0;function Mt(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}xe.getFromWindow=Mt;function Xt(e){const t=Mt(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}xe.getFromWindowOrThrow=Xt;function nd(){return Xt("document")}xe.getDocumentOrThrow=nd;function id(){return Mt("document")}var no=xe.getDocument=id;function sd(){return Xt("navigator")}xe.getNavigatorOrThrow=sd;function od(){return Mt("navigator")}var zn=xe.getNavigator=od;function ad(){return Xt("location")}xe.getLocationOrThrow=ad;function ud(){return Mt("location")}var io=xe.getLocation=ud;function cd(){return Xt("crypto")}xe.getCryptoOrThrow=cd;function fd(){return Mt("crypto")}xe.getCrypto=fd;function hd(){return Xt("localStorage")}xe.getLocalStorageOrThrow=hd;function ld(){return Mt("localStorage")}xe.getLocalStorage=ld;var Hn={};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.getWindowMetadata=void 0;const so=xe;function dd(){let e,t;try{e=so.getDocumentOrThrow(),t=so.getLocationOrThrow()}catch{return null}function r(){const w=e.getElementsByTagName("link"),b=[];for(let v=0;v<w.length;v++){const T=w[v],U=T.getAttribute("rel");if(U&&U.toLowerCase().indexOf("icon")>-1){const P=T.getAttribute("href");if(P)if(P.toLowerCase().indexOf("https:")===-1&&P.toLowerCase().indexOf("http:")===-1&&P.indexOf("//")!==0){let K=t.protocol+"//"+t.host;if(P.indexOf("/")===0)K+=P;else{const S=t.pathname.split("/");S.pop();const R=S.join("/");K+=R+"/"+P}b.push(K)}else if(P.indexOf("//")===0){const K=t.protocol+P;b.push(K)}else b.push(P)}}return b}function n(...w){const b=e.getElementsByTagName("meta");for(let v=0;v<b.length;v++){const T=b[v],U=["itemprop","property","name"].map(P=>T.getAttribute(P)).filter(P=>P?w.includes(P):!1);if(U.length&&U){const P=T.getAttribute("content");if(P)return P}}return""}function i(){let w=n("name","og:site_name","og:title","twitter:title");return w||(w=e.title),w}function s(){return n("description","og:description","twitter:description","keywords")}const u=i(),c=s(),h=t.origin,f=r();return{description:c,url:h,icons:f,name:u}}Hn.getWindowMetadata=dd;var yr={},_d=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),oo="%[a-f0-9]{2}",ao=new RegExp(oo,"gi"),uo=new RegExp("("+oo+")+","gi");function Kn(e,t){try{return decodeURIComponent(e.join(""))}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],Kn(r),Kn(n))}function gd(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(ao),r=1;r<t.length;r++)e=Kn(t,r).join(""),t=e.match(ao);return e}}function pd(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=uo.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var n=gd(r[0]);n!==r[0]&&(t[r[0]]=n)}r=uo.exec(e)}t["%C2"]="\uFFFD";for(var i=Object.keys(t),s=0;s<i.length;s++){var u=i[s];e=e.replace(new RegExp(u,"g"),t[u])}return e}var yd=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return pd(e)}},vd=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},bd=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),s=0;s<n.length;s++){var u=n[s],c=e[u];(i?t.indexOf(u)!==-1:t(u,c,e))&&(r[u]=c)}return r};(function(e){const t=_d,r=yd,n=vd,i=bd,s=S=>S==null,u=Symbol("encodeFragmentIdentifier");function c(S){switch(S.arrayFormat){case"index":return R=>(p,E)=>{const y=p.length;return E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,[l(R,S),"[",y,"]"].join("")]:[...p,[l(R,S),"[",l(y,S),"]=",l(E,S)].join("")]};case"bracket":return R=>(p,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,[l(R,S),"[]"].join("")]:[...p,[l(R,S),"[]=",l(E,S)].join("")];case"colon-list-separator":return R=>(p,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,[l(R,S),":list="].join("")]:[...p,[l(R,S),":list=",l(E,S)].join("")];case"comma":case"separator":case"bracket-separator":{const R=S.arrayFormat==="bracket-separator"?"[]=":"=";return p=>(E,y)=>y===void 0||S.skipNull&&y===null||S.skipEmptyString&&y===""?E:(y=y===null?"":y,E.length===0?[[l(p,S),R,l(y,S)].join("")]:[[E,l(y,S)].join(S.arrayFormatSeparator)])}default:return R=>(p,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,l(R,S)]:[...p,[l(R,S),"=",l(E,S)].join("")]}}function h(S){let R;switch(S.arrayFormat){case"index":return(p,E,y)=>{if(R=/\[(\d*)\]$/.exec(p),p=p.replace(/\[\d*\]$/,""),!R){y[p]=E;return}y[p]===void 0&&(y[p]={}),y[p][R[1]]=E};case"bracket":return(p,E,y)=>{if(R=/(\[\])$/.exec(p),p=p.replace(/\[\]$/,""),!R){y[p]=E;return}if(y[p]===void 0){y[p]=[E];return}y[p]=[].concat(y[p],E)};case"colon-list-separator":return(p,E,y)=>{if(R=/(:list)$/.exec(p),p=p.replace(/:list$/,""),!R){y[p]=E;return}if(y[p]===void 0){y[p]=[E];return}y[p]=[].concat(y[p],E)};case"comma":case"separator":return(p,E,y)=>{const o=typeof E=="string"&&E.includes(S.arrayFormatSeparator),_=typeof E=="string"&&!o&&w(E,S).includes(S.arrayFormatSeparator);E=_?w(E,S):E;const j=o||_?E.split(S.arrayFormatSeparator).map(F=>w(F,S)):E===null?E:w(E,S);y[p]=j};case"bracket-separator":return(p,E,y)=>{const o=/(\[\])$/.test(p);if(p=p.replace(/\[\]$/,""),!o){y[p]=E&&w(E,S);return}const _=E===null?[]:E.split(S.arrayFormatSeparator).map(j=>w(j,S));if(y[p]===void 0){y[p]=_;return}y[p]=[].concat(y[p],_)};default:return(p,E,y)=>{if(y[p]===void 0){y[p]=E;return}y[p]=[].concat(y[p],E)}}}function f(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(S,R){return R.encode?R.strict?t(S):encodeURIComponent(S):S}function w(S,R){return R.decode?r(S):S}function b(S){return Array.isArray(S)?S.sort():typeof S=="object"?b(Object.keys(S)).sort((R,p)=>Number(R)-Number(p)).map(R=>S[R]):S}function v(S){const R=S.indexOf("#");return R!==-1&&(S=S.slice(0,R)),S}function T(S){let R="";const p=S.indexOf("#");return p!==-1&&(R=S.slice(p)),R}function U(S){S=v(S);const R=S.indexOf("?");return R===-1?"":S.slice(R+1)}function P(S,R){return R.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):R.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function K(S,R){R=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},R),f(R.arrayFormatSeparator);const p=h(R),E=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return E;for(const y of S.split("&")){if(y==="")continue;let[o,_]=n(R.decode?y.replace(/\+/g," "):y,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(R.arrayFormat)?_:w(_,R),p(w(o,R),_,E)}for(const y of Object.keys(E)){const o=E[y];if(typeof o=="object"&&o!==null)for(const _ of Object.keys(o))o[_]=P(o[_],R);else E[y]=P(o,R)}return R.sort===!1?E:(R.sort===!0?Object.keys(E).sort():Object.keys(E).sort(R.sort)).reduce((y,o)=>{const _=E[o];return Boolean(_)&&typeof _=="object"&&!Array.isArray(_)?y[o]=b(_):y[o]=_,y},Object.create(null))}e.extract=U,e.parse=K,e.stringify=(S,R)=>{if(!S)return"";R=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},R),f(R.arrayFormatSeparator);const p=_=>R.skipNull&&s(S[_])||R.skipEmptyString&&S[_]==="",E=c(R),y={};for(const _ of Object.keys(S))p(_)||(y[_]=S[_]);const o=Object.keys(y);return R.sort!==!1&&o.sort(R.sort),o.map(_=>{const j=S[_];return j===void 0?"":j===null?l(_,R):Array.isArray(j)?j.length===0&&R.arrayFormat==="bracket-separator"?l(_,R)+"[]":j.reduce(E(_),[]).join("&"):l(_,R)+"="+l(j,R)}).filter(_=>_.length>0).join("&")},e.parseUrl=(S,R)=>{R=Object.assign({decode:!0},R);const[p,E]=n(S,"#");return Object.assign({url:p.split("?")[0]||"",query:K(U(S),R)},R&&R.parseFragmentIdentifier&&E?{fragmentIdentifier:w(E,R)}:{})},e.stringifyUrl=(S,R)=>{R=Object.assign({encode:!0,strict:!0,[u]:!0},R);const p=v(S.url).split("?")[0]||"",E=e.extract(S.url),y=e.parse(E,{sort:!1}),o=Object.assign(y,S.query);let _=e.stringify(o,R);_&&(_=`?${_}`);let j=T(S.url);return S.fragmentIdentifier&&(j=`#${R[u]?l(S.fragmentIdentifier,R):S.fragmentIdentifier}`),`${p}${_}${j}`},e.pick=(S,R,p)=>{p=Object.assign({parseFragmentIdentifier:!0,[u]:!1},p);const{url:E,query:y,fragmentIdentifier:o}=e.parseUrl(S,p);return e.stringifyUrl({url:E,query:i(y,R),fragmentIdentifier:o},p)},e.exclude=(S,R,p)=>{const E=Array.isArray(R)?y=>!R.includes(y):(y,o)=>!R(y,o);return e.pick(S,E,p)}})(yr);const Ed={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},co="base10",st="base16",Gn="base64pad",Vn="utf8",fo=0,kt=1,wd=0,ho=1,qn=12,Wn=32;function md(){const e=Bn.generateKeyPair();return{privateKey:it(e.secretKey,st),publicKey:it(e.publicKey,st)}}function Yn(){const e=Yt.randomBytes(Wn);return it(e,st)}function Dd(e,t){const r=Bn.sharedKey(nt(e,st),nt(t,st)),n=new Kl(Kr.SHA256,r).expand(Wn);return it(n,st)}function Sd(e){const t=Kr.hash(nt(e,st));return it(t,st)}function Gr(e){const t=Kr.hash(nt(e,Vn));return it(t,st)}function Od(e){return nt(`${e}`,co)}function vr(e){return Number(it(e,co))}function xd(e){const t=Od(typeof e.type<"u"?e.type:fo);if(vr(t)===kt&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?nt(e.senderPublicKey,st):void 0,n=typeof e.iv<"u"?nt(e.iv,st):Yt.randomBytes(qn),i=new jn.ChaCha20Poly1305(nt(e.symKey,st)).seal(n,nt(e.message,Vn));return Rd({type:t,sealed:i,iv:n,senderPublicKey:r})}function Td(e){const t=new jn.ChaCha20Poly1305(nt(e.symKey,st)),{sealed:r,iv:n}=Xn(e.encoded),i=t.open(n,r);if(i===null)throw new Error("Failed to decrypt");return it(i,Vn)}function Rd(e){if(vr(e.type)===kt){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return it(Pn([e.type,e.senderPublicKey,e.iv,e.sealed]),Gn)}return it(Pn([e.type,e.iv,e.sealed]),Gn)}function Xn(e){const t=nt(e,Gn),r=t.slice(wd,ho),n=ho;if(vr(r)===kt){const c=n+Wn,h=c+qn,f=t.slice(n,c),l=t.slice(c,h),w=t.slice(h);return{type:r,sealed:w,iv:l,senderPublicKey:f}}const i=n+qn,s=t.slice(n,i),u=t.slice(i);return{type:r,sealed:u,iv:s}}function Id(e,t){const r=Xn(e);return lo({type:vr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?it(r.senderPublicKey,st):void 0,receiverPublicKey:t?.receiverPublicKey})}function lo(e){const t=e?.type||fo;if(t===kt){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function _o(e){return e.type===kt&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var Ld=Object.defineProperty,go=Object.getOwnPropertySymbols,Ad=Object.prototype.hasOwnProperty,Cd=Object.prototype.propertyIsEnumerable,po=(e,t,r)=>t in e?Ld(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yo=(e,t)=>{for(var r in t||(t={}))Ad.call(t,r)&&po(e,r,t[r]);if(go)for(var r of go(t))Cd.call(t,r)&&po(e,r,t[r]);return e};const Pd="ReactNative",br={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Nd="js";function vo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ud(){return!no()&&!!zn()&&navigator.product===Pd}function Md(){return!vo()&&!!zn()}function jd(){return Ud()?br.reactNative:vo()?br.node:Md()?br.browser:br.unknown}function $d(e,t){let r=yr.parse(e);return r=yo(yo({},r),t),e=yr.stringify(r),e}function Fd(){const e=Zl();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function Bd(){var e;const t=jd();return t===br.browser?[t,((e=io())==null?void 0:e.host)||"unknown"].join(":"):t}function zd(e,t,r){const n=Fd(),i=Bd();return[[e,t].join("-"),[Nd,r].join("-"),n,i].join("/")}function Hd({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const u=r.split("?"),c=zd(e,t,n),h={auth:i,ua:c,projectId:s},f=$d(u[1]||"",h);return u[0]+"?"+f}function bo(e){return Object.fromEntries(e.entries())}function Eo(e){return new Map(Object.entries(e))}function kn(e,t){return De.fromMiliseconds((t||Date.now())+De.toMiliseconds(e))}function wo(e){return De.fromMiliseconds(Date.now())>=De.toMiliseconds(e)}function Kd(){const e=De.toMiliseconds(De.FIVE_MINUTES);let t,r,n;return{resolve:i=>{n&&t&&(clearTimeout(n),t(i))},reject:i=>{n&&r&&(clearTimeout(n),r(i))},done:()=>new Promise((i,s)=>{n=setTimeout(s,e),t=i,r=s})}}function mo(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Gd(e){return mo("topic",e)}function Vd(e){return mo("id",e)}function qd(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function Jn(e,t){return`${e}${t?`:${t}`:""}`}const Wd="irn";function Zn(e){return e?.relay||{protocol:Wd}}function Qn(e){const t=Ed[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Yd=Object.defineProperty,Do=Object.getOwnPropertySymbols,Xd=Object.prototype.hasOwnProperty,kd=Object.prototype.propertyIsEnumerable,So=(e,t,r)=>t in e?Yd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jd=(e,t)=>{for(var r in t||(t={}))Xd.call(t,r)&&So(e,r,t[r]);if(Do)for(var r of Do(t))kd.call(t,r)&&So(e,r,t[r]);return e};function Zd(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),u=e[i];r[s]=u}}),r}function Qd(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",u=yr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:u.symKey,relay:Zd(u)}}function e_(e,t="-"){const r="relay",n={};return Object.keys(e).forEach(i=>{const s=r+t+i;e[i]&&(n[s]=e[i])}),n}function t_(e){return`${e.protocol}:${e.topic}@${e.version}?`+yr.stringify(Jd({symKey:e.symKey},e_(e.relay)))}const r_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},n_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Te(e,t){const{message:r,code:n}=n_[e];return{message:t?`${r} ${t}`:r,code:n}}function Er(e,t){const{message:r,code:n}=r_[e];return{message:t?`${r} ${t}`:r,code:n}}function Vr(e){return typeof e>"u"}function Oo(e,t){return t&&Vr(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function i_(e){if(Oo(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function s_(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function o_(e){return e?.topic}function ei(e){return typeof e<"u"&&typeof e!==null}const ti="wc",xo=2,qr="core",Et=`${ti}@${2}:${qr}:`,To={name:qr,logger:"error"},Ro={database:":memory:"},Io="crypto",ri="client_ed25519_seed",Lo=De.ONE_DAY,Ao="keychain",Co="0.3",Po="messages",No="0.3",Uo=De.SIX_HOURS,Mo="publisher",jo="irn",$o="error",Fo="wss://relay.walletconnect.com",Bo="relayer",Jt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error"},zo="_subscription",jt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ho=De.ONE_SECOND,a_={database:":memory:"},Ko="2.1.3",Go="0.3",yt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},u_=De.THIRTY_DAYS,Vo="subscription",qo="0.3",Wo=De.FIVE_SECONDS*1e3,Yo="pairing",Xo="0.3",c_=De.THIRTY_DAYS,Zt={wc_pairingDelete:{req:{ttl:De.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:De.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:De.ONE_DAY,prompt:!1,tag:0},res:{ttl:De.ONE_DAY,prompt:!1,tag:0}}},lt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ko="history",Jo="0.3",Zo="expirer",ct={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Qo="0.3",f_=De.ONE_DAY;class ea{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=Ao,this.version=Co,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=Te("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,bo(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Eo(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ta{constructor(t,r,n){this.core=t,this.logger=r,this.name=Io,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Vs(i);return Gs(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=md();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),u=Vs(s),c=Yn();return await Ll(c,i,Lo,u)},this.generateSharedKey=(i,s,u)=>{this.isInitialized();const c=this.getPrivateKey(i),h=Dd(c,s);return this.setSymKey(h,u)},this.setSymKey=async(i,s)=>{this.isInitialized();const u=s||Sd(i);return await this.keychain.set(u,i),u},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,u)=>{this.isInitialized();const c=lo(u),h=Tn(s);if(_o(c)){const b=c.senderPublicKey,v=c.receiverPublicKey;i=await this.generateSharedKey(b,v)}const f=this.getSymKey(i),{type:l,senderPublicKey:w}=c;return xd({type:l,symKey:f,message:h,senderPublicKey:w})},this.decode=async(i,s,u)=>{this.isInitialized();const c=Id(s,u);if(_o(c)){const l=c.receiverPublicKey,w=c.senderPublicKey;i=await this.generateSharedKey(l,w)}const h=this.getSymKey(i),f=Td({symKey:h,encoded:s});return _s(f)},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.keychain=n||new ea(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}getPayloadType(t){const r=Xn(t);return vr(r.type)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(ri)}catch{t=Yn(),await this.keychain.set(ri,t)}return nt(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ra extends gf{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=Po,this.version=No,this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=Gr(i);let u=this.messages.get(n);return typeof u>"u"&&(u={}),typeof u[s]<"u"||(u[s]=i,this.messages.set(n,u),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),u=Gr(i);return typeof s[u]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,bo(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Eo(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}var na=Ni();const h_="PARSE_ERROR",l_="INVALID_REQUEST",d_="METHOD_NOT_FOUND",__="INVALID_PARAMS",ia="INTERNAL_ERROR",ni="SERVER_ERROR",g_=[-32700,-32600,-32601,-32602,-32603],wr={[h_]:{code:-32700,message:"Parse error"},[l_]:{code:-32600,message:"Invalid Request"},[d_]:{code:-32601,message:"Method not found"},[__]:{code:-32602,message:"Invalid params"},[ia]:{code:-32603,message:"Internal error"},[ni]:{code:-32e3,message:"Server error"}},sa=ni;function p_(e){return g_.includes(e)}function oa(e){return Object.keys(wr).includes(e)?wr[e]:wr[sa]}function y_(e){const t=Object.values(wr).find(r=>r.code===e);return t||wr[sa]}function v_(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var aa={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ii=function(e,t){return ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ii(e,t)};function b_(e,t){ii(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var si=function(){return si=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},si.apply(this,arguments)};function E_(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function w_(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(u=e[c])&&(s=(i<3?u(s):i>3?u(t,r,s):u(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function m_(e,t){return function(r,n){t(r,n,e)}}function D_(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function S_(e,t,r,n){function i(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(l){try{f(n.next(l))}catch(w){u(w)}}function h(l){try{f(n.throw(l))}catch(w){u(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function O_(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function x_(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function T_(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function oi(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ua(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],u;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){u={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(u)throw u.error}}return s}function R_(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ua(arguments[t]));return e}function I_(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],u=0,c=s.length;u<c;u++,i++)n[i]=s[u];return n}function mr(e){return this instanceof mr?(this.v=e,this):new mr(e)}function L_(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},u("next"),u("throw"),u("return"),i[Symbol.asyncIterator]=function(){return this},i;function u(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof mr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function A_(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(u){return(r=!r)?{value:mr(e[i](u)),done:i==="return"}:s?s(u):u}:s}}function C_(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof oi=="function"?oi(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(u){return new Promise(function(c,h){u=e[s](u),i(c,h,u.done,u.value)})}}function i(s,u,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},u)}}function P_(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function N_(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function U_(e){return e&&e.__esModule?e:{default:e}}function M_(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function j_(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var $_=Object.freeze({__proto__:null,__extends:b_,get __assign(){return si},__rest:E_,__decorate:w_,__param:m_,__metadata:D_,__awaiter:S_,__generator:O_,__createBinding:x_,__exportStar:T_,__values:oi,__read:ua,__spread:R_,__spreadArrays:I_,__await:mr,__asyncGenerator:L_,__asyncDelegator:A_,__asyncValues:C_,__makeTemplateObject:P_,__importStar:N_,__importDefault:U_,__classPrivateFieldGet:M_,__classPrivateFieldSet:j_}),F_=Lt($_),wt={},ca;function B_(){if(ca)return wt;ca=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.isBrowserCryptoAvailable=wt.getSubtleCrypto=wt.getBrowerCrypto=void 0;function e(){return Je?.crypto||Je?.msCrypto||{}}wt.getBrowerCrypto=e;function t(){const n=e();return n.subtle||n.webkitSubtle}wt.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return wt.isBrowserCryptoAvailable=r,wt}var mt={},fa;function z_(){if(fa)return mt;fa=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.isBrowser=mt.isNode=mt.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}mt.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}mt.isNode=t;function r(){return!e()&&!t()}return mt.isBrowser=r,mt}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=F_;t.__exportStar(B_(),e),t.__exportStar(z_(),e)})(aa);function H_(){const e=Date.now()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t}function ai(e,t,r){return{id:r||H_(),jsonrpc:"2.0",method:e,params:t}}function ha(e,t){return{id:e,jsonrpc:"2.0",result:t}}function la(e,t,r){return{id:e,jsonrpc:"2.0",error:K_(t,r)}}function K_(e,t){return typeof e>"u"?oa(ia):(typeof e=="string"&&(e=Object.assign(Object.assign({},oa(ni)),{message:e})),typeof t<"u"&&(e.data=t),p_(e.code)&&(e=y_(e.code)),e)}class G_{}class V_ extends G_{constructor(){super()}}class q_ extends V_{constructor(t){super()}}const W_="^wss?:";function Y_(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function X_(e,t){const r=Y_(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function da(e){return X_(e,W_)}function k_(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function _a(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function ga(e){return _a(e)&&"method"in e}function pa(e){return _a(e)&&(ya(e)||Wr(e))}function ya(e){return"result"in e}function Wr(e){return"error"in e}class J_ extends q_{constructor(t){super(t),this.events=new na.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(ai(t.method,t.params||[]),r)}async requestStrict(t,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{Wr(s)?i(s.error):n(s.result)});try{await this.connection.send(t,r)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),pa(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",t=>this.events.emit("error",t)),this.hasRegisteredEventListeners=!0)}}const va=10,Z_=(()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"))();class Q_{constructor(t){if(this.url=t,this.events=new na.EventEmitter,this.registering=!1,!da(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Tn(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!da(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const i=aa.isReactNative()?void 0:{rejectUnauthorized:!k_(t)},s=new Z_(t,[],i);s.onopen=()=>{this.onOpen(s),r(s)},s.onerror=u=>{const c=u,h=this.parseError(c.error||new Error(`WebSocket connection failed for URL: ${t}`));this.events.emit("register_error",h),this.onClose(),n(h)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=()=>this.onClose(),t.onerror=r=>{const n=r,i=this.parseError(n.error||new Error(`WebSocket connection failed for URL: ${this.url}`));this.events.emit("error",i)},this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?_s(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),i=n.message||n.toString(),s=la(t,i);this.events.emit("payload",s)}parseError(t,r=this.url){return v_(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>va&&this.events.setMaxListeners(va)}}class e0 extends pf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new bt.exports.EventEmitter,this.name=Mo,this.queue=new Map,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const u=s?.ttl||Uo,c=Zn(s),h=s?.prompt||!1,f=s?.tag||0,l={topic:n,message:i,opts:{ttl:u,relay:c,prompt:h,tag:f}},w=Gr(i);this.queue.set(w,l),await this.rpcPublish(n,i,u,c,h,f),this.onPublish(w,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(u){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(u),u}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,r,n,i,s,u){var c,h,f,l;const w={method:Qn(i.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:s,tag:u}};return Vr((c=w.params)==null?void 0:c.prompt)&&((h=w.params)==null||delete h.prompt),Vr((f=w.params)==null?void 0:f.tag)&&((l=w.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.provider.request(w)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:{ttl:i,relay:s,prompt:u,tag:c}}=t,h=Gr(n);await this.rpcPublish(r,n,i,s,u,c),this.onPublish(h,t)})}registerEventListeners(){this.relayer.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class t0{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(t);return}this.map.set(t,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var r0=Object.defineProperty,n0=Object.defineProperties,i0=Object.getOwnPropertyDescriptors,ba=Object.getOwnPropertySymbols,s0=Object.prototype.hasOwnProperty,o0=Object.prototype.propertyIsEnumerable,Ea=(e,t,r)=>t in e?r0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Yr=(e,t)=>{for(var r in t||(t={}))s0.call(t,r)&&Ea(e,r,t[r]);if(ba)for(var r of ba(t))o0.call(t,r)&&Ea(e,r,t[r]);return e},ui=(e,t)=>n0(e,i0(t));class wa extends bf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new t0,this.events=new bt.exports.EventEmitter,this.name=Vo,this.version=qo,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Zn(i),u={topic:n,relay:s};this.pending.set(n,u);const c=await this.rpcSubscribe(n,s);return this.onSubscribe(c,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const u=new De.Watch;u.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(c),u.stop(this.pendingSubscriptionWatchLabel),i(!0)),u.elapsed(this.pendingSubscriptionWatchLabel)>=Wo&&(clearInterval(c),u.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async i=>await this.unsubscribeById(t,i,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const i=Zn(n);await this.rpcUnsubscribe(t,r,i);const s=Er("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,r){const n={method:Qn(r.protocol).subscribe,params:{topic:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),await this.relayer.provider.request(n)}rpcUnsubscribe(t,r,n){const i={method:Qn(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(t,r){this.setSubscription(t,ui(Yr({},r),{id:t})),this.pending.delete(r.topic)}onResubscribe(t,r){this.addSubscription(t,ui(Yr({},r),{id:t})),this.pending.delete(r.topic)}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Yr({},r)),this.topicMap.set(r.topic,t),this.events.emit(yt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=Te("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(yt.deleted,ui(Yr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(yt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async t=>await this.resubscribe(t))),this.events.emit(yt.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async resubscribe(t){if(!this.ids.includes(t.id)){const{topic:r,relay:n}=t,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async t=>{const r=await this.rpcSubscribe(t.topic,t.relay);this.onSubscribe(r,t)})}registerEventListeners(){this.relayer.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.provider.on(jt.connect,async()=>{await this.onConnect()}),this.relayer.provider.on(jt.disconnect,()=>{this.onDisconnect()}),this.events.on(yt.created,async t=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(yt.deleted,async t=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}var a0=Object.defineProperty,ma=Object.getOwnPropertySymbols,u0=Object.prototype.hasOwnProperty,c0=Object.prototype.propertyIsEnumerable,Da=(e,t,r)=>t in e?a0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f0=(e,t)=>{for(var r in t||(t={}))u0.call(t,r)&&Da(e,r,t[r]);if(ma)for(var r of ma(t))c0.call(t,r)&&Da(e,r,t[r]);return e};class Sa extends yf{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new bt.exports.EventEmitter,this.name=Bo,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):nn(Re.getDefaultLoggerOptions({level:t.logger||$o})),this.messages=new ra(this.logger,t.core),this.subscriber=new wa(this,this.logger),this.publisher=new e0(this,this.logger),this.relayUrl=t?.relayUrl||Fo,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.provider.connect(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r})}async subscribe(t,r){return this.isInitialized(),await this.subscriber.subscribe(t,r)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,await this.provider.disconnect()}async transportOpen(t){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1,await this.provider.connect(),await new Promise(r=>{this.subscriber.once(yt.resubscribed,()=>{r()})})}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new J_(new Q_(Hd({sdkVersion:Ko,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),ga(t)){if(!t.method.endsWith(zo))return;const r=t.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(f0({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(t),await this.onMessageEvent(s)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=ha(t.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(jt.payload,t=>this.onProviderPayload(t)),this.provider.on(jt.connect,()=>{this.events.emit(Jt.connect)}),this.provider.on(jt.disconnect,()=>{this.events.emit(Jt.disconnect),this.attemptToReconnect()}),this.provider.on(jt.error,t=>this.events.emit(Jt.error,t))}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(()=>{this.provider.connect()},De.toMiliseconds(Ho))}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}var ci={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,s=2,u=9007199254740991,c="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",w="[object Date]",b="[object Error]",v="[object Function]",T="[object GeneratorFunction]",U="[object Map]",P="[object Number]",K="[object Null]",S="[object Object]",R="[object Promise]",p="[object Proxy]",E="[object RegExp]",y="[object Set]",o="[object String]",_="[object Symbol]",j="[object Undefined]",F="[object WeakMap]",Y="[object ArrayBuffer]",k="[object DataView]",J="[object Float32Array]",L="[object Float64Array]",I="[object Int8Array]",q="[object Int16Array]",$="[object Int32Array]",C="[object Uint8Array]",N="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,W={};W[J]=W[L]=W[I]=W[q]=W[$]=W[C]=W[N]=W[M]=W[B]=!0,W[c]=W[h]=W[Y]=W[l]=W[k]=W[w]=W[b]=W[v]=W[U]=W[P]=W[S]=W[E]=W[y]=W[o]=W[F]=!1;var oe=typeof Je=="object"&&Je&&Je.Object===Object&&Je,x=typeof self=="object"&&self&&self.Object===Object&&self,O=oe||x||Function("return this")(),m=t&&!t.nodeType&&t,a=m&&!0&&e&&!e.nodeType&&e,g=a&&a.exports===m,H=g&&oe.process,G=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),fe=G&&G.isTypedArray;function pe(d,D){for(var A=-1,V=d==null?0:d.length,Ie=0,ne=[];++A<V;){var Ue=d[A];D(Ue,A,d)&&(ne[Ie++]=Ue)}return ne}function le(d,D){for(var A=-1,V=D.length,Ie=d.length;++A<V;)d[Ie+A]=D[A];return d}function be(d,D){for(var A=-1,V=d==null?0:d.length;++A<V;)if(D(d[A],A,d))return!0;return!1}function Me(d,D){for(var A=-1,V=Array(d);++A<d;)V[A]=D(A);return V}function Ce(d){return function(D){return d(D)}}function ge(d,D){return d.has(D)}function de(d,D){return d?.[D]}function he(d){var D=-1,A=Array(d.size);return d.forEach(function(V,Ie){A[++D]=[Ie,V]}),A}function ue(d,D){return function(A){return d(D(A))}}function ae(d){var D=-1,A=Array(d.size);return d.forEach(function(V){A[++D]=V}),A}var se=Array.prototype,ie=Function.prototype,Q=Object.prototype,ce=O["__core-js_shared__"],_e=ie.toString,te=Q.hasOwnProperty,ye=function(){var d=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),ve=Q.toString,we=RegExp("^"+_e.call(te).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),me=g?O.Buffer:void 0,Ee=O.Symbol,dt=O.Uint8Array,vt=Q.propertyIsEnumerable,xt=se.splice,at=Ee?Ee.toStringTag:void 0,$t=Object.getOwnPropertySymbols,Dr=me?me.isBuffer:void 0,kr=ue(Object.keys,Object),je=Qt(O,"DataView"),Pe=Qt(O,"Map"),$e=Qt(O,"Promise"),Fe=Qt(O,"Set"),Be=Qt(O,"WeakMap"),Ne=Qt(Object,"create"),Ke=Bt(je),Ge=Bt(Pe),Ve=Bt($e),qe=Bt(Fe),We=Bt(Be),He=Ee?Ee.prototype:void 0,ze=He?He.valueOf:void 0;function Le(d){var D=-1,A=d==null?0:d.length;for(this.clear();++D<A;){var V=d[D];this.set(V[0],V[1])}}function Ye(){this.__data__=Ne?Ne(null):{},this.size=0}function Xe(d){var D=this.has(d)&&delete this.__data__[d];return this.size-=D?1:0,D}function b0(d){var D=this.__data__;if(Ne){var A=D[d];return A===n?void 0:A}return te.call(D,d)?D[d]:void 0}function E0(d){var D=this.__data__;return Ne?D[d]!==void 0:te.call(D,d)}function w0(d,D){var A=this.__data__;return this.size+=this.has(d)?0:1,A[d]=Ne&&D===void 0?n:D,this}Le.prototype.clear=Ye,Le.prototype.delete=Xe,Le.prototype.get=b0,Le.prototype.has=E0,Le.prototype.set=w0;function Dt(d){var D=-1,A=d==null?0:d.length;for(this.clear();++D<A;){var V=d[D];this.set(V[0],V[1])}}function m0(){this.__data__=[],this.size=0}function D0(d){var D=this.__data__,A=Zr(D,d);if(A<0)return!1;var V=D.length-1;return A==V?D.pop():xt.call(D,A,1),--this.size,!0}function S0(d){var D=this.__data__,A=Zr(D,d);return A<0?void 0:D[A][1]}function O0(d){return Zr(this.__data__,d)>-1}function x0(d,D){var A=this.__data__,V=Zr(A,d);return V<0?(++this.size,A.push([d,D])):A[V][1]=D,this}Dt.prototype.clear=m0,Dt.prototype.delete=D0,Dt.prototype.get=S0,Dt.prototype.has=O0,Dt.prototype.set=x0;function Ft(d){var D=-1,A=d==null?0:d.length;for(this.clear();++D<A;){var V=d[D];this.set(V[0],V[1])}}function T0(){this.size=0,this.__data__={hash:new Le,map:new(Pe||Dt),string:new Le}}function R0(d){var D=Qr(this,d).delete(d);return this.size-=D?1:0,D}function I0(d){return Qr(this,d).get(d)}function L0(d){return Qr(this,d).has(d)}function A0(d,D){var A=Qr(this,d),V=A.size;return A.set(d,D),this.size+=A.size==V?0:1,this}Ft.prototype.clear=T0,Ft.prototype.delete=R0,Ft.prototype.get=I0,Ft.prototype.has=L0,Ft.prototype.set=A0;function Jr(d){var D=-1,A=d==null?0:d.length;for(this.__data__=new Ft;++D<A;)this.add(d[D])}function C0(d){return this.__data__.set(d,n),this}function P0(d){return this.__data__.has(d)}Jr.prototype.add=Jr.prototype.push=C0,Jr.prototype.has=P0;function Tt(d){var D=this.__data__=new Dt(d);this.size=D.size}function N0(){this.__data__=new Dt,this.size=0}function U0(d){var D=this.__data__,A=D.delete(d);return this.size=D.size,A}function M0(d){return this.__data__.get(d)}function j0(d){return this.__data__.has(d)}function $0(d,D){var A=this.__data__;if(A instanceof Dt){var V=A.__data__;if(!Pe||V.length<r-1)return V.push([d,D]),this.size=++A.size,this;A=this.__data__=new Ft(V)}return A.set(d,D),this.size=A.size,this}Tt.prototype.clear=N0,Tt.prototype.delete=U0,Tt.prototype.get=M0,Tt.prototype.has=j0,Tt.prototype.set=$0;function F0(d,D){var A=en(d),V=!A&&eg(d),Ie=!A&&!V&&fi(d),ne=!A&&!V&&!Ie&&Ka(d),Ue=A||V||Ie||ne,ke=Ue?Me(d.length,String):[],Qe=ke.length;for(var Ae in d)(D||te.call(d,Ae))&&!(Ue&&(Ae=="length"||Ie&&(Ae=="offset"||Ae=="parent")||ne&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||X0(Ae,Qe)))&&ke.push(Ae);return ke}function Zr(d,D){for(var A=d.length;A--;)if(Fa(d[A][0],D))return A;return-1}function B0(d,D,A){var V=D(d);return en(d)?V:le(V,A(d))}function Sr(d){return d==null?d===void 0?j:K:at&&at in Object(d)?W0(d):Q0(d)}function Ua(d){return Or(d)&&Sr(d)==c}function Ma(d,D,A,V,Ie){return d===D?!0:d==null||D==null||!Or(d)&&!Or(D)?d!==d&&D!==D:z0(d,D,A,V,Ma,Ie)}function z0(d,D,A,V,Ie,ne){var Ue=en(d),ke=en(D),Qe=Ue?h:Rt(d),Ae=ke?h:Rt(D);Qe=Qe==c?S:Qe,Ae=Ae==c?S:Ae;var ut=Qe==S,_t=Ae==S,tt=Qe==Ae;if(tt&&fi(d)){if(!fi(D))return!1;Ue=!0,ut=!1}if(tt&&!ut)return ne||(ne=new Tt),Ue||Ka(d)?ja(d,D,A,V,Ie,ne):V0(d,D,Qe,A,V,Ie,ne);if(!(A&i)){var ft=ut&&te.call(d,"__wrapped__"),ht=_t&&te.call(D,"__wrapped__");if(ft||ht){var It=ft?d.value():d,St=ht?D.value():D;return ne||(ne=new Tt),Ie(It,St,A,V,ne)}}return tt?(ne||(ne=new Tt),q0(d,D,A,V,Ie,ne)):!1}function H0(d){if(!Ha(d)||J0(d))return!1;var D=Ba(d)?we:z;return D.test(Bt(d))}function K0(d){return Or(d)&&za(d.length)&&!!W[Sr(d)]}function G0(d){if(!Z0(d))return kr(d);var D=[];for(var A in Object(d))te.call(d,A)&&A!="constructor"&&D.push(A);return D}function ja(d,D,A,V,Ie,ne){var Ue=A&i,ke=d.length,Qe=D.length;if(ke!=Qe&&!(Ue&&Qe>ke))return!1;var Ae=ne.get(d);if(Ae&&ne.get(D))return Ae==D;var ut=-1,_t=!0,tt=A&s?new Jr:void 0;for(ne.set(d,D),ne.set(D,d);++ut<ke;){var ft=d[ut],ht=D[ut];if(V)var It=Ue?V(ht,ft,ut,D,d,ne):V(ft,ht,ut,d,D,ne);if(It!==void 0){if(It)continue;_t=!1;break}if(tt){if(!be(D,function(St,zt){if(!ge(tt,zt)&&(ft===St||Ie(ft,St,A,V,ne)))return tt.push(zt)})){_t=!1;break}}else if(!(ft===ht||Ie(ft,ht,A,V,ne))){_t=!1;break}}return ne.delete(d),ne.delete(D),_t}function V0(d,D,A,V,Ie,ne,Ue){switch(A){case k:if(d.byteLength!=D.byteLength||d.byteOffset!=D.byteOffset)return!1;d=d.buffer,D=D.buffer;case Y:return!(d.byteLength!=D.byteLength||!ne(new dt(d),new dt(D)));case l:case w:case P:return Fa(+d,+D);case b:return d.name==D.name&&d.message==D.message;case E:case o:return d==D+"";case U:var ke=he;case y:var Qe=V&i;if(ke||(ke=ae),d.size!=D.size&&!Qe)return!1;var Ae=Ue.get(d);if(Ae)return Ae==D;V|=s,Ue.set(d,D);var ut=ja(ke(d),ke(D),V,Ie,ne,Ue);return Ue.delete(d),ut;case _:if(ze)return ze.call(d)==ze.call(D)}return!1}function q0(d,D,A,V,Ie,ne){var Ue=A&i,ke=$a(d),Qe=ke.length,Ae=$a(D),ut=Ae.length;if(Qe!=ut&&!Ue)return!1;for(var _t=Qe;_t--;){var tt=ke[_t];if(!(Ue?tt in D:te.call(D,tt)))return!1}var ft=ne.get(d);if(ft&&ne.get(D))return ft==D;var ht=!0;ne.set(d,D),ne.set(D,d);for(var It=Ue;++_t<Qe;){tt=ke[_t];var St=d[tt],zt=D[tt];if(V)var Ga=Ue?V(zt,St,tt,D,d,ne):V(St,zt,tt,d,D,ne);if(!(Ga===void 0?St===zt||Ie(St,zt,A,V,ne):Ga)){ht=!1;break}It||(It=tt=="constructor")}if(ht&&!It){var tn=d.constructor,rn=D.constructor;tn!=rn&&"constructor"in d&&"constructor"in D&&!(typeof tn=="function"&&tn instanceof tn&&typeof rn=="function"&&rn instanceof rn)&&(ht=!1)}return ne.delete(d),ne.delete(D),ht}function $a(d){return B0(d,ng,Y0)}function Qr(d,D){var A=d.__data__;return k0(D)?A[typeof D=="string"?"string":"hash"]:A.map}function Qt(d,D){var A=de(d,D);return H0(A)?A:void 0}function W0(d){var D=te.call(d,at),A=d[at];try{d[at]=void 0;var V=!0}catch{}var Ie=ve.call(d);return V&&(D?d[at]=A:delete d[at]),Ie}var Y0=$t?function(d){return d==null?[]:(d=Object(d),pe($t(d),function(D){return vt.call(d,D)}))}:ig,Rt=Sr;(je&&Rt(new je(new ArrayBuffer(1)))!=k||Pe&&Rt(new Pe)!=U||$e&&Rt($e.resolve())!=R||Fe&&Rt(new Fe)!=y||Be&&Rt(new Be)!=F)&&(Rt=function(d){var D=Sr(d),A=D==S?d.constructor:void 0,V=A?Bt(A):"";if(V)switch(V){case Ke:return k;case Ge:return U;case Ve:return R;case qe:return y;case We:return F}return D});function X0(d,D){return D=D??u,!!D&&(typeof d=="number"||Z.test(d))&&d>-1&&d%1==0&&d<D}function k0(d){var D=typeof d;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?d!=="__proto__":d===null}function J0(d){return!!ye&&ye in d}function Z0(d){var D=d&&d.constructor,A=typeof D=="function"&&D.prototype||Q;return d===A}function Q0(d){return ve.call(d)}function Bt(d){if(d!=null){try{return _e.call(d)}catch{}try{return d+""}catch{}}return""}function Fa(d,D){return d===D||d!==d&&D!==D}var eg=Ua(function(){return arguments}())?Ua:function(d){return Or(d)&&te.call(d,"callee")&&!vt.call(d,"callee")},en=Array.isArray;function tg(d){return d!=null&&za(d.length)&&!Ba(d)}var fi=Dr||sg;function rg(d,D){return Ma(d,D)}function Ba(d){if(!Ha(d))return!1;var D=Sr(d);return D==v||D==T||D==f||D==p}function za(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=u}function Ha(d){var D=typeof d;return d!=null&&(D=="object"||D=="function")}function Or(d){return d!=null&&typeof d=="object"}var Ka=fe?Ce(fe):K0;function ng(d){return tg(d)?F0(d):G0(d)}function ig(){return[]}function sg(){return!1}e.exports=rg})(ci,ci.exports);var h0=ci.exports,l0=Object.defineProperty,Oa=Object.getOwnPropertySymbols,d0=Object.prototype.hasOwnProperty,_0=Object.prototype.propertyIsEnumerable,xa=(e,t,r)=>t in e?l0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ta=(e,t)=>{for(var r in t||(t={}))d0.call(t,r)&&xa(e,r,t[r]);if(Oa)for(var r of Oa(t))_0.call(t,r)&&xa(e,r,t[r]);return e};class Ra extends vf{constructor(t,r,n,i=Et,s=void 0){super(t,r,n,i),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=Go,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(u=>{s_(u)?this.map.set(u.id,u):o_(u)?this.map.set(u.topic,u):this.getKey&&u!==null&&!Vr(u)&&this.map.set(this.getKey(u),u)}),this.cached=[],this.initialized=!0)},this.set=async(u,c)=>{this.isInitialized(),this.map.has(u)?await this.update(u,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:u,value:c}),this.map.set(u,c),await this.persist())},this.get=u=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:u}),this.getData(u)),this.getAll=u=>(this.isInitialized(),u?this.values.filter(c=>Object.keys(u).every(h=>h0(c[h],u[h]))):this.values),this.update=async(u,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:u,update:c});const h=Ta(Ta({},this.getData(u)),c);this.map.set(u,h),await this.persist()},this.delete=async(u,c)=>{this.isInitialized(),this.map.has(u)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:u,reason:c}),this.map.delete(u),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=Te("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ia{constructor(t,r){this.core=t,this.logger=r,this.name=Yo,this.version=Xo,this.events=new bt.exports,this.initialized=!1,this.storagePrefix=Et,this.ignoredPayloadTypes=[kt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Yn(),i=await this.core.crypto.setSymKey(n),s=kn(De.FIVE_MINUTES),u={protocol:jo},c={topic:i,expiry:s,relay:u,active:!1},h=t_({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:u});return await this.pairings.set(i,c),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:u}=Qd(n.uri),c=kn(De.FIVE_MINUTES),h={topic:i,relay:u,expiry:c,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:u}),this.core.expirer.set(i,c),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=kn(De.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:u,resolve:c,reject:h}=Kd();this.events.once(Jn("pairing_ping",s),({error:f})=>{f?h(f):c()}),await u()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Er("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const u=ai(i,s),c=await this.core.crypto.encode(n,u),h=Zt[i].req;return this.core.history.set(n,u),await this.core.relayer.publish(n,c,h),u.id},this.sendResult=async(n,i,s)=>{const u=ha(n,s),c=await this.core.crypto.encode(i,u),h=await this.core.history.get(i,n),f=Zt[h.request.method].res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(u)},this.sendError=async(n,i,s)=>{const u=la(n,s),c=await this.core.crypto.encode(i,u),h=await this.core.history.get(i,n),f=Zt[h.request.method]?Zt[h.request.method].res:Zt.unregistered_method.res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(u)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>wo(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,u=(await this.core.history.get(i,s.id)).request.method;switch(u){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(u)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{ya(i)?this.events.emit(Jn("pairing_ping",s),{}):Wr(i)&&this.events.emit(Jn("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:u}=i;try{if(this.registeredMethods.includes(u))return;const c=Er("WC_METHOD_UNSUPPORTED",u);await this.sendError(s,n,c),this.logger.error(c)}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Er("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ei(n)){const{message:i}=Te("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!i_(n.uri)){const{message:i}=Te("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!ei(n)){const{message:s}=Te("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!ei(n)){const{message:s}=Te("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!Oo(n,!1)){const{message:i}=Te("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=Te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(wo(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=Te("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new Ra(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);ga(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):pa(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(ct.expired,async t=>{const{topic:r}=qd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class La extends _f{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new bt.exports.EventEmitter,this.name=ko,this.version=Jo,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const u={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(u.id,u),this.events.emit(lt.created,u)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Wr(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(lt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(lt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ai(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=Te("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(lt.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(lt.created,t=>{const r=lt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(lt.updated,t=>{const r=lt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(lt.deleted,t=>{const r=lt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Aa extends Ef{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new bt.exports.EventEmitter,this.name=Zo,this.version=Qo,this.cached=[],this.initialized=!1,this.storagePrefix=Et,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),u={target:s,expiry:i};this.expirations.set(s,u),this.checkExpiry(s,u),this.events.emit(ct.created,{target:s,expiration:u})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{this.isInitialized();const i=this.formatTarget(n);if(this.has(i)){const s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(ct.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Gd(t);if(typeof t=="number")return Vd(t);const{message:r}=Te("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ct.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=Te("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;De.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(ct.expired,{target:t,expiration:r})}checkExpirations(){this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ar.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ct.created,t=>{const r=ct.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(ct.expired,t=>{const r=ct.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(ct.deleted,t=>{const r=ct.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Te("NOT_INITIALIZED",this.name);throw new Error(t)}}}var g0=Object.defineProperty,Ca=Object.getOwnPropertySymbols,p0=Object.prototype.hasOwnProperty,y0=Object.prototype.propertyIsEnumerable,Pa=(e,t,r)=>t in e?g0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Na=(e,t)=>{for(var r in t||(t={}))p0.call(t,r)&&Pa(e,r,t[r]);if(Ca)for(var r of Ca(t))y0.call(t,r)&&Pa(e,r,t[r]);return e};class Xr extends df{constructor(t){super(t),this.protocol=ti,this.version=xo,this.name=qr,this.events=new bt.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=t?.projectId;const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:nn(Re.getDefaultLoggerOptions({level:t?.logger||To.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new ar.HeartBeat,this.crypto=new ta(this,this.logger,t?.keychain),this.history=new La(this,this.logger),this.expirer=new Aa(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new $u(Na(Na({},Ro),t?.storageOptions)),this.relayer=new Sa({core:this,logger:this.logger,relayUrl:t?.relayUrl,projectId:this.projectId}),this.pairing=new Ia(this,this.logger)}static async init(t){const r=new Xr(t);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(t){throw this.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const v0=Xr;X.CORE_CONTEXT=qr,X.CORE_DEFAULT=To,X.CORE_PROTOCOL=ti,X.CORE_STORAGE_OPTIONS=Ro,X.CORE_STORAGE_PREFIX=Et,X.CORE_VERSION=xo,X.CRYPTO_CLIENT_SEED=ri,X.CRYPTO_CONTEXT=Io,X.CRYPTO_JWT_TTL=Lo,X.Core=v0,X.Crypto=ta,X.EXPIRER_CONTEXT=Zo,X.EXPIRER_DEFAULT_TTL=f_,X.EXPIRER_EVENTS=ct,X.EXPIRER_STORAGE_VERSION=Qo,X.Expirer=Aa,X.HISTORY_CONTEXT=ko,X.HISTORY_EVENTS=lt,X.HISTORY_STORAGE_VERSION=Jo,X.JsonRpcHistory=La,X.KEYCHAIN_CONTEXT=Ao,X.KEYCHAIN_STORAGE_VERSION=Co,X.KeyChain=ea,X.MESSAGES_CONTEXT=Po,X.MESSAGES_STORAGE_VERSION=No,X.MessageTracker=ra,X.PAIRING_CONTEXT=Yo,X.PAIRING_DEFAULT_TTL=c_,X.PAIRING_RPC_OPTS=Zt,X.PAIRING_STORAGE_VERSION=Xo,X.PENDING_SUB_RESOLUTION_TIMEOUT=Wo,X.PUBLISHER_CONTEXT=Mo,X.PUBLISHER_DEFAULT_TTL=Uo,X.Pairing=Ia,X.RELAYER_CONTEXT=Bo,X.RELAYER_DEFAULT_LOGGER=$o,X.RELAYER_DEFAULT_PROTOCOL=jo,X.RELAYER_DEFAULT_RELAY_URL=Fo,X.RELAYER_EVENTS=Jt,X.RELAYER_PROVIDER_EVENTS=jt,X.RELAYER_RECONNECT_TIMEOUT=Ho,X.RELAYER_SDK_VERSION=Ko,X.RELAYER_STORAGE_OPTIONS=a_,X.RELAYER_SUBSCRIBER_SUFFIX=zo,X.Relayer=Sa,X.STORE_STORAGE_VERSION=Go,X.SUBSCRIBER_CONTEXT=Vo,X.SUBSCRIBER_DEFAULT_TTL=u_,X.SUBSCRIBER_EVENTS=yt,X.SUBSCRIBER_STORAGE_VERSION=qo,X.Store=Ra,X.Subscriber=wa,X.default=Xr,Object.defineProperty(X,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
